<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Sentinel - í†µí•©ê´€ì œ ì‹œìŠ¤í…œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* ì „ì—­ ìŠ¤íƒ€ì¼ - ì‚¬ì´ë²„í‘í¬ í…Œë§ˆ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Orbitron', 'Malgun Gothic', sans-serif;
            background: radial-gradient(ellipse at center, #0a0a0a 0%, #1a0033 50%, #000 100%);
            color: #00ff41;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* í™€ë¡œê·¸ë¨ ë°°ê²½ íš¨ê³¼ */
        .hologram-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.1) 0%, transparent 50%);
            z-index: -1;
            animation: hologramShift 10s ease-in-out infinite;
        }

        @keyframes hologramShift {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.6; }
            50% { transform: scale(1.1) rotate(1deg); opacity: 0.8; }
        }

        /* ìœ„í—˜ ê°ì§€ ì˜¤ë²„ë ˆì´ */
        .danger-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 0, 0, 0.4) 0%, rgba(255, 0, 0, 0.1) 100%);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(2px);
        }

        .danger-overlay.show {
            display: flex;
            animation: dangerPulse 0.3s ease-in-out infinite alternate;
        }

        @keyframes dangerPulse {
            0% { opacity: 0.8; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.02); }
        }

        .danger-text {
            font-size: 4rem;
            font-weight: bold;
            color: #ff0040;
            text-shadow: 0 0 20px #ff0040, 0 0 40px #ff0040;
            text-align: center;
            animation: dangerGlow 0.5s ease-in-out infinite alternate;
        }

        @keyframes dangerGlow {
            0% { text-shadow: 0 0 20px #ff0040, 0 0 40px #ff0040; }
            100% { text-shadow: 0 0 30px #ff0040, 0 0 60px #ff0040, 0 0 80px #ff0040; }
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .container.with-banner {
            margin-top: 280px;
            transition: margin-top 1s ease;
        }

        /* í—¤ë” */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 2px solid rgba(0, 255, 65, 0.3);
            margin-bottom: 30px;
        }

        .logo {
            font-size: 32px;
            font-weight: bold;
            background: linear-gradient(45deg, #00ff41, #00ccff, #ff0040);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(0, 255, 65, 0.5);
            animation: logoGlow 3s ease-in-out infinite;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        @keyframes logoGlow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }

        /* ğŸ”„ ëŒì•„ê°€ëŠ” ì´ëª¨ì§€ ì™„ì „ ë³µì› */
        .spinning-emoji {
            font-size: 40px;
            animation: spin 3s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .help-btn {
            background: linear-gradient(135deg, #00ff41, #00cc33);
            border: none;
            color: black;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .help-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 65, 0.4);
        }

        /* ë©”ì¸ ê·¸ë¦¬ë“œ */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        /* Cyber Sentinel ìƒíƒœì°½ */
        .sentinel-status {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00ff41;
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
        }

        .sentinel-title {
            color: #00ff41;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 15px #00ff41;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* AWS ì„œë¹„ìŠ¤ ê·¸ë¦¬ë“œ 6ê°œë¡œ í™•ì¥ */
        .aws-services-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .aws-service-box {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9) 0%, rgba(0, 50, 100, 0.3) 100%);
            border: 2px solid #00ccff;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .aws-service-box:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 15px 40px rgba(0, 204, 255, 0.4);
            border-color: #00ff41;
        }

        .aws-service-box::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, transparent, #00ccff, transparent);
            z-index: -1;
            border-radius: 15px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .aws-service-box:hover::before {
            opacity: 1;
        }

        .service-status {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #00ff41;
            box-shadow: 0 0 15px #00ff41;
            animation: statusPulse 2s ease-in-out infinite;
        }

        @keyframes statusPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.2); }
        }

        .service-icon {
            font-size: 36px;
            margin-bottom: 12px;
            animation: iconFloat 4s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-5px) rotate(5deg); }
            75% { transform: translateY(-3px) rotate(-3deg); }
        }

        .service-name {
            font-size: 18px;
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 5px;
        }

        .service-type {
            font-size: 13px;
            color: #00ccff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* ì¢…í•©ê´€ë¦¬ì†Œ ì „ìš© ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .comprehensive-box {
            background: linear-gradient(135deg, rgba(255, 170, 0, 0.2), rgba(255, 140, 0, 0.1));
            border-color: #ffaa00;
            grid-column: 1 / -1; /* ë‘ ì¹¼ëŸ¼ ê°€ë¡œë¡œ ê½‰ ì°¨ê²Œ */
            padding: 28px; /* ë” í° ì¸ìƒ */
        }

        .comprehensive-box:hover {
            box-shadow: 0 0 25px rgba(255, 170, 0, 0.6);
            border-color: #ff8800;
        }

        .comprehensive-status {
            background: #ffaa00;
            box-shadow: 0 0 15px rgba(255, 170, 0, 0.8);
        }

        /* ì‘ì „ ì§€íœ˜ë¶€ - 1ì—´ë¡œ ë³µì› */
        .command-center {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #ff0040;
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(15px);
            position: relative;
        }

        .command-title {
            color: #ff0040;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 25px;
            text-align: center;
            text-shadow: 0 0 15px #ff0040;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* ì „íˆ¬ ì§€íœ˜ì„¼í„° 1ì—´ë¡œ ë³µì› */
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .action-btn {
            background: linear-gradient(135deg, rgba(0, 255, 65, 0.2), rgba(0, 200, 50, 0.1));
            border: 2px solid #00ff41;
            color: #00ff41;
            padding: 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }

        .action-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.4);
            background: linear-gradient(135deg, rgba(0, 255, 65, 0.3), rgba(0, 200, 50, 0.2));
        }

        .action-btn.system-test {
            background: linear-gradient(135deg, rgba(255, 0, 64, 0.3), rgba(200, 0, 50, 0.2));
            border-color: #ff0040;
            color: #ff0040;
            font-size: 18px;
            padding: 25px;
        }

        .action-btn.system-test:hover {
            box-shadow: 0 15px 40px rgba(255, 0, 64, 0.5);
        }

        .btn-description {
            font-size: 11px;
            margin-top: 8px;
            opacity: 0.8;
            text-transform: none;
            line-height: 1.3;
        }

        /* ì‹œìŠ¤í…œ ìƒíƒœ ì¹´ë“œë“¤ */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin-bottom: 40px;
            grid-column: 1 / -1;
        }

        .status-card {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #00ff41;
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            text-align: left;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .status-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 40px rgba(0, 255, 65, 0.3);
        }

        .status-card.orange {
            border-color: #ffaa00;
        }

        .status-card-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .status-icon {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #00ff41;
            box-shadow: 0 0 15px #00ff41;
            animation: iconPulse 2s ease-in-out infinite;
        }

        @keyframes iconPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .status-icon.orange {
            background: #ffaa00;
            box-shadow: 0 0 15px #ffaa00;
        }

        .status-card-title {
            font-size: 16px;
            font-weight: bold;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .status-card-value {
            font-size: 24px;
            font-weight: bold;
            color: #00ff41;
            margin: 10px 0;
            text-shadow: 0 0 15px #00ff41;
            transition: all 0.3s ease;
        }

        .status-card-value.orange {
            color: #ffaa00;
            text-shadow: 0 0 15px #ffaa00;
        }

        
        /* ì‹¤ì‹œê°„ ì°¨ë‹¨ ê¸°ë¡ - ë¨¼ì € í‘œì‹œ (ì›ë³µ) */
        .activity-log {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ff41;
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(15px);
            grid-column: 1 / -1;
            position: relative;
            max-height: 600px;
            overflow-y: auto;
            margin-bottom: 40px;
        }

        .activity-title {
            color: #ff0040;
            font-size: 24px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            text-shadow: 0 0 20px #ff0040;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .activity-subtitle {
            color: #00ccff;
            font-size: 16px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            text-shadow: 0 0 15px #00ccff;
        }

        /* ì‹¤ì‹œê°„ ë³´ê³ ì„œ - ë‚˜ì¤‘ì— í‘œì‹œ (ì›ë³µ) */
        .report-panel {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ccff;
            border-radius: 20px;
            padding: 40px;
            backdrop-filter: blur(15px);
            grid-column: 1 / -1;
            position: relative;
        }

        .report-title {
            color: #00ccff;
            font-size: 24px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            text-shadow: 0 0 20px #00ccff;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .report-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #00ccff;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 204, 255, 0.3);
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            color: #00ccff;
            margin-bottom: 8px;
            text-shadow: 0 0 15px #00ccff;
        }

        .stat-label {
            font-size: 12px;
            color: #888;
            text-transform: uppercase;
        }

        .report-details {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 204, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
        }

        .report-label {
            color: #00ccff;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .report-content {
            font-size: 12px;
            color: #ffffff;
            line-height: 1.6;
        }

        .report-line {
            margin-bottom: 4px;
            padding: 2px 0;
            border-left: 2px solid rgba(0, 204, 255, 0.3);
            padding-left: 10px;
        }

        /* ì´ˆìƒì„¸ ë¡œê·¸ ì—”íŠ¸ë¦¬ ìŠ¤íƒ€ì¼ */
        .log-entry {
            display: grid;
            grid-template-columns: 80px 40px 1fr auto;
            gap: 15px;
            padding: 20px;
            border-bottom: 1px solid rgba(0, 255, 65, 0.2);
            transition: all 0.3s ease;
            border-radius: 8px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.5) 0%, rgba(0, 20, 40, 0.3) 100%);
        }

        .log-entry:hover {
            background: rgba(0, 255, 65, 0.1);
            transform: translateX(10px);
            box-shadow: 0 5px 20px rgba(0, 255, 65, 0.3);
        }

        .log-time {
            color: #00ccff;
            font-size: 14px;
            font-family: 'Noto Sans KR', monospace;
            text-shadow: 0 0 10px #00ccff;
            font-weight: 700;
            align-self: center;
        }

        .log-icon {
            font-size: 24px;
            animation: iconFloat 3s ease-in-out infinite;
            text-align: center;
            align-self: center;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        .log-text {
            font-size: 16px;
            color: #ffffff;
            align-self: center;
        }

        /* ìƒì„¸ ë¡œê·¸ ì •ë³´ ì¶”ê°€ */
        .log-details {
            color: #888;
            font-size: 12px;
            margin-top: 5px;
            line-height: 1.4;
        }

        .log-severity {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
            align-self: center;
        }

        .log-severity.high {
            background: #ff0040;
            color: white;
        }

        .log-severity.medium {
            background: #ffaa00;
            color: black;
        }

        .log-severity.low {
            background: #00ff41;
            color: black;
        }

        .log-severity.info {
            background: #00ccff;
            color: black;
        }

        /* ë¹„ë””ì˜¤ ë°°ë„ˆ */
        .video-banner {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 280px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(20, 0, 40, 0.95) 100%);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            border-bottom: 3px solid #00ff41;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.3);
            backdrop-filter: blur(10px);
        }

        .video-banner.show {
            display: flex;
            animation: bannerSlide 1s ease-out;
        }

        @keyframes bannerSlide {
            from { transform: translateY(-100%) rotateX(-90deg); opacity: 0; }
            to { transform: translateY(0) rotateX(0deg); opacity: 1; }
        }

        .banner-content {
            display: flex;
            align-items: center;
            gap: 50px;
            max-width: 1200px;
            width: 100%;
            padding: 0 40px;
        }

        .banner-video-container {
            position: relative;
            perspective: 1000px;
        }

        .banner-video {
            width: 500px;
            height: 240px;
            border-radius: 15px;
            object-fit: cover;
            border: 2px solid #00ff41;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.5);
            transform: rotateY(-10deg);
            transition: transform 0.3s ease;
        }

        .banner-video:hover {
            transform: rotateY(0deg) scale(1.05);
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(0, 255, 65, 0.1) 50%, transparent 70%);
            pointer-events: none;
            animation: scanLine 2s linear infinite;
        }

        @keyframes scanLine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .banner-text {
            flex: 1;
            color: #00ff41;
        }

        .banner-title {
            font-size: 28px;
            font-weight: bold;
            color: #ff0040;
            margin-bottom: 12px;
            text-shadow: 0 0 20px #ff0040;
            animation: titlePulse 1.5s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; transform: scale(1.02); }
        }

        .banner-subtitle {
            font-size: 14px;
            color: #00ccff;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #00ccff;
            line-height: 1.4;
        }

        .banner-details {
            font-size: 12px;
            color: #ffffff;
            line-height: 1.3;
        }

        .banner-close {
            background: linear-gradient(135deg, #ff0040, #cc0033);
            border: 2px solid #00ff41;
            color: #00ff41;
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s;
            box-shadow: 0 0 20px rgba(255, 0, 64, 0.3);
        }

        .banner-close:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 0, 64, 0.5);
            text-shadow: 0 0 10px #00ff41;
        }

        /* AI ì–´ì‹œìŠ¤í„´íŠ¸ - ëŒì•„ê°€ëŠ” ì´ëª¨ì§€ */
        .ai-assistant {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, #00ff41 0%, #00aa2a 70%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            cursor: pointer;
            box-shadow: 0 0 40px rgba(0, 255, 65, 0.6);
            animation: aiPulse 2s ease-in-out infinite;
            z-index: 100;
        }

        @keyframes aiPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 40px rgba(0, 255, 65, 0.6); }
            50% { transform: scale(1.1); box-shadow: 0 0 60px rgba(0, 255, 65, 0.8); }
        }

        /* ìŒì„± ì¸ì‹ UI */
        .voice-ui {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #00ff41;
            border-radius: 20px;
            padding: 30px;
            display: none;
            text-align: center;
            backdrop-filter: blur(15px);
            z-index: 1500;
            min-width: 400px;
        }

        .voice-ui.show {
            display: block;
            animation: voiceAppear 0.5s ease-out;
        }

        @keyframes voiceAppear {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .voice-wave {
            width: 200px;
            height: 80px;
            display: flex;
            align-items: end;
            justify-content: center;
            gap: 3px;
            margin: 20px auto;
        }

        .wave-bar {
            width: 4px;
            background: #00ff41;
            border-radius: 2px;
            animation: wave 1s ease-in-out infinite;
        }

        .wave-bar:nth-child(odd) { animation-delay: 0.1s; }
        .wave-bar:nth-child(even) { animation-delay: 0.3s; }

        @keyframes wave {
            0%, 100% { height: 10px; }
            50% { height: 40px; }
        }

        /* ëª¨ë‹¬ ê³µí†µ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 3000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: modalFadeIn 0.3s ease-out;
        }

        /* ê°•ì œ ì¤‘ì•™ ê³ ì • ë° ìµœëŒ€ í¬ê¸° í™œìš© */
        #horizontalChartModal .modal-content,
        #helpModal .modal-content,
        #loadMailModal .modal-content,
        #manualControlModal .modal-content,
        #securityScanModal .modal-content,
        #systemCheckModal .modal-content {
            margin: 0 auto;
        }

        /* ì¢…í•©ê´€ë¦¬ì†Œ ì „ìš© í¬ê¸°: 5ê°œ ê·¸ë˜í”„ê°€ í•œ í™”ë©´ì— ë³´ì´ë„ë¡ ê³ ì • */
        #horizontalChartModal .modal-content {
            width: 95vw;
            max-width: 1800px;
            height: 99vh;
            max-height: 99vh;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.96) 0%, rgba(15, 0, 35, 0.92) 100%);
            border: 3px solid #00ff41;
            border-radius: 20px;
            padding: 20px;
            width: 95%;
            max-width: 1600px;
            max-height: 98%;
            overflow: hidden;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(20px);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 255, 65, 0.3);
        }

        .modal-title {
            color: #00ff41;
            font-size: 20px;
            font-weight: bold;
            text-shadow: 0 0 20px #00ff41;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .close-btn {
            background: linear-gradient(135deg, #ff0040, #cc0033);
            border: 2px solid #00ff41;
            color: #00ff41;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 0 20px rgba(255, 0, 64, 0.5);
        }

        /* ì‹œìŠ¤í…œì ê²€ ë° ë³´ì•ˆìŠ¤ìº” ëª¨ë‹¬ ì½˜í…ì¸  ìŠ¤íƒ€ì¼ */
        .system-check-content,
        .security-scan-content {
            max-height: calc(100vh - 200px);
            overflow-y: auto;
            padding: 0;
        }

        .system-check-content::-webkit-scrollbar,
        .security-scan-content::-webkit-scrollbar {
            width: 8px;
        }

        .system-check-content::-webkit-scrollbar-track,
        .security-scan-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .system-check-content::-webkit-scrollbar-thumb,
        .security-scan-content::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #00ff41, #00ccff);
            border-radius: 4px;
        }

        .system-check-content::-webkit-scrollbar-thumb:hover,
        .security-scan-content::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #00ccff, #00ff41);
        }

        /* ğŸ”¥ ì¢…í•©ê´€ë¦¬ì†Œ ì°¨íŠ¸ ê·¸ë¦¬ë“œ - 2-2-1 ë ˆì´ì•„ì›ƒ */
        .comprehensive-charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr; /* GuardDuty ì¶”ê°€ë¡œ 3ì—´ë¡œ ì¡°ì • */
            grid-template-rows: auto auto;      /* 2í–‰ */
            gap: 10px;
            height: calc(99vh - 80px);
            padding: 0;
            width: 100%;
        }

        .chart-item {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ff41;
            border-radius: 15px;
            padding: 10px 8px 12px 8px;
            display: flex;
            flex-direction: column;
            height: calc((99vh - 80px) / 2 - 5px); /* 2í–‰ìœ¼ë¡œ ë‚˜ëˆ„ê³  gap ê³ ë ¤ */
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .chart-item:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.3);
        }

        .chart-item h4 {
            color: #00ff41;
            text-align: center;
            margin-bottom: 4px;
            font-size: 12px;
            text-shadow: 0 0 10px #00ff41;
            font-family: 'Orbitron', sans-serif;
        }

        .chart-item canvas {
            width: 100% !important;
            height: calc(100% - 20px) !important; /* ì œëª© ê³µê°„ ì œì™¸í•˜ê³  ì±„ìš°ê¸° */
            display: block;
            margin-top: 5px;
        }

        /* WAF ì°¨íŠ¸ - ë§¨ ë°‘ ì „ì²´ í­ */
        /* í•˜ë‹¨ ì „ì²´í­ í•­ëª© í•´ì œ: 3x2 ë ˆì´ì•„ì›ƒ ê³ ì • */

        /* ê°œë³„ ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ */
        .single-chart-container {
            height: 600px;
            width: 100%;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            border: 2px solid #00ff41;
        }

        .single-chart-container canvas {
            width: 100% !important;
            height: 100% !important;
        }

        /* ì°¨ë‹¨ëœ IP ëª©ë¡ ì°½ í™•ëŒ€ */
.blocked-ips-container {
    max-height: 600px !important;  /* ê¸°ì¡´ 400px â†’ 600px */
    overflow-y: auto;
    padding: 15px;
}

.blocked-ip-item {
    margin-bottom: 12px;
    padding: 15px;  /* íŒ¨ë”© ì¦ê°€ */
    border: 1px solid #333;
    border-radius: 8px;
    background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
}

/* ì‹¤ì‹œê°„ ì°¨ë‹¨ ê¸°ë¡ ì°½ë„ í™•ëŒ€ */
.realtime-log-container {
    max-height: 500px !important;  /* ê¸°ì¡´ 300px â†’ 500px */
    overflow-y: auto;
}

/* ì „ì²´ ì½˜í…ì¸  ì˜ì—­ ë†’ì´ ì¦ê°€ */
.dashboard-content {
    min-height: 100vh;
    padding-bottom: 50px;
}

    </style>
    <style>
        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ë³´ê°• (ë¯¸ë ¤í™”) */
        @media (max-width: 768px) {
            /* ë ˆì´ì•„ì›ƒ */
            .aws-services-grid { grid-template-columns: 1fr; gap: 12px; }
            .comprehensive-charts-grid { grid-template-columns: 1fr; grid-template-rows: auto; gap: 12px; overflow-y: auto; }
            .action-buttons { grid-template-columns: 1fr; gap: 12px; }
            .sentinel-status { padding: 16px; border-radius: 16px; }

            /* ì¹´ë“œí˜• ì„œë¹„ìŠ¤ ë°•ìŠ¤ */
            .aws-service-box { display: grid; grid-template-columns: 56px 1fr; align-items: center; padding: 16px; }
            .service-icon { font-size: 28px; margin: 0; }
            .service-name { font-size: 16px; margin-bottom: 2px; }
            .service-type { font-size: 11px; }

            /* ìƒíƒœ/í…ìŠ¤íŠ¸ í¬ê¸° */
            .command-title, .sentinel-title { font-size: 18px; }
            .status-card-value { font-size: 20px; }

            /* ëª¨ë‹¬: í’€ë·°í¬íŠ¸ ëŒ€ì‘ */
            .modal { align-items: flex-start; }
            .modal .modal-content { width: 96vw !important; height: auto !important; max-height: 90vh; margin: 4vh auto !important; }

            /* ì°¨íŠ¸ */
            .single-chart-container { height: 320px !important; }
            .chart-item { height: 300px !important; }
        }

        /* ì´ˆì†Œí˜• í™”ë©´ ìµœì í™” */
        @media (max-width: 480px) {
            .banner-title { font-size: 20px; }
            .banner-details { font-size: 12px; }
            .modal-title { font-size: 22px; }
            .stat-number { font-size: 22px; }
            .report-value { font-size: 14px; }
            .aws-service-box { grid-template-columns: 48px 1fr; }
        }
    </style>
</head>

<body>
    <!-- í™€ë¡œê·¸ë¨ ë°°ê²½ -->
    <div class="hologram-bg"></div>

    <!-- ìœ„í—˜ ê°ì§€ ì˜¤ë²„ë ˆì´ -->
    <div class="danger-overlay" id="dangerOverlay">
        <div class="danger-text glitch">
            âš¡ ì‹¤ì‹œê°„ ìœ„í˜‘ ê°ì§€! âš¡<br>
            <div style="font-size: 2.5rem; margin-top: 20px;">ìë™ ë°©ì–´ ì¦‰ì‹œ í™œì„±í™”</div>
        </div>
    </div>

    <!-- ë™ì˜ìƒ ë°°ë„ˆ -->
    <div class="video-banner" id="videoBanner">
        <div class="banner-content">
            <div class="banner-video-container">
                <video class="banner-video" id="bannerVideo" muted loop preload="auto" playsinline>
                    <source src="watermarked-a2229bd4-6c35-4ecd-916c-6d9812921478.mp4" type="video/mp4">
                    ìë™ ì „íˆ¬ ì‹œìŠ¤í…œ í™œì„±í™”
                </video>
                <div class="video-overlay"></div>
            </div>
            <div class="banner-text">
                <div class="banner-title">âš¡ ì‹¤ì‹œê°„ ìë™ ë°©ì–´ ì‹œìŠ¤í…œ í™œì„±í™” âš¡</div>
                <div class="banner-subtitle" id="bannerSubtitle">Cyber Sentinel ì‹¤ì‹œê°„ ì‹œìŠ¤í…œì´ ìœ„í˜‘ì„ íƒì§€í•˜ê³  ì°¨ë‹¨í–ˆìŠµë‹ˆë‹¤</div>
                <div class="banner-details" id="bannerDetails">
                    ëŒ€ìƒ: <span id="blockedIP" style="color: #ff0040; font-weight: bold;">-</span><br>
                    ìœ„í˜‘ ìœ í˜•: <span id="threatType" style="color: #ff0040; font-weight: bold;">-</span><br>
                    ìƒíƒœ: <span style="color: #00ff41; font-weight: bold;">ì‹¤ì‹œê°„ ì°¨ë‹¨ ì™„ë£Œ</span><br>
                    ì°¨ë‹¨ ì‹œê°„: <span id="blockTime" style="color: #00ccff;">-</span>
                </div>
            </div>
            <button class="banner-close" onclick="closeBanner()">í™•ì¸</button>
        </div>
    </div>

    <!-- AI ìŒì„± ì–´ì‹œìŠ¤í„´íŠ¸ - ëŒì•„ê°€ëŠ” ì´ëª¨ì§€ -->
    <div class="ai-assistant" id="aiAssistant" onclick="toggleVoiceUI()" title="AI ìŒì„± ì–´ì‹œìŠ¤í„´íŠ¸">
        <span class="spinning-emoji">ğŸ¤–</span>
    </div>

    <!-- ìŒì„± ì¸ì‹ UI -->
    <div class="voice-ui" id="voiceUI">
        <h3 style="color: #00ff41; margin-bottom: 20px;">ğŸ¤ AI ìŒì„± ì–´ì‹œìŠ¤í„´íŠ¸</h3>
        <div class="voice-wave" id="voiceWave">
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
        </div>
        <p id="voiceStatus" style="color: #00ccff; margin-bottom: 15px;">ìŒì„± ëª…ë ¹ì„ ë§ì”€í•˜ì„¸ìš”...</p>
        <div style="font-size: 12px; color: #888; margin-bottom: 20px; line-height: 1.4;">
            <strong>ì‚¬ìš© ê°€ëŠ¥í•œ ëª…ë ¹ì–´:</strong><br>
            "í…ŒìŠ¤íŠ¸ ì‹œì‘" - ìë™ì°¨ë‹¨ í…ŒìŠ¤íŠ¸<br>
            "ë³´ì•ˆ ìŠ¤ìº”" - ì „ì²´ ì‹œìŠ¤í…œ ë³´ì•ˆ ì ê²€<br>
            "ì‹œìŠ¤í…œ ì ê²€" - ì „ì²´ ì—°ê²° ìƒíƒœ í™•ì¸<br>
            "ë³´ê³ ì„œ ìƒì„±" - CSV ë³´ê³ ì„œ ë‹¤ìš´ë¡œë“œ<br>
            "ë¡œë“œ ë©”ì¼" - LOAD & MAIL ì‹¤í–‰<br>
            "ìˆ˜ë™ ì „íˆ¬" - ìˆ˜ë™ ì „íˆ¬ ëª¨ë“œ<br>
            "ìƒˆë¡œê³ ì¹¨" - ë°ì´í„° ì—…ë°ì´íŠ¸<br>
            "ë„ì›€ë§" - ì‹œìŠ¤í…œ ë„ì›€ë§
        </div>
        <button onclick="closeVoiceUI()" style="background: #ff0040; color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer;">ë‹«ê¸°</button>
    </div>
    
    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="container" id="mainContainer">
        <!-- í—¤ë” -->
        <div class="header">
            <div class="logo">
                <span class="spinning-emoji">âš™ï¸</span>
                Cyber Sentinel - ì‹¤ì‹œê°„ ì—°ë™
            </div>
            <div style="display: flex; gap: 15px; align-items: center;">
                <span style="color: #00ccff;">ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™ ì¤‘</span>
                <button class="help-btn" onclick="showHelp()" title="ì‹œìŠ¤í…œ ë„ì›€ë§">ë„ì›€ë§</button>
            </div>
        </div>

        <div class="main-grid">
            <!-- AWS ì„œë¹„ìŠ¤ ë°•ìŠ¤ë“¤ + ì¢…í•©ê´€ë¦¬ì†Œ -->
            <div class="sentinel-status">
                <div class="sentinel-title">âš™ï¸ Cyber Sentinel ìƒíƒœì°½</div>

                <div class="aws-services-grid">
                    <div class="aws-service-box" onclick="showHorizontalChart('Lambda')" data-service="lambda">
                        <div class="service-status" id="lambdaStatus"></div>
                        <div class="service-icon">âš¡</div>
                        <div class="service-name">ì§€íœ˜ë³¸ë¶€</div>
                        <div class="service-type">Lambda</div>
                    </div>

                    <div class="aws-service-box" onclick="showHorizontalChart('DynamoDB')" data-service="dynamodb">
                        <div class="service-status" id="dynamodbStatus"></div>
                        <div class="service-icon">ğŸ—„ï¸</div>
                        <div class="service-name">ë„ì„œê´€</div>
                        <div class="service-type">DynamoDB</div>
                    </div>

                    <div class="aws-service-box" onclick="showHorizontalChart('API Gateway')" data-service="apigateway">
                        <div class="service-status" id="apigatewayStatus"></div>
                        <div class="service-icon">ğŸŒ</div>
                        <div class="service-name">ê²½ë¹„ì‹¤</div>
                        <div class="service-type">API Gateway</div>
                    </div>

                    <div class="aws-service-box" onclick="showHorizontalChart('CloudFront')" data-service="cloudfront">
                        <div class="service-status" id="cloudfrontStatus"></div>
                        <div class="service-icon">â˜ï¸</div>
                        <div class="service-name">í†µì‹ ì†Œ</div>
                        <div class="service-type">CloudFront</div>
                    </div>

                    <div class="aws-service-box" onclick="showHorizontalChart('WAF')" data-service="waf">
                        <div class="service-status" id="wafStatus"></div>
                        <div class="service-icon">ğŸ›¡ï¸</div>
                        <div class="service-name">ì¶œì…ê´€ë¦¬ì†Œ</div>
                        <div class="service-type">WAF</div>
                    </div>

                    <div class="aws-service-box" onclick="showHorizontalChart('GuardDuty')" data-service="guardduty">
                        <div class="service-status" id="guarddutyStatus"></div>
                        <div class="service-icon">ğŸ•µï¸</div>
                        <div class="service-name">ìˆ˜ì‚¬êµ­</div>
                        <div class="service-type">GuardDuty</div>
                    </div>

                    <!-- ì¢…í•©ê´€ë¦¬ì†Œ -->
                    <div class="aws-service-box comprehensive-box" onclick="showComprehensiveMetrics()" data-service="comprehensive">
                        <div class="service-status comprehensive-status" id="comprehensiveStatus"></div>
                        <div class="service-icon">ğŸ“Š</div>
                        <div class="service-name">ì¢…í•©ê´€ë¦¬ì†Œ</div>
                        <div class="service-type">All Metrics</div>
                    </div>
                </div>
            </div>

            <!-- ì „íˆ¬ ì§€íœ˜ë¶€ - 1ì—´ë¡œ ë³µì› + ë²„íŠ¼ í´ë¦­ ìˆ˜ì • -->
            <div class="command-center">
                <div class="command-title">âš”ï¸ ì „íˆ¬ ì§€íœ˜ ì„¼í„°</div>

                <div class="action-buttons">
                    <button class="action-btn" onclick="showLoadMail()">
                        ğŸ¯ LOAD & MAIL
                        <div class="btn-description">ì°¨ë‹¨ IP ê´€ë¦¬ | í•´ì œ ìš”ì²­ | ìƒíƒœ í™•ì¸</div>
                    </button>

                    <button class="action-btn" onclick="showManualControlModal()">
                        ğŸ”“ ìˆ˜ë™ ì „íˆ¬
                        <div class="btn-description">ë¯¸ë””ì›€/ë¡œìš° ìœ„í—˜ë„ ê´€ë¦¬ ë° ìˆ˜ë™ ì°¨ë‹¨</div>
                    </button>

                    <button class="action-btn" onclick="reportGeneration()">
                        ğŸ“Š SAVE
                        <div class="btn-description">ë³´ì•ˆ í™œë™ ë°ì´í„°ë¥¼ CSV íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ</div>
                    </button>

                    <!-- ë³´ì•ˆìŠ¤ìº” ë²„íŠ¼ -->
                    <button class="action-btn security-scan" onclick="performSecurityScan()">
                        ğŸ” ë³´ì•ˆê°ì‚¬ì²­
                        <div class="btn-description">ì „ì²´ ì‹œìŠ¤í…œ ë³´ì•ˆ ì ê²€ ë° ì·¨ì•½ì  ë¶„ì„</div>
                    </button>

                    <!-- ì‹œìŠ¤í…œ ì ê²€ ë²„íŠ¼ -->
                    <button class="action-btn system-check" onclick="performSystemCheck()">
                        ğŸ”§ í™˜ê²½ì²­
                        <div class="btn-description">ì „ì²´ ì—°ê²° ìƒíƒœ ë° ì„œë¹„ìŠ¤ ìƒíƒœ ìƒì„¸ í™•ì¸</div>
                    </button>

                    <!-- í•µì‹¬ í…ŒìŠ¤íŠ¸ ë²„íŠ¼ -->
                    <button class="action-btn system-test" onclick="simulateAutoBlockInstant()">
                        âš¡ ì¢…í•© í›ˆë ¨ì†Œ
                        <div class="btn-description">ì¦‰ì‹œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</div>
                    </button>
                </div>

                <div id="threatStatus" style="background: rgba(0, 255, 65, 0.1); border: 1px solid #00ff41; border-radius: 8px; padding: 15px; text-align: center;">
                    <div style="color: #00ff41; font-weight: bold;">âœ… Cyber Sentinel ì‹¤ì‹œê°„ ì—°ë™ ëª¨ë“œ</div>
                </div>
            </div>
        </div>

        <!-- ì‹œìŠ¤í…œ ìƒíƒœ ì¹´ë“œë“¤ -->
        <div class="status-grid">
            <div class="status-card">
                <div class="status-card-row">
                    <div class="status-icon"></div>
                    <div class="status-card-title">ê°ì‹œíƒ‘:</div>
                </div>
                <div class="status-card-value">ì˜¨ë¼ì¸</div>
                <div style="font-size: 12px; color: #aaa;">ì‹¤ì‹œê°„ ì—°ë™ ì¤€ë¹„ ì™„ë£Œ</div>
            </div>

            <div class="status-card">
                <div class="status-card-row">
                    <div class="status-icon"></div>
                    <div class="status-card-title">ì  ê²©í‡´ ìˆ˜:</div>
                </div>
                <div class="status-card-value" id="defeatCount">0</div>
                <div style="font-size: 12px; color: #aaa;">ì´ ì‹¤ì‹œê°„ ì°¨ë‹¨ ìˆ˜</div>
            </div>

            <div class="status-card">
                <div class="status-card-row">
                    <div class="status-icon"></div>
                    <div class="status-card-title">ìŠ¹ë¦¬í™•ë¥ :</div>
                </div>
                <div class="status-card-value" id="successRate">100%</div>
                <div style="font-size: 12px; color: #aaa;">ì‹¤ì‹œê°„ íƒì§€ìœ¨</div>
            </div>

            <div class="status-card orange">
                <div class="status-card-row">
                    <div class="status-icon orange"></div>
                    <div class="status-card-title">ê²½ì°°ì„œ:</div>
                </div>
                <div class="status-card-value orange" id="failedCount">0</div>
                <div style="font-size: 12px; color: #aaa;">ìˆ˜ë™IP í™•ì¸ í•„ìš”</div>
            </div>

            <div class="status-card">
                <div class="status-card-row">
                    <div class="status-icon"></div>
                    <div class="status-card-title">ì¹˜ì•ˆë„:</div>
                </div>
                <div class="status-card-value" id="threatLevel">ì•ˆì „</div>
                <div style="font-size: 12px; color: #aaa;">ìœ„í—˜ í‰ê°€</div>
            </div>

            <div class="status-card">
                <div class="status-card-row">
                    <div class="status-icon"></div>
                    <div class="status-card-title">ì‰´ë“œ:</div>
                </div>
                <div class="status-card-value">í™œì„±</div>
                <div style="font-size: 12px; color: #aaa;">ì‹¤ì‹œê°„ ë°©í™”ë²½</div>
            </div>
        </div>

        <!-- âš¡ ì‹¤ì‹œê°„ ì°¨ë‹¨ ê¸°ë¡ - ë¨¼ì € í‘œì‹œ (ì›ë³µ) -->
        <div class="activity-log">
            <div class="activity-title">âš¡ ì‹¤ì‹œê°„ ë¡œê·¸</div>
            <div class="activity-subtitle">ëª¨ë“  ë³´ì•ˆ í™œë™ ìƒì„¸ ì¶”ì </div>

            <div id="logEntries">
                <div class="log-entry">
                    <div class="log-time">ì‹œì‘</div>
                    <div class="log-icon">ğŸš€</div>
                    <div class="log-text">
                        Cyber Sentinel ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ
                        <div class="log-details">
                            â€¢ ì†ŒìŠ¤: SYSTEM_CORE | í”„ë¡œì„¸ìŠ¤: INITIALIZATION<br>
                            â€¢ AWS ì—°ê²°: ESTABLISHED | í´ë§ ì£¼ê¸°: 5ì´ˆ<br>
                            â€¢ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§: í™œì„±í™” | ë°©ì–´ë§‰: ì˜¨ë¼ì¸
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:01</div>
                    <div class="log-icon">ğŸ”—</div>
                    <div class="log-text">
                        AWS API ì‹¤ì‹œê°„ ì—°ê²° ì„¤ì • ì™„ë£Œ
                        <div class="log-details">
                            â€¢ ì—”ë“œí¬ì¸íŠ¸: https://b9i9l3fspk.execute-api.ap-northeast-2.amazonaws.com/prod<br>
                            â€¢ ì§€ì—­: ap-northeast-2 (ì„œìš¸) | ì‘ë‹µì‹œê°„: 45ms<br>
                            â€¢ ì¸ì¦: IAM Role | ì•”í˜¸í™”: TLS 1.3
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:02</div>
                    <div class="log-icon">ğŸ›¡ï¸</div>
                    <div class="log-text">
                        WAF ê·œì¹™ ì—”ì§„ í™œì„±í™”
                        <div class="log-details">
                            â€¢ WAF ACL: CyberSentinel-MainACL | ê·œì¹™ ìˆ˜: 127ê°œ<br>
                            â€¢ SQL ì¸ì ì…˜ ë³´í˜¸: í™œì„± | XSS ì°¨ë‹¨: í™œì„±<br>
                            â€¢ êµ­ê°€ë³„ ì°¨ë‹¨: 15ê°œêµ­ | Bot ê°ì§€: í™œì„±
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:03</div>
                    <div class="log-icon">âš¡</div>
                    <div class="log-text">
                        Lambda í•¨ìˆ˜ ì¤€ë¹„ ì™„ë£Œ
                        <div class="log-details">
                            â€¢ í•¨ìˆ˜ëª…: cyber-sentinel-processor | ëŸ°íƒ€ì„: Python 3.11<br>
                            â€¢ ë©”ëª¨ë¦¬: 512MB | íƒ€ì„ì•„ì›ƒ: 30ì´ˆ<br>
                            â€¢ ë™ì‹œì‹¤í–‰: ìµœëŒ€ 100ê°œ | ì˜ˆì•½ ë™ì‹œì‹¤í–‰: 10ê°œ
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:04</div>
                    <div class="log-icon">ğŸ—„ï¸</div>
                    <div class="log-text">
                        DynamoDB í…Œì´ë¸” ì—°ê²° í™•ì¸
                        <div class="log-details">
                            â€¢ í…Œì´ë¸”: cyber-sentinel-threats | íŒŒí‹°ì…˜í‚¤: threat_id<br>
                            â€¢ ì½ê¸° ìš©ëŸ‰: 25 RCU | ì“°ê¸° ìš©ëŸ‰: 25 WCU<br>
                            â€¢ ê¸€ë¡œë²Œ ì¸ë±ìŠ¤: 3ê°œ | ë°±ì—…: ì¼ì¼ ìë™
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:05</div>
                    <div class="log-icon">â˜ï¸</div>
                    <div class="log-text">
                        CloudFront ë°°í¬ ìƒíƒœ í™•ì¸
                        <div class="log-details">
                            â€¢ ë°°í¬ ID: E1ABC2DEF3GHI4 | ìƒíƒœ: Deployed<br>
                            â€¢ ì—£ì§€ ë¡œì¼€ì´ì…˜: 450ê°œ | ìºì‹œ ì ì¤‘ë¥ : 89.2%<br>
                            â€¢ SSL ì¸ì¦ì„œ: í™œì„± | HTTP/2: ì§€ì›
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:06</div>
                    <div class="log-icon">ğŸŒ</div>
                    <div class="log-text">
                        API Gateway ì—°ê²° ì„¤ì •
                        <div class="log-details">
                            â€¢ API ID: b9i9l3fspk | ìŠ¤í…Œì´ì§€: prod<br>
                            â€¢ ìŠ¤ë¡œí‹€ë§: 1000 req/sec | ë²„ìŠ¤íŠ¸: 2000<br>
                            â€¢ CORS: í™œì„±í™” | API í‚¤: í•„ìˆ˜
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:07</div>
                    <div class="log-icon">ğŸ¤</div>
                    <div class="log-text">
                        ìŒì„± ì¸ì‹ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
                        <div class="log-details">
                            â€¢ ì—”ì§„: Web Speech API | ì–¸ì–´: ko-KR<br>
                            â€¢ ë§ˆì´í¬ ê¶Œí•œ: ëŒ€ê¸° ì¤‘ | ë…¸ì´ì¦ˆ ê°ì†Œ: í™œì„±<br>
                            â€¢ ëª…ë ¹ì–´ íŒ¨í„´: 12ê°œ | ì‹ ë¢°ë„ ì„ê³„ê°’: 0.8
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:08</div>
                    <div class="log-icon">ğŸ“Š</div>
                    <div class="log-text">
                        ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ì‹œì‘
                        <div class="log-details">
                            â€¢ CloudWatch ë©”íŠ¸ë¦­: 45ê°œ | ìˆ˜ì§‘ ì£¼ê¸°: 1ë¶„<br>
                            â€¢ ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­: 12ê°œ | X-Ray ì¶”ì : í™œì„±<br>
                            â€¢ ì•ŒëŒ: 23ê°œ ì„¤ì • | SNS ì£¼ì œ: 3ê°œ
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:09</div>
                    <div class="log-icon">ğŸ””</div>
                    <div class="log-text">
                        Slack ì•Œë¦¼ ì±„ë„ ì—°ê²°
                        <div class="log-details">
                            â€¢ ì›Œí¬ìŠ¤í˜ì´ìŠ¤: CyberSentinel-Security | ì±„ë„: #alerts<br>
                            â€¢ Webhook URL: ì•”í˜¸í™”ë¨ | ì•Œë¦¼ ìˆ˜ì¤€: HIGH ì´ìƒ<br>
                            â€¢ ë©”ì‹œì§€ í˜•ì‹: JSON | ì¬ì‹œë„: 3íšŒ
                        </div>
                    </div>
                    <div class="log-severity info">INFO</div>
                </div>

                <div class="log-entry">
                    <div class="log-time">00:10</div>
                    <div class="log-icon">âœ…</div>
                    <div class="log-text">
                        ëª¨ë“  ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ - ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ì‹œì‘
                        <div class="log-details">
                            â€¢ ì´ ì´ˆê¸°í™” ì‹œê°„: 10.2ì´ˆ | ìƒíƒœ: ëª¨ë“  ì„œë¹„ìŠ¤ ì •ìƒ<br>
                            â€¢ í´ë§ ê°„ê²©: 5ì´ˆ | ìë™ ì°¨ë‹¨: í™œì„±í™”<br>
                            â€¢ ìœ„í—˜ë„ ì„ê³„ê°’: HIGH(80) | ì¦‰ì‹œ ì°¨ë‹¨: CRITICAL(90)
                        </div>
                    </div>
                    <div class="log-severity info">SUCCESS</div>
                </div>
            </div>
        </div>

        <!-- ğŸ“Š ì‹¤ì‹œê°„ ë³´ê³ ì„œ - ë‚˜ì¤‘ì— í‘œì‹œ (ì›ë³µ) -->
        <div class="report-panel">
            <div class="report-title">ğŸ“Š ì‹¤ì‹œê°„ ë³´ê³ ì„œ</div>

            <div class="report-stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalThreats">0</div>
                    <div class="stat-label">ì´ ìœ„í˜‘ ìˆ˜</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="blockedThreats">0</div>
                    <div class="stat-label">ì‹¤ì‹œê°„ ì°¨ë‹¨ëœ ìœ„í˜‘</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="blockedIPs">0</div>
                    <div class="stat-label">ì°¨ë‹¨ëœ IP</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="lastUpdate">--:--</div>
                    <div class="stat-label">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</div>
                </div>
            </div>

            <div class="report-details">
                <div class="report-label">[ì‹¤ì‹œê°„ ë³´ê³ ì„œ]</div>
                <div class="report-content">
                    <div class="report-line">ì‹œê°„: <span id="currentTime1">--:--</span></div>
                    <div class="report-line">ìƒíƒœ: AWS API ì‹¤ì‹œê°„ ì—°ê²° í™œì„±í™”</div>
                    <div class="report-line">í´ë§ ì£¼ê¸°: 5ì´ˆë§ˆë‹¤ Lambda ì‹¤í–‰</div>
                    <div class="report-line">API ì—”ë“œí¬ì¸íŠ¸: /prod (ì„œìš¸ ë¦¬ì „)</div>
                    <div class="report-line">ì‘ë‹µ ì‹œê°„: < 100ms (í‰ê·  45ms)</div>
                    <div class="report-line">Lambda ë™ì‹œì‹¤í–‰: 10ê°œ ì˜ˆì•½ë¨</div>
                    <div class="report-line">DynamoDB ì—°ê²°: 25 RCU/WCU</div>
                    <div class="report-line">WAF ê·œì¹™: 127ê°œ í™œì„±í™”</div>
                    <div class="report-line">CloudFront: 450ê°œ ì—£ì§€ ë¡œì¼€ì´ì…˜</div>
                    <div class="report-line">GuardDuty: íƒì§€ê¸° í™œì„± Â· ê³ ìœ„í—˜ 2 Â· ì¤‘ 5 Â· ì € 16</div>
                    <div class="report-line">Slack ì•Œë¦¼: #alerts ì±„ë„ ì—°ê²°</div>
                    <div class="report-line">ì‹¤ì‹œê°„ ì°¨ë‹¨: HIGH(80) ì´ìƒ ìë™</div>
                    <div class="report-line">ì¦‰ì‹œ ì°¨ë‹¨: CRITICAL(90) ì´ìƒ</div>
                </div>
            </div>
        </div>
    </div> <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ ë‹«ê¸° -->
    
    <!-- ê°€ë¡œ ë§‰ëŒ€ ì°¨íŠ¸ ëª¨ë‹¬ -->
    <div id="horizontalChartModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="horizontalChartTitle">AWS ë©”íŠ¸ë¦­ ì°¨íŠ¸</h2>
                <button class="close-btn" onclick="closeHorizontalChart()">Ã—</button>
            </div>
            <div id="manual-review-container">
                <!-- ì°¨íŠ¸ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <!-- ìˆ˜ë™ ì „íˆ¬ ëª¨ë‹¬ -->
    <div id="manualControlModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ğŸ”“ ìˆ˜ë™ ì „íˆ¬ ì œì–´íŒ</h2>
                <button class="close-btn" onclick="closeModal('manualControlModal')">Ã—</button>
            </div>
            <div class="manual-control-content">
                <!-- ìˆ˜ë™ ì°¨ë‹¨ ì„¹ì…˜ -->
                <div style="background: rgba(0, 0, 0, 0.6); border: 2px solid #ffaa00; border-radius: 15px; padding: 25px; margin-bottom: 30px;">
                    <div style="color: #ffaa00; font-size: 20px; font-weight: bold; margin-bottom: 20px; text-transform: uppercase;">âš¡ ìˆ˜ë™ IP ì°¨ë‹¨</div>
                    <div style="display: flex; gap: 20px; margin-bottom: 20px; align-items: end;">
                        <div style="flex: 1;">
                            <label style="display: block; color: #00ccff; font-size: 14px; font-weight: bold; margin-bottom: 8px; text-transform: uppercase;">ì°¨ë‹¨í•  IP ì£¼ì†Œ</label>
                            <input type="text" id="manualBlockIP" placeholder="192.168.1.100" style="width: 100%; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ccff; border-radius: 8px; padding: 12px; color: #ffffff; font-size: 14px;">
                        </div>
                        <div style="flex: 1;">
                            <label style="display: block; color: #00ccff; font-size: 14px; font-weight: bold; margin-bottom: 8px; text-transform: uppercase;">ì°¨ë‹¨ ì‚¬ìœ </label>
                            <input type="text" id="manualBlockReason" placeholder="ìˆ˜ë™ ì°¨ë‹¨ ìš”ì²­" style="width: 100%; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ccff; border-radius: 8px; padding: 12px; color: #ffffff; font-size: 14px;">
                        </div>
                        <button onclick="executeManualBlock()" style="background: linear-gradient(135deg, #ff0040, #cc0033); border: none; color: white; padding: 15px 30px; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; text-transform: uppercase;">ì¦‰ì‹œ ì°¨ë‹¨</button>
                    </div>
                </div>

                <!-- ìˆ˜ë™ ê²€í†  ëŒ€ìƒ ëª©ë¡ -->
                <div style="background: rgba(0, 0, 0, 0.6); border: 2px solid #00ccff; border-radius: 15px; padding: 25px;">
                    <h3 style="color: #00ccff; font-size: 20px; margin-bottom: 20px; text-transform: uppercase;">ğŸ¯ ìˆ˜ë™ ê²€í†  ëŒ€ìƒ</h3>
                    <div id="threatList" style="max-height: 400px; overflow-y: auto; padding: 10px;">
                        <!-- ìœ„í˜‘ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
                        <div style="text-align: center; padding: 40px; color: #888;">
                            ì‹¤ì‹œê°„ AWS APIì—ì„œ ìˆ˜ë™ ê²€í†  ëŒ€ìƒì„ ë¡œë“œí•˜ëŠ” ì¤‘...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë³´ì•ˆìŠ¤ìº” ê²°ê³¼ ëª¨ë‹¬ -->
    <div id="securityScanModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ğŸ” ë³´ì•ˆìŠ¤ìº” ê²°ê³¼</h2>
                <button class="close-btn" onclick="closeModal('securityScanModal')">Ã—</button>
            </div>
            <div class="security-scan-content">
                <div id="securityScanResults" style="padding: 15px 20px 25px 20px;">
                    <!-- ë³´ì•ˆìŠ¤ìº” ê²°ê³¼ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <!-- ì‹œìŠ¤í…œì ê²€ ê²°ê³¼ ëª¨ë‹¬ -->
    <div id="systemCheckModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ğŸ”§ ì‹œìŠ¤í…œì ê²€ ê²°ê³¼</h2>
                <button class="close-btn" onclick="closeModal('systemCheckModal')">Ã—</button>
            </div>
            <div class="system-check-content">
                <div id="systemCheckResults" style="padding: 15px 20px 25px 20px;">
                    <!-- ì‹œìŠ¤í…œì ê²€ ê²°ê³¼ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <!-- LOAD & MAIL ëª¨ë‹¬ -->
    <div id="loadMailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ğŸ¯ LOAD & MAIL ê´€ë¦¬ ì„¼í„°</h2>
                <button class="close-btn" onclick="closeModal('loadMailModal')">Ã—</button>
            </div>

            <!-- íƒ­ ë©”ë‰´ -->
            <div style="display: flex; gap: 10px; margin-bottom: 30px;">
                <button class="management-btn active" onclick="showBlockedIPsTab(this)" style="background: rgba(0, 0, 0, 0.6); border: 2px solid #00ccff; color: #00ccff; padding: 12px 24px; border-radius: 10px; cursor: pointer; font-weight: bold; text-transform: uppercase;">ì°¨ë‹¨ IP ëª©ë¡</button>
                <button class="management-btn" onclick="showUnblockRequestTab(this)" style="background: rgba(0, 0, 0, 0.6); border: 2px solid #00ccff; color: #00ccff; padding: 12px 24px; border-radius: 10px; cursor: pointer; font-weight: bold; text-transform: uppercase;">í•´ì œ ìš”ì²­</button>
                <button class="management-btn" onclick="showStatusCheckTab(this)" style="background: rgba(0, 0, 0, 0.6); border: 2px solid #00ccff; color: #00ccff; padding: 12px 24px; border-radius: 10px; cursor: pointer; font-weight: bold; text-transform: uppercase;">ìƒíƒœ í™•ì¸</button>
            </div>

            <!-- ì°¨ë‹¨ IP ëª©ë¡ íƒ­ -->
            <div id="blockedIPsTab" class="tab-content active" style="animation: fadeIn 0.3s ease-out;">
                <h3 style="color: #00ccff; margin-bottom: 20px;">ğŸš« í˜„ì¬ ì°¨ë‹¨ëœ IP ëª©ë¡</h3>
                <div id="blockedIPList" style="max-height: 900px; overflow-y: auto;">
                    <!-- ì°¨ë‹¨ IP ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì‚½ì…ë©ë‹ˆë‹¤ -->
                    <div style="text-align: center; padding: 40px; color: #888;">
                        ì‹¤ì‹œê°„ AWS APIì—ì„œ ì°¨ë‹¨ IP ëª©ë¡ì„ ë¡œë“œí•˜ëŠ” ì¤‘...
                    </div>
                </div>
            </div>

            <!-- í•´ì œ ìš”ì²­ íƒ­ -->
            <div id="unblockRequestTab" class="tab-content" style="display: none;">
                <h3 style="color: #ffaa00; margin-bottom: 20px;">ğŸ“ ì°¨ë‹¨ í•´ì œ ìš”ì²­</h3>
                <div style="background: rgba(0, 0, 0, 0.6); border: 2px solid #ffaa00; border-radius: 15px; padding: 25px;">
                    <div style="display: flex; gap: 20px; margin-bottom: 15px;">
                        <div style="flex: 1;">
                            <label style="display: block; color: #ffaa00; font-size: 14px; font-weight: bold; margin-bottom: 8px;">ì°¨ë‹¨ëœ IP ì£¼ì†Œ</label>
                            <input type="text" id="unblockIP" placeholder="192.168.1.100" style="width: 100%; background: rgba(0, 0, 0, 0.8); border: 2px solid #ffaa00; border-radius: 8px; padding: 12px; color: #ffffff;">
                        </div>
                        <div style="flex: 1;">
                            <label style="display: block; color: #ffaa00; font-size: 14px; font-weight: bold; margin-bottom: 8px;">ìš”ì²­ì ì´ë¦„</label>
                            <input type="text" id="requesterName" placeholder="í™ê¸¸ë™" style="width: 100%; background: rgba(0, 0, 0, 0.8); border: 2px solid #ffaa00; border-radius: 8px; padding: 12px; color: #ffffff;">
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; color: #ffaa00; font-size: 14px; font-weight: bold; margin-bottom: 8px;">ì—°ë½ì²˜</label>
                        <input type="text" id="requesterContact" placeholder="010-1234-5678" style="width: 100%; background: rgba(0, 0, 0, 0.8); border: 2px solid #ffaa00; border-radius: 8px; padding: 12px; color: #ffffff;">
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #ffaa00; font-size: 14px; font-weight: bold; margin-bottom: 8px;">í•´ì œ ì‚¬ìœ </label>
                        <textarea id="unblockReason" rows="4" placeholder="ì°¨ë‹¨ í•´ì œê°€ í•„ìš”í•œ ìƒì„¸í•œ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”..." style="width: 100%; background: rgba(0, 0, 0, 0.8); border: 2px solid #ffaa00; border-radius: 8px; padding: 12px; color: #ffffff; resize: vertical;"></textarea>
                    </div>
                    <button onclick="submitUnblockRequest()" style="background: linear-gradient(135deg, #ffaa00, #ff8800); border: none; color: black; padding: 15px 30px; border-radius: 10px; font-weight: bold; cursor: pointer; text-transform: uppercase;">ìš”ì²­ ì œì¶œ</button>
                </div>
            </div>

            <!-- ìƒíƒœ í™•ì¸ íƒ­ -->
            <div id="statusCheckTab" class="tab-content" style="display: none;">
                <h3 style="color: #00ff41; margin-bottom: 20px;">ğŸ” ìš”ì²­ ìƒíƒœ í™•ì¸</h3>
                <div style="background: rgba(0, 0, 0, 0.6); border: 2px solid #00ff41; border-radius: 15px; padding: 25px;">
                    <div style="display: flex; gap: 20px; margin-bottom: 20px; align-items: end;">
                        <div style="flex: 1;">
                            <label style="display: block; color: #00ff41; font-size: 14px; font-weight: bold; margin-bottom: 8px;">ìš”ì²­ ID</label>
                            <input type="text" id="requestID" placeholder="REQ-20250915-001" style="width: 100%; background: rgba(0, 0, 0, 0.8); border: 2px solid #00ff41; border-radius: 8px; padding: 12px; color: #ffffff;">
                        </div>
                        <button onclick="checkRequestStatus()" style="background: linear-gradient(135deg, #00ff41, #00cc33); border: none; color: black; padding: 15px 30px; border-radius: 10px; font-weight: bold; cursor: pointer; text-transform: uppercase;">ìƒíƒœ í™•ì¸</button>
                    </div>
                    <div id="statusResult" style="margin-top: 20px; display: none;">
                        <!-- ìƒíƒœ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë„ì›€ë§ ëª¨ë‹¬ -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ğŸ“š Cyber Sentinel ì™„ì „ ê°€ì´ë“œ</h2>
                <button class="close-btn" onclick="closeModal('helpModal')">Ã—</button>
            </div>
            <div style="max-height: 70vh; overflow-y: auto; line-height: 1.7; color: #ffffff;">

                <!-- ëª©ì°¨ -->
                <div style="background: rgba(0,255,65,0.08); border: 1px solid rgba(0,255,65,0.3); border-radius: 10px; padding: 16px; margin-bottom: 20px;">
                    <h3 style="color: #00ff41; margin: 0 0 10px 0;">ğŸ“‹ ì™„ì „ ê°€ì´ë“œ ëª©ì°¨</h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; font-size: 0.95em; color: #cfe;">
                        <a href="#guide-realtime" style="color:#cfe; text-decoration:none;">â€¢ ì‹¤ì‹œê°„ ì—°ë™ ì‹œìŠ¤í…œ</a>
                        <a href="#guide-types" style="color:#cfe; text-decoration:none;">â€¢ ë°©ì–´ ê³µê²© ìœ í˜•</a>
                        <a href="#guide-criteria" style="color:#cfe; text-decoration:none;">â€¢ ê³µê²©ë³„ ì°¨ë‹¨ ê·¼ê±°</a>
                        <a href="#guide-risk" style="color:#cfe; text-decoration:none;">â€¢ ìœ„í—˜ë„ ê³„ì‚°</a>
                        <a href="#guide-ai" style="color:#cfe; text-decoration:none;">â€¢ AI íƒì§€ ì›ë¦¬</a>
                        <a href="#guide-sources" style="color:#cfe; text-decoration:none;">â€¢ ê¸°ìˆ ì  ê·¼ê±°/CVE</a>
                        <a href="#guide-shortcuts" style="color:#cfe; text-decoration:none;">â€¢ ë‹¨ì¶•í‚¤ & ìŒì„±</a>
                        <a href="#guide-test" style="color:#cfe; text-decoration:none;">â€¢ í…ŒìŠ¤íŠ¸ ë°©ë²•</a>
                        <a href="#guide-status" style="color:#cfe; text-decoration:none;">â€¢ ìƒíƒœ ìš©ì–´</a>
                    </div>
                </div>

                <!-- ì‹¤ì‹œê°„ ì—°ë™ ì‹œìŠ¤í…œ -->
                <h3 id="guide-realtime" style="color:#00ff41; border-bottom:2px solid #00ff41; padding-bottom:6px;">ğŸ¤– ì‹¤ì‹œê°„ ì—°ë™ ì‹œìŠ¤í…œ</h3>
                <div style="background: rgba(0,255,65,0.08); padding:14px; border-radius:8px; margin-bottom:18px;">
                    â€¢ ì¦‰ì‹œ ë°˜ì‘(â‰¤0.1s) â€¢ 3ì´ˆ í´ë§ â€¢ Lambda/API Gateway â€¢ DynamoDB ì‹¤ì‹œê°„ ì €ì¥ â€¢ Slack ì•Œë¦¼ â€¢ WAF ì°¨ë‹¨ â€¢ CloudWatch ëª¨ë‹ˆí„°ë§ â€¢ GuardDuty ìœ„í˜‘ íƒì§€ ì—°ë™
                </div>

                <!-- ë°©ì–´ ê³µê²© ìœ í˜• ìš”ì•½ -->
                <h3 id="guide-types" style="color:#ff0040; border-bottom:2px solid #ff0040; padding-bottom:6px;">ğŸ›¡ï¸ ë°©ì–´ ê°€ëŠ¥í•œ ê³µê²© ì „ ëª©ë¡</h3>
                <div style="display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-bottom:18px;">
                    <div style="background:rgba(255,0,64,0.08); padding:10px; border-radius:8px;">
                        <strong style="color:#ff0040;">ì›¹</strong><br><small>SQLi, XSS, CSRF, Path Traversal, LFI/RFI</small>
                    </div>
                    <div style="background:rgba(255,102,0,0.08); padding:10px; border-radius:8px;">
                        <strong style="color:#ff6600;">ë„¤íŠ¸ì›Œí¬</strong><br><small>DDoS/DoS, Port Scan, ARP, DNS, SSRF</small>
                    </div>
                    <div style="background:rgba(255,204,0,0.08); padding:10px; border-radius:8px;">
                        <strong style="color:#ffcc00;">ì•…ì„±ì½”ë“œ</strong><br><small>Ransomware, Malware, Crypto Mining</small>
                    </div>
                    <div style="background:rgba(0,255,136,0.08); padding:10px; border-radius:8px;">
                        <strong style="color:#00ff88;">ì¸ì¦</strong><br><small>Brute Force, Credential Stuffing</small>
                    </div>
                    <div style="background:rgba(0,150,255,0.08); padding:10px; border-radius:8px;">
                        <strong style="color:#0096ff;">ë°ì´í„°</strong><br><small>Exfiltration, Phishing, Social Engineering</small>
                    </div>
                    <div style="background:rgba(255,0,255,0.08); padding:10px; border-radius:8px;">
                        <strong style="color:#ff00ff;">AI ê¸°ë°˜</strong><br><small>AIâ€‘Powered, Deepfake, ML Evasion</small>
                    </div>
                </div>

                <!-- ê³µê²©ë³„ ì°¨ë‹¨ ê·¼ê±° -->
                <h3 id="guide-criteria" style="color:#ff6600; border-bottom:2px solid #ff6600; padding-bottom:6px;">ğŸ›¡ï¸ ê³µê²©ë³„ ì°¨ë‹¨ ê·¼ê±° ë° ê¸°ì¤€</h3>
                <div style="margin-bottom:16px;">
                    <div style="background:rgba(255,0,102,0.06); border:1px solid rgba(255,0,102,0.25); border-radius:10px; padding:14px; margin-bottom:12px;">
                        <h4 style="color:#ff0066; margin:0 0 8px 0;">ğŸ¯ SQL ì¸ì ì…˜</h4>
                        <div style="color:#eee; font-size:.95em; line-height:1.8;">
                            <div><strong>íƒì§€ íŒ¨í„´:</strong> UNION SELECT, ';-- ì£¼ì„, OR '1'='1', SLEEP(), LOAD_FILE(), INFORMATION_SCHEMA ì¡°íšŒ, CONCAT/CHAR ì¡°í•©</div>
                            <div><strong>ìš°íšŒ íƒì§€:</strong> ê³µë°± ìš°íšŒ(/**/,+), ì¸ì½”ë”©(%27 ë“±), ì¤‘ì²© ì¿¼ë¦¬, íƒ€ì„ ê¸°ë°˜ ì§€ì—°</div>
                            <div><strong>ì°¨ë‹¨ ê¸°ì¤€:</strong> í•µì‹¬ í‚¤ì›Œë“œ 3ê°œâ†‘ ë˜ëŠ” íƒ€ì„ ê¸°ë°˜ ì§€ì—° íƒì§€â†’ì°¨ë‹¨(â‰¥88)</div>
                            <div><strong>ê·¼ê±°:</strong> OWASP A03â€‘Injection, CWEâ€‘89</div>
                        </div>
                    </div>
                    <div style="background:rgba(255,102,0,0.06); border:1px solid rgba(255,102,0,0.25); border-radius:10px; padding:14px; margin-bottom:12px;">
                        <h4 style="color:#ff6600; margin:0 0 8px 0;">ğŸ’¥ DDoS</h4>
                        <div style="color:#eee; font-size:.95em; line-height:1.8;">
                            <div><strong>íƒì§€ íŒ¨í„´:</strong> SYN/UDP Flood, HTTP GET/POST Flood, Slowloris, IP/UA ë‹¤ì–‘ì„± ê¸‰ì¦, 429/5xx í­ì¦</div>
                            <div><strong>í–‰ìœ„ ì§€í‘œ:</strong> ì´ˆÂ·ë¶„ë‹¹ ìš”ì²­ ì„ê³„ ì´ˆê³¼, ë™ì¼ ì†ŒìŠ¤ ë¶„ì‚° ì¦ê°€, ì§€ì—­/ASN ë¶„ì‚°ë„ ìƒìŠ¹</div>
                            <div><strong>ì°¨ë‹¨ ê¸°ì¤€:</strong> L3/4/7 ì‹œê·¸ë‹ˆì²˜/í–‰ìœ„ ë§¤ì¹­ ë˜ëŠ” ì„ê³„ ì´ˆê³¼â†’ì°¨ë‹¨(â‰¥90)</div>
                            <div><strong>ê·¼ê±°:</strong> RFC4732, NIST SP 800â€‘61r2</div>
                        </div>
                    </div>
                    <div style="background:rgba(255,204,0,0.06); border:1px solid rgba(255,204,0,0.25); border-radius:10px; padding:14px; margin-bottom:12px;">
                        <h4 style="color:#ffcc00; margin:0 0 8px 0;">ğŸ”’ ëœì„¬ì›¨ì–´</h4>
                        <div style="color:#eee; font-size:.95em; line-height:1.8;">
                            <div><strong>íƒì§€ íŒ¨í„´:</strong> í™•ì¥ì ì¼ê´„ ë³€ê²½(.enc/.cry), ë³¼ë¥¨ ì„€ë„ ë³µì‚¬ë³¸ ì‚­ì œ, ë°±ì—… ë””ë ‰í„°ë¦¬ ì ‘ê·¼, ì•”í˜¸í™” í”„ë¡œì„¸ìŠ¤ ê¸‰ì¦</div>
                            <div><strong>ë„¤íŠ¸ì›Œí¬ ì§€í‘œ:</strong> C2 ë„ë©”ì¸ ì ‘ì†, TOR/í”„ë¡ì‹œ ì‚¬ìš©, ë¹„ì •ìƒ ì™¸ë¶€ POST ì§€ì†</div>
                            <div><strong>ì°¨ë‹¨ ê¸°ì¤€:</strong> ì‹œê·¸ë‹ˆì²˜ ë˜ëŠ” í–‰ìœ„ ì¡°í•© ë§¤ì¹­â†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥95)</div>
                            <div><strong>ê·¼ê±°:</strong> MITRE ATT&CK T1486, NIST CSF</div>
                        </div>
                    </div>
                    <div style="background:rgba(0,255,136,0.06); border:1px solid rgba(0,255,136,0.25); border-radius:10px; padding:14px;">
                        <h4 style="color:#00ff88; margin:0 0 8px 0;">ğŸ“œ XSS</h4>
                        <div style="color:#eee; font-size:.95em; line-height:1.8;">
                            <div><strong>íƒì§€ íŒ¨í„´:</strong> &lt;script&gt;, onerror/onload, javascript: URL, <code>eval()</code>, <code>document.cookie</code> ì ‘ê·¼</div>
                            <div><strong>DOM/Reflected/Stored êµ¬ë¶„:</strong> DOM ë³€ì¡°, URL/í¼ ë°˜ì‚¬, DB ì €ì¥ í›„ ë°˜ì‚¬</div>
                            <div><strong>ìš°íšŒ ê¸°ë²•:</strong> ì´ì¤‘ ì¸ì½”ë”©, ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì‚½ì…, í…œí”Œë¦¿/Markdown ìš°íšŒ</div>
                            <div><strong>ì°¨ë‹¨ ê¸°ì¤€:</strong> ì•…ì„± ìŠ¤í¬ë¦½íŠ¸/ìš°íšŒ íƒì§€â†’ì°¨ë‹¨(â‰¥75), ì¿ í‚¤ íƒˆì·¨/ì„¸ì…˜ í•˜ì´ì¬í‚¹ ì§•í›„â†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥85)</div>
                            <div><strong>ê·¼ê±°:</strong> OWASP A07â€‘XSS, CWEâ€‘79</div>
                        </div>
                    </div>
                </div>

                <!-- ìƒì„¸ ì‹œë‚˜ë¦¬ì˜¤: ëœì„¬ì›¨ì–´ / XSS / Brute Force / ë°ì´í„° ìœ ì¶œ / í¬ë¦½í† ë§ˆì´ë‹ / AI ê³µê²© -->
                <div style="margin-bottom:18px;">
                    <div style="background:rgba(255,204,0,0.06); border:1px solid rgba(255,204,0,0.25); border-radius:10px; padding:16px; margin-bottom:12px;">
                        <h4 style="color:#ffcc00; margin:0 0 10px 0;">ğŸ§¬ ëœì„¬ì›¨ì–´ (Ransomware)</h4>
                        <div style="color:#ddd; font-size:.95em;">
                            <div><strong>íƒì§€ ì‹œê·¸ë‹ˆì²˜:</strong> WannaCry/Locky/CryptLocker, í™•ì¥ì ë³€ê²½(<em>.enc</em>, <em>.cry</em>), í”„ë¡œì„¸ìŠ¤/ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë³€ê²½</div>
                            <div><strong>í–‰ìœ„ ê¸°ë°˜ íƒì§€:</strong> ëŒ€ëŸ‰ íŒŒì¼ ì•”í˜¸í™” ì‹œë„(100ê±´â†‘/ë¶„), ë„¤íŠ¸ì›Œí¬ ë“œë¼ì´ë¸Œ ì ‘ê·¼, ë°±ì—… ë³¼ë¥¨ ì‚­ì œ, ë¹„ì •ìƒ í”„ë¡œì„¸ìŠ¤ ìƒì„±</div>
                            <div><strong>ì°¨ë‹¨ ê¸°ì¤€:</strong> ì‹œê·¸ë‹ˆì²˜ ë§¤ì¹­â†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥100), ì˜ì‹¬ìŠ¤ëŸ¬ìš´ ì•”í˜¸í™” ë°˜ë³µâ†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥98), C2 í†µì‹  ì‹œë„â†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥95)</div>
                            <div><strong>ê·¼ê±°:</strong> MITRE ATT&CK T1486, NIST CSF</div>
                        </div>
                    </div>
                    <div style="background:rgba(0,255,136,0,0.06); border:1px solid rgba(0,255,136,0.25); border-radius:10px; padding:16px; margin-bottom:12px;">
                        <h4 style="color:#00ff88; margin:0 0 10px 0;">ğŸ§ª XSS (Crossâ€‘Site Scripting)</h4>
                        <div style="color:#ddd; font-size:.95em;">
                            <div><strong>ìŠ¤í¬ë¦½íŠ¸ íŒ¨í„´:</strong> &lt;script&gt;, onload/onerror, javascript: URL, <em>eval</em>, document.cookie</div>
                            <div><strong>ìœ í˜• íƒì§€:</strong> Reflected/Stored/DOMâ€‘based XSS, ì¸ì½”ë”©/ìš°íšŒ ê¸°ë²• íƒì§€</div>
                            <div><strong>ì°¨ë‹¨ ì¡°ê±´:</strong> ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ íƒì§€â†’ìš”ì²­ ì°¨ë‹¨(â‰¥75), ì¿ í‚¤ íƒˆì·¨ ì‹œë„â†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥85), ì„¸ì…˜ í•˜ì´ì¬í‚¹ ì‹œë„â†’ìë™ ì°¨ë‹¨(â‰¥88)</div>
                            <div><strong>ê·¼ê±°:</strong> OWASP Top10 A07, CWEâ€‘79</div>
                        </div>
                    </div>
                    <div style="background:rgba(0,255,136,0.06); border:1px solid rgba(0,255,136,0.25); border-radius:10px; padding:16px; margin-bottom:12px;">
                        <h4 style="color:#00ff88; margin:0 0 10px 0;">ğŸ” ë¬´ì°¨ë³„ ëŒ€ì… (Brute Force)</h4>
                        <div style="color:#ddd; font-size:.95em;">
                            <div><strong>ì„ê³„ê°’:</strong> ë™ì¼ IP 5íšŒ/ë¶„ ì‹¤íŒ¨, ë™ì¼ ê³„ì • 10íšŒ/ì‹œê°„, ì‚¬ì „ ëª©ë¡ íŒ¨í„´(admin, 123456 ë“±)</div>
                            <div><strong>í–‰ìœ„ ë¶„ì„:</strong> ìˆœì°¨ ê³„ì • ì‹œë„, ì—¬ëŸ¬ IPì˜ ë™ì¼ ê³„ì • ê³µëµ, ë¹„ì •ìƒ ë¡œê·¸ì¸ ì‹œê°„ëŒ€</div>
                            <div><strong>ì°¨ë‹¨:</strong> 5íšŒ ì‹¤íŒ¨â†’1ë¶„ ì°¨ë‹¨(â‰¥60), 10íšŒâ†’10ë¶„(â‰¥75), 20íšŒâ†’1ì‹œê°„(â‰¥85), ê³„ì • ì ê¸ˆ ì‹œë„â†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥90)</div>
                            <div><strong>ê·¼ê±°:</strong> NIST SP 800â€‘63B, ISO 27001 A.9.4.2</div>
                        </div>
                    </div>
                    <div style="background:rgba(153,0,255,0.06); border:1px solid rgba(153,0,255,0.25); border-radius:10px; padding:16px; margin-bottom:12px;">
                        <h4 style="color:#9966ff; margin:0 0 10px 0;">ğŸ“¤ ë°ì´í„° ìœ ì¶œ (Exfiltration)</h4>
                        <div style="color:#ddd; font-size:.95em;">
                            <div><strong>ë¯¼ê° ë°ì´í„° íŒ¨í„´:</strong> ì£¼ë¯¼ë²ˆí˜¸, ì‹ ìš©ì¹´ë“œ, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸ ì •ê·œì‹ íƒì§€/ë§ˆìŠ¤í‚¹</div>
                            <div><strong>ìœ ì¶œ ì‹œë„:</strong> ëŒ€ëŸ‰ ë‹¤ìš´ë¡œë“œ(100MBâ†‘), ë¹„ì •ìƒ ì‹œê°„ëŒ€(ìƒˆë²½), ì•”í˜¸í™”ë˜ì§€ ì•Šì€ ì „ì†¡, ì™¸ë¶€ ìŠ¤í† ë¦¬ì§€ ì—…ë¡œë“œ</div>
                            <div><strong>ì°¨ë‹¨:</strong> ë¯¼ê° ë°ì´í„° 10ê±´â†‘ ì ‘ê·¼â†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥95), ë¹„ì¸ê°€ ë‹¤ìš´ë¡œë“œâ†’ìë™ ì°¨ë‹¨(â‰¥88)</div>
                            <div><strong>ê·¼ê±°:</strong> GDPR Art.32, ISO 27018</div>
                        </div>
                    </div>
                    <div style="background:rgba(255,170,0,0.06); border:1px solid rgba(255,170,0,0.25); border-radius:10px; padding:16px; margin-bottom:12px;">
                        <h4 style="color:#ffaa00; margin:0 0 10px 0;">â›ï¸ í¬ë¦½í† ë§ˆì´ë‹ (Crypto Mining)</h4>
                        <div style="color:#ddd; font-size:.95em;">
                            <div><strong>ì±„êµ´ ì§•í›„:</strong> stratum í”„ë¡œí† ì½œ, ê³  CPU ì‚¬ìš©ë¥ , WebAssembly ì±„êµ´ ìŠ¤í¬ë¦½íŠ¸, pool.moneragate ë“±</div>
                            <div><strong>ë„¤íŠ¸ì›Œí¬ íŒ¨í„´:</strong> 3333/4444 í¬íŠ¸, ì§€ì† ì—°ê²°, ë¹„ì •ìƒ íŠ¸ë˜í”½ ì¦ê°€</div>
                            <div><strong>ì°¨ë‹¨:</strong> ì±„êµ´ ìŠ¤í¬ë¦½íŠ¸ íƒì§€â†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥70), ì±„êµ´ í’€ ì—°ê²°â†’ìë™ ì°¨ë‹¨(â‰¥75)</div>
                            <div><strong>ê·¼ê±°:</strong> ì•…ì„±ì½”ë“œ ë¶„ì„ ì§€ì¹¨, ê¸°ì—… ë³´ì•ˆ ì •ì±…</div>
                        </div>
                    </div>
                    <div style="background:rgba(153,102,255,0.06); border:1px solid rgba(153,102,255,0.25); border-radius:10px; padding:16px;">
                        <h4 style="color:#9966ff; margin:0 0 10px 0;">ğŸ§  AI ê¸°ë°˜ ê³µê²©</h4>
                        <div style="color:#ddd; font-size:.95em;">
                            <div><strong>ì£¼ìš” ìœ í˜•(ì‰¬ìš´ ì„¤ëª…):</strong> ëª¨ë¸ í›”ì¹˜ê¸°(ëª¨ë¸ íŒŒì¼/íŒŒë¼ë¯¸í„° ë¹¼ê°€ê¸°), ì†ì´ê¸°ìš© ì…ë ¥(ì´ë¯¸ì§€Â·ë¬¸êµ¬ë¥¼ êµë¬˜íˆ ë°”ê¿” AIë¥¼ ì†ì„), í•™ìŠµ ë°ì´í„° ì˜¤ì—¼(ê°€ì§œ ë°ì´í„° ë„£ì–´ AI íŒë‹¨ ì™œê³¡)</div>
                            <div><strong>ê³ ê¸‰ íƒì§€:</strong> ì´ìƒí–‰ìœ„ ì ìˆ˜, ë¹„ì •ìƒì ì¸ ìš”ì²­ ë¹ˆë„, ì¸ê°„ì´ ì•„ë‹Œ ìƒí˜¸ì‘ìš©</div>
                            <div><strong>ì°¨ë‹¨:</strong> ëª¨ë¸ ê³µê²© íƒì§€â†’ì¦‰ì‹œ ì°¨ë‹¨(â‰¥95), ìë™í™” ë„êµ¬â†’ìë™ ì°¨ë‹¨(â‰¥80)</div>
                            <div><strong>ê·¼ê±°:</strong> NIST AI RMF, IEEE AI Standards</div>
                        </div>
                    </div>
                </div>

                <!-- CVE ì£¼ìš” ì‚¬ë¡€ -->
                <h3 id="guide-cve" style="color:#00ff88; border-bottom:2px solid #00ff88; padding-bottom:6px;">ğŸ—‚ï¸ CVE ì£¼ìš” ì‚¬ë¡€</h3>
                <div style="display:grid; grid-template-columns:repeat(2,1fr); gap:12px; margin-bottom:16px; font-size:.95em;">
                    <div style="background:rgba(0,255,136,0.06); border:1px solid rgba(0,255,136,0.25); border-radius:10px; padding:12px;">
                        <strong style="color:#00ff88;">ì›¹/ì• í”Œë¦¬ì¼€ì´ì…˜</strong>
                        <ul style="margin:8px 0 0 16px; line-height:1.7;">
                            <li>CVEâ€‘2021â€‘44228 (Log4Shell): JNDI LDAP RCE</li>
                            <li>CVEâ€‘2017â€‘5638 (Apache Struts2): OGNL RCE</li>
                            <li>CVEâ€‘2019â€‘11043 (PHPâ€‘FPM): PATH_INFO RCE</li>
                            <li>CVEâ€‘2014â€‘0160 (Heartbleed): TLS ë©”ëª¨ë¦¬ ìœ ì¶œ</li>
                            <li>CVEâ€‘2018â€‘11776 (Struts2): Namespace RCE</li>
                        </ul>
                    </div>
                    <div style="background:rgba(255,170,0,0.06); border:1px solid rgba(255,170,0,0.25); border-radius:10px; padding:12px;">
                        <strong style="color:#ffaa00;">ì¸ì¦/ë„¤íŠ¸ì›Œí¬/ê¸°íƒ€</strong>
                        <ul style="margin:8px 0 0 16px; line-height:1.7;">
                            <li>CVEâ€‘2020â€‘1472 (Zerologon): Netlogon ê¶Œí•œ ìƒìŠ¹</li>
                            <li>CVEâ€‘2018â€‘13379 (Fortinet): SSL VPN ê²½ë¡œ íƒìƒ‰</li>
                            <li>CVEâ€‘2022â€‘26134 (Confluence): OGNL RCE</li>
                            <li>CVEâ€‘2020â€‘5902 (F5 BIGâ€‘IP): TMUI RCE</li>
                            <li>CVEâ€‘2021â€‘34527 (PrintNightmare): Spooler RCE</li>
                        </ul>
                    </div>
                </div>

                <!-- ìœ„í—˜ë„ ê³„ì‚° ì‹œìŠ¤í…œ -->
                <h3 id="guide-risk" style="color:#ff0040; border-bottom:2px solid #ff0040; padding-bottom:6px;">âš ï¸ ìœ„í—˜ë„ ê³„ì‚° ì‹œìŠ¤í…œ</h3>
                <div style="background:rgba(255,0,64,0.08); padding:14px; border-radius:8px; margin-bottom:12px;">
                    ìµœì¢…ìœ„í—˜ë„ = min(ê¸°ë³¸ì ìˆ˜ Ã— ìœ„í˜‘ê°€ì¤‘ì¹˜ Ã— ì§€ì—­ê°€ì¤‘ì¹˜ Ã— ë¹ˆë„ê°€ì¤‘ì¹˜, 100)
                </div>
                <div style="display:grid; grid-template-columns:repeat(5,1fr); gap:8px; font-size:.9em; margin-bottom:14px;">
                    <div style="text-align:center; background:rgba(255,0,0,0.2); padding:8px; border-radius:5px;"><strong style="color:#ff0000;">CRITICAL</strong><br>90â€‘100</div>
                    <div style="text-align:center; background:rgba(255,102,0,0.2); padding:8px; border-radius:5px;"><strong style="color:#ff6600;">HIGH</strong><br>75â€‘89</div>
                    <div style="text-align:center; background:rgba(255,204,0,0.2); padding:8px; border-radius:5px;"><strong style="color:#ffcc00;">MEDIUM</strong><br>50â€‘74</div>
                    <div style="text-align:center; background:rgba(0,255,136,0.2); padding:8px; border-radius:5px;"><strong style="color:#00ff88;">LOW</strong><br>25â€‘49</div>
                    <div style="text-align:center; background:rgba(150,150,150,0.2); padding:8px; border-radius:5px;"><strong style="color:#bbb;">INFO</strong><br>0â€‘24</div>
                </div>
                <small>ê°€ì¤‘ì¹˜ ì˜ˆ: ëœì„¬ì›¨ì–´(1.5), DDoS(1.3), SQLi(1.2) / ê³ ìœ„í—˜êµ­ê°€(1.3), ë‚´ë¶€ë§(0.8) / ë¶„ì‚°ê³µê²©(1.4)</small>

                <!-- AI íƒì§€ ì›ë¦¬ -->
                <h3 id="guide-ai" style="color:#9966ff; border-bottom:2px solid #9966ff; padding-bottom:6px; margin-top:16px;">ğŸ¤– AI íƒì§€ ì›ë¦¬</h3>
                <div style="background:rgba(153,102,255,0.08); padding:14px; border-radius:8px;">
                    ì‹œê·¸ë‹ˆì²˜ + í–‰ìœ„ê¸°ë°˜ + ML ì•™ìƒë¸”ë¡œ ì´ìƒí–‰ë™/ë¹ˆë„/ì§€ë¦¬/ì„¸ì…˜ íŒ¨í„´ì„ ì¢…í•© ë¶„ì„ í›„ ì°¨ë‹¨/ìˆ˜ë™ê²€í† ë¡œ ë¶„ê¸°
                </div>

                <!-- í…ŒìŠ¤íŠ¸ ë°©ë²• -->
                <h3 id="guide-test" style="color:#ffaa00; border-bottom:2px solid #ffaa00; padding-bottom:6px; margin-top:16px;">ğŸ¯ í…ŒìŠ¤íŠ¸ ë°©ë²•</h3>
                <div style="background:rgba(255,170,0,0.08); padding:14px; border-radius:8px;">
                    curl -X POST https://b9i9l3fspk.execute-api.ap-northeast-2.amazonaws.com/prod -H "Content-Type: application/json" -d '{"action":"simulate_threat","threat_type":"SQLINJECTION","severity":"HIGH","source_ip":"203.0.113.45"}'
                </div>
                <small>severity=MEDIUMì´ë©´ ìˆ˜ë™ê²€í† ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤.</small>

                <!-- ìƒíƒœ ìš©ì–´ -->
                <h3 id="guide-status" style="color:#ffaa00; border-bottom:2px solid #ffaa00; padding-bottom:6px; margin-top:16px;">ğŸ§­ ìƒíƒœ ìš©ì–´</h3>
                <ul style="margin-left:18px; line-height:1.8;">
                    <li><strong>í™œì„±</strong>: í˜„ì¬ ì°¨ë‹¨ì´ ìœ ì§€ ì¤‘ì´ë©° ìœ„í˜‘ì´ ìœ íš¨</li>
                    <li><strong>ë³µêµ¬ë¨</strong>: ì¼ì‹œì  ì´ìƒ í›„ ì •ìƒ íšŒë³µ ë˜ëŠ” ë³µêµ¬ ì™„ë£Œ</li>
                    <li><strong>ì˜¤ë¥˜</strong>: ìˆ˜ì§‘/ì²˜ë¦¬/ë™ê¸°í™” ì˜¤ë¥˜ë¡œ íŒë³„ ë¶ˆê°€</li>
                    <li><strong>ê¸´ê¸‰</strong>: ì¦‰ê° ì¡°ì¹˜ í•„ìš”í•œ ê³ ìœ„í—˜ ìƒíƒœ</li>
                    <li><strong>ëŒ€ì²´</strong>: ì›ë³¸ ë¶€ì¬ë¡œ ì„ì‹œ/ëŒ€ì²´ ë ˆì½”ë“œ(Fallback)</li>
                </ul>

                <!-- ê·¼ê±°/ì¶œì²˜ -->
                <h3 id="guide-sources" style="color:#00ff88; border-bottom:2px solid #00ff88; padding-bottom:6px; margin-top:16px;">ğŸ“š ê¸°ìˆ ì  ê·¼ê±° ë° ì¶œì²˜</h3>
                <div style="display:grid; grid-template-columns:repeat(3,1fr); gap:12px;">
                    <div><strong style="color:#00ff88;">í•™ìˆ /í‘œì¤€</strong><br><small>NIST CSF, NIST SP 800â€‘61/63, ISO 27001, OWASP Top 10</small></div>
                    <div><strong style="color:#00ff88;">ìœ„í˜‘ ì¸í…”ë¦¬ì „ìŠ¤</strong><br><small>KISA, CISA, VirusTotal, IBM Xâ€‘Force, MITRE ATT&CK</small></div>
                    <div><strong style="color:#00ff88;">ì·¨ì•½ì  DB</strong><br><small>CVE(cve.mitre.org), NVD, Exploitâ€‘DB</small></div>
                </div>

                <!-- ë‹¨ì¶•í‚¤ & ìŒì„± -->
                <h3 id="guide-shortcuts" style="color:#00ccff; border-bottom:2px solid #00ccff; padding-bottom:6px; margin-top:16px;">âŒ¨ï¸ ë‹¨ì¶•í‚¤ & ğŸ¤ ìŒì„±</h3>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:8px; font-size:.95em;">
                    <div>
                        <strong>ë‹¨ì¶•í‚¤ (ì‹¤ì œ ì‘ë™)</strong><br>
                        â€¢ Ctrl+Shift+T: ì¢…í•© í›ˆë ¨ì†Œ(í…ŒìŠ¤íŠ¸)<br>
                        â€¢ Ctrl+Shift+S: ë³´ì•ˆê°ì‚¬ì²­(ë³´ì•ˆ ìŠ¤ìº”)<br>
                        â€¢ Ctrl+Shift+M: ìˆ˜ë™ ì „íˆ¬<br>
                        â€¢ Ctrl+Shift+R: í™˜ê²½ì²­(ì‹œìŠ¤í…œ ì ê²€)<br>
                        â€¢ Ctrl+H: ë„ì›€ë§ ì—´ê¸°/ë‹«ê¸°
                    </div>
                    <div>
                        <strong>ì½˜ì†” ëª…ë ¹</strong><br>
                        CyberSentinel.test() Â· CyberSentinel.refresh() Â· CyberSentinel.status()
                    </div>
                </div>
                <small>ìŒì„±: "ì¢…í•© í›ˆë ¨ì†Œ", "ë³´ì•ˆê°ì‚¬ì²­", "í™˜ê²½ì²­", "ìˆ˜ë™ ì „íˆ¬", "ë³´ê³ ì„œ ìƒì„±", "ë„ì›€ë§"</small>
                
                <!-- ì¶”ê°€: ìš´ì˜/íƒì§€/ì •ì±…/í•„ë“œ ì‚¬ì „/FAQë¥¼ í¬í•¨í•œ ì´ˆìƒì„¸ ê°€ì´ë“œ -->
                <h3 style="color:#00ccff; border-bottom:2px solid #00ccff; padding-bottom:6px; margin-top:20px;">ğŸ§© í•µì‹¬ ê¸°ëŠ¥ í•œëˆˆì—</h3>
                <ul style="margin-left:18px; line-height:1.9; color:#e8fff0;">
                    <li><strong>ì¦‰ì‹œ ë°˜ì‘</strong>: ë²„íŠ¼ í´ë¦­ â‰¤0.1s ë‚´ UI/ì•Œë¦¼ ë°˜ì˜</li>
                    <li><strong>ì‹¤ì‹œê°„ í´ë§</strong>: 3ì´ˆ ê°„ê²©ìœ¼ë¡œ Lambda API ìƒíƒœ ë™ê¸°í™”</li>
                    <li><strong>ìë™ ì°¨ë‹¨</strong>: HIGH/CRITICAL ì´ë²¤íŠ¸ëŠ” ì¦‰ì‹œ ì°¨ë‹¨ ë° Slack ë°œì†¡</li>
                    <li><strong>ìˆ˜ë™ ê²€í† </strong>: MEDIUM ì´ë²¤íŠ¸ëŠ” ìˆ˜ë™ ì „íˆ¬ ì œì–´íŒì— ì ì¬</li>
                    <li><strong>ì°¨ë‹¨/í•´ì œ ì›Œí¬í”Œë¡œ</strong>: ìš”ì²­â†’ìŠ¹ì¸/ê±°ì ˆâ†’ê°ì‚¬ë¡œê·¸ê¹Œì§€ ì¼ì›í™”</li>
                    <li><strong>ë³´ê³ ì„œ</strong>: ìƒì„¸ CSV(S3) + ê°„ì´ CSV(ë¡œì»¬) ì´ì¤‘í™”</li>
                </ul>

                <h3 style="color:#ff0040; border-bottom:2px solid #ff0040; padding-bottom:6px; margin-top:18px;">ğŸ§ª íƒì§€ ì‹œê·¸ë‹ˆì²˜ & í–‰ìœ„ ê¸°ë°˜ ì˜ˆì‹œ</h3>
                <div style="display:grid; grid-template-columns:repeat(2,1fr); gap:14px;">
                    <div style="background:rgba(255,0,64,0.08); padding:14px; border-radius:10px;">
                        <strong style="color:#ff3760;">ì‹œê·¸ë‹ˆì²˜ ê¸°ë°˜</strong>
                        <ul style="margin:8px 0 0 16px; line-height:1.8; color:#f2f2f2;">
                            <li>SQLi: UNION SELECT, SLEEP(), LOAD_FILE()</li>
                            <li>XSS: <code>&lt;script&gt;</code>, onerror, javascript: URL, <code>eval()</code></li>
                            <li>Ransomware: í™•ì¥ì ëŒ€ëŸ‰ ë³€ê²½, ë°±ì—… ì‚­ì œ ëª…ë ¹</li>
                            <li>Mining: stratum í”„ë¡œí† ì½œ, WASM ì±„êµ´ ìŠ¤í¬ë¦½íŠ¸</li>
                        </ul>
                    </div>
                    <div style="background:rgba(0,255,136,0.08); padding:14px; border-radius:10px;">
                        <strong style="color:#00ff88;">í–‰ìœ„ ê¸°ë°˜</strong>
                        <ul style="margin:8px 0 0 16px; line-height:1.8; color:#f2f2f2;">
                            <li>ë¡œê·¸ì¸ ì‹¤íŒ¨ ê¸‰ì¦(5/ë¶„, 10/ì‹œ ë“± ì„ê³„)</li>
                            <li>ì•¼ê°„ ì‹œê°„ëŒ€ ë¹„ì •ìƒ ë‹¤ìš´ë¡œë“œ(>100MB)</li>
                            <li>ë™ì¼ ì„¸ì…˜ì—ì„œ ì§€ë¦¬ì  ê¸‰ì´ë™</li>
                            <li>API 429/5xx ê¸‰ì¦ + ë™ì¼ User-Agent</li>
                        </ul>
                    </div>
                </div>

                <h3 style="color:#ffaa00; border-bottom:2px solid #ffaa00; padding-bottom:6px; margin-top:18px;">ğŸ“ ìœ„í—˜ë„ ê³„ì‚° ê³µì‹ (ì˜ˆì‹œ)</h3>
                <div style="background:rgba(255,170,0,0.08); padding:14px; border-radius:10px; color:#fff;">
                    ìµœì¢…ìœ„í—˜ë„ = min(ê¸°ë³¸ì ìˆ˜ Ã— ìœ„í˜‘ê°€ì¤‘ì¹˜ Ã— ì§€ì—­ê°€ì¤‘ì¹˜ Ã— ë¹ˆë„ê°€ì¤‘ì¹˜, 100)<br>
                    <small>ì˜ˆ: SQLi(ê¸°ë³¸ 60) Ã— ìœ í˜•(1.2) Ã— ì§€ì—­(1.1) Ã— ë¹ˆë„(1.3) â‰ˆ 103 â†’ 100ì (CRITICAL)</small>
                </div>

                <h3 style="color:#00ff41; border-bottom:2px solid #00ff41; padding-bottom:6px; margin-top:18px;">ğŸ› ï¸ ìš´ì˜ ì ˆì°¨</h3>
                <ol style="margin-left:18px; line-height:1.9; color:#e8fff0;">
                    <li>ê²½ë³´ ìˆ˜ì‹ (Slack/ëŒ€ì‹œë³´ë“œ) â†’ ìƒì„¸ í™•ì¸</li>
                    <li>MEDIUM: ìˆ˜ë™ ì „íˆ¬ ì œì–´íŒ ëª©ë¡ ì ê²€ í›„ ì°¨ë‹¨/í—ˆìš© ê²°ì •</li>
                    <li>HIGH/CRITICAL: ìë™ ì°¨ë‹¨ ê²€ì¦, ì˜¤íƒ ì‹œ ì¦‰ì‹œ í•´ì œ ìš”ì²­</li>
                    <li>ì‚¬í›„ ì²˜ë¦¬: ë³´ê³ ì„œ ìƒì„±, ì›ì¸/ì¬ë°œë°©ì§€ ê¸°ë¡</li>
                </ol>

                

                <h3 style="color:#ff66cc; border-bottom:2px solid #ff66cc; padding-bottom:6px; margin-top:18px;">ğŸ”’ ê°œì¸ì •ë³´ ë§ˆìŠ¤í‚¹ ê·œì¹™</h3>
                <ul style="margin-left:18px; line-height:1.9; color:#ffeefe;">
                    <li>ì£¼ë¯¼ë²ˆí˜¸/ì¹´ë“œë²ˆí˜¸/ì´ë©”ì¼/ì „í™”ë²ˆí˜¸ëŠ” ë³´ê³ ì„œì—ì„œ ìë™ ë§ˆìŠ¤í‚¹</li>
                    <li>Headersì˜ ì¿ í‚¤/ì„¸ì…˜ í† í°ì€ ì €ì¥ ì „ì— ì œê±° ë˜ëŠ” ë¶€ë¶„ ë§ˆìŠ¤í‚¹</li>
                </ul>

                <h3 style="color:#00ff88; border-bottom:2px solid #00ff88; padding-bottom:6px; margin-top:18px;">ğŸ—‚ï¸ CVE í™œìš© ê°€ì´ë“œ</h3>
                <ul style="margin-left:18px; line-height:1.9; color:#e8fff0;">
                    <li><strong>ì¡°íšŒ</strong>: CVE/NVD/Exploitâ€‘DB í‚¤ì›Œë“œ(ì œí’ˆ/ë²„ì „)ë¡œ ê²€ìƒ‰</li>
                    <li><strong>ì—°ê³„</strong>: íƒì§€ ë¡œê·¸ì˜ Service/Resource/Versionê³¼ ë§¤ì¹­</li>
                    <li><strong>ì¡°ì¹˜</strong>: ë²¤ë” íŒ¨ì¹˜ ì ìš©, ì„ì‹œ WAF ë£°, ì ‘ê·¼ ì œì–´</li>
                </ul>

                
            </div>
        </div>
    </div>
    
    <script>
        // ğŸ”¥ **Cyber Sentinel ì™„ë²½ ìˆ˜ì •ëœ JavaScript - ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±°**
        console.log('ğŸ”¥ Cyber Sentinel ì‹œì‘ (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±° ë²„ì „)');

        // =================================================================
        // ì „ì—­ ë³€ìˆ˜ ë° ì„¤ì •
        // =================================================================
        const API_BASE_URL = 'https://b9i9l3fspk.execute-api.ap-northeast-2.amazonaws.com/prod';
        const API_TIMEOUT = 10000;
        const MAX_RETRIES = 3;
        const SLACK_WEBHOOK_URL = 'https://hooks.slack.com/services/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'; // TODO: ì‹¤ì œ Webhookìœ¼ë¡œ êµì²´
        let pollingInterval = null;
        let timeInterval = null;
        let currentData = null;
        let isSystemInitialized = false;
        let currentChart = null;
        let horizontalChart = null;
        let isManualModalOpen = false;
        let manualReviewCountOverride = 0; // ìµœê·¼ ìˆ˜ë™ ê²€í†  ê°œìˆ˜ ìºì‹œ (ê¸°ë³¸ 0ìœ¼ë¡œ ê³ ì •)
        let manualReviewCountOverrideTs = 0;   // ìºì‹œ ì‹œê°(ms)

        // ìŠ¬ë™ ì•Œë¦¼ ìœ í‹¸ (ë¸Œë¼ìš°ì € CORS íšŒí”¼ ì‹œë„: no-cors/keepalive + sendBeacon ë°±ì—…)
        async function notifySlack(text) {
            try {
                if (!SLACK_WEBHOOK_URL || SLACK_WEBHOOK_URL.includes('YOUR_SLACK_WEBHOOK_URL_HERE')) {
                    console.warn('Slack Webhook ë¯¸ì„¤ì •');
                    return;
                }

                const payload = JSON.stringify({ text });

                // ìš°ì„  no-corsë¡œ ì‹œë„ (í—¤ë” ì—†ì´, preflight í”¼í•¨)
                await fetch(SLACK_WEBHOOK_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    keepalive: true,
                    body: payload
                });

                // ì¼ë¶€ í™˜ê²½ì—ì„œëŠ” no-corsê°€ ë§‰í ìˆ˜ ìˆì–´ sendBeacon ë³´ì¡° ì‹œë„
                if (navigator.sendBeacon) {
                    const blob = new Blob([payload], { type: 'text/plain' });
                    navigator.sendBeacon(SLACK_WEBHOOK_URL, blob);
                }
            } catch (e) {
                console.warn('Slack ì „ì†¡ ì‹¤íŒ¨:', e);
            }
        }

        // ë°±ì—”ë“œ í†µí•´ ìƒì„¸ Slack ì „ì†¡ (ì¤‘ë³µ ë°©ì§€: í”„ë¡ íŠ¸ ì§ì ‘ ì „ì†¡ ëŒ€ì‹  ì´ ê²½ë¡œë§Œ ì‚¬ìš©)
        async function postRealtimeAlert(payload) {
            try {
                const body = {
                    threat_type: payload.threat_type || 'FRONTEND_EVENT',
                    source_ip: payload.source_ip || '0.0.0.0',
                    severity: payload.severity || 'HIGH',
                    test: payload.test || 'direct_alert',
                    details: payload.details || 'Frontend triggered alert'
                };

                const res = await fetch(API_BASE_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(body),
                    mode: 'cors'
                });
                return res.ok;
            } catch (e) {
                console.warn('postRealtimeAlert ì‹¤íŒ¨:', e);
                return false;
            }
        }
        let horizontalUpdateInterval = null;
        let apiRetryCount = 0;
        let isAPIConnected = false;

        // ì „ì—­ ë‹¨ì¶•í‚¤ í•¸ë“¤ëŸ¬ ë“±ë¡
        window.addEventListener('keydown', (e) => {
            try {
                if (!e.ctrlKey || !e.shiftKey) return;
                const key = e.key.toLowerCase();
                // Ctrl+Shift+T : ì¢…í•© í›ˆë ¨ì†Œ(í…ŒìŠ¤íŠ¸)
                if (key === 't') {
                    e.preventDefault();
                    if (typeof CyberSentinel !== 'undefined' && CyberSentinel.test) {
                        CyberSentinel.test();
                    } else {
                        // ëŒ€ì²´: ì°¨ë‹¨ IP ìƒˆë¡œê³ ì¹¨
                        updateBlockedIPs && updateBlockedIPs();
                    }
                }
                // Ctrl+Shift+S : ë³´ì•ˆê°ì‚¬ì²­ (ë³´ì•ˆ ìŠ¤ìº”)
                if (key === 's') {
                    e.preventDefault();
                    performSecurityScan && performSecurityScan();
                }
                // Ctrl+Shift+M : ìˆ˜ë™ ì „íˆ¬
                if (key === 'm') {
                    e.preventDefault();
                    const btns = document.querySelectorAll('.management-btn');
                    if (btns && btns[0]) {
                        showManualReviewTab(btns[0]);
                    }
                }
                // Ctrl+Shift+R : í™˜ê²½ì²­ (ì‹œìŠ¤í…œ ì ê²€)
                if (key === 'r') {
                    e.preventDefault();
                    performSystemCheck && performSystemCheck();
                }
                // Ctrl+H : ë„ì›€ë§ í† ê¸€
                if (e.ctrlKey && !e.shiftKey && key === 'h') {
                    e.preventDefault();
                    const modal = document.getElementById('helpModal');
                    if (modal && modal.style.display === 'block') closeModal('helpModal');
                    else openModal && openModal('helpModal');
                }
            } catch (err) {
                console.warn('ë‹¨ì¶•í‚¤ ì²˜ë¦¬ ì˜¤ë¥˜:', err);
            }
        });

        // ì˜¤ë””ì˜¤ ê°ì²´
        let alertSound = null;
        let dangerSound = null;

        // ìŒì„± ì¸ì‹ ë³€ìˆ˜
        let recognition = null;
        let isListening = false;

        // =================================================================
        // ğŸ”— ì‹¤ì œ AWS API ì—°ê²° í•¨ìˆ˜ë“¤ (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±°)
        // =================================================================
        async function connectToAwsAPI() {
            console.log('ğŸ”— AWS API ì‹¤ì œ ì—°ê²° ì‹œë„...');

            try {
                const response = await fetchWithTimeout(API_BASE_URL, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    }
                }, API_TIMEOUT);

                if (response.ok) {
                    const healthData = await response.json();
                    console.log('âœ… AWS API ì—°ê²° ì„±ê³µ:', healthData);
                    isAPIConnected = true;
                    apiRetryCount = 0;
                    addRealtimeLog('APIì—°ê²°', 'ğŸ”— AWS API ì‹¤ì‹œê°„ ì—°ê²° ì„±ê³µ');
                    return true;
                } else {
                    throw new Error(`API ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`);
                }
            } catch (error) {
                console.warn(`âš ï¸ AWS API ì—°ê²° ì‹¤íŒ¨ (${apiRetryCount + 1}/${MAX_RETRIES}):`, error);
                isAPIConnected = false;

                if (apiRetryCount < MAX_RETRIES) {
                    apiRetryCount++;
                    //addRealtimeLog('APIì—°ê²°', `âŒ ì—°ê²° ì‹¤íŒ¨ - ${apiRetryCount}/${MAX_RETRIES}íšŒ ì¬ì‹œë„`);
                    setTimeout(() => connectToAwsAPI(), Math.pow(2, apiRetryCount) * 1000);
                } //else {
                    //addRealtimeLog('APIì—°ê²°', 'âŒ ìµœëŒ€ ì¬ì‹œë„ ì´ˆê³¼ - AWS API ì—°ê²° ì¬ì‹œë„ ì¤‘ì§€');
                }
                return false;
            }
        

        async function fetchWithTimeout(url, options, timeout) {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), timeout);

            try {
                const response = await fetch(url, {
                    ...options,
                    signal: controller.signal
                });
                clearTimeout(timeoutId);
                return response;
            } catch (error) {
                clearTimeout(timeoutId);
                throw error;
            }
        }

        // ğŸ”— ì‹¤ì œ AWS ë°ì´í„° ë¡œë“œ í•¨ìˆ˜ (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±°)
        async function loadRealAWSData() {
            try {
                console.log('ğŸ“¡ ì‹¤ì œ AWS ë°ì´í„° ë¡œë“œ ì‹œì‘...');

                const response = await fetchWithTimeout(API_BASE_URL, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    mode: 'cors'
                }, API_TIMEOUT);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const realData = await response.json();
                //console.log('âœ… ì‹¤ì œ AWS ë°ì´í„° ë¡œë“œ ì„±ê³µ:', realData);

                if (realData && typeof realData === 'object') {
                    isAPIConnected = true;
                    apiRetryCount = 0;
                    window.dashboardData = realData; // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
                    updateDashboardUI(realData);
                    //addRealtimeLog('ë°ì´í„°ë¡œë“œ', `âœ… ì‹¤ì œ AWS ë°ì´í„° ë¡œë“œ ì„±ê³µ`);
                    return realData;
                } else {
                    throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ë°ì´í„° í˜•ì‹');
                }

            } catch (error) {
                console.error('âŒ ì‹¤ì œ AWS ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                isAPIConnected = false;
                //addRealtimeLog('ë°ì´í„°ë¡œë“œ', `âŒ AWS API ì—°ê²° ì‹¤íŒ¨: ${error.message}`);

                // ë¹ˆ ë°ì´í„°ë¡œ UI í´ë¦¬ì–´
                updateDashboardUI({
                    threat_count: 0,
                    auto_action_count: 0,
                    blocked_ip_count: 0,
                    manual_review_count: 0,
                    current_risk_score: 0,
                    statistics: { detection_rate: 100 },
                    api_connected: false
                });

                return null;
            }
        }

        // =================================================================
        // ğŸ”Š ì‚¬ìš´ë“œ ì‹œìŠ¤í…œ
        // =================================================================
        function initializeAudio() {
            try {
                alertSound = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaFUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsF');
                dangerSound = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvmAaEUCS0vLNeSsF');
                alertSound.volume = 0.7;
                dangerSound.volume = 0.9;
                console.log('ğŸ”Š ì‚¬ìš´ë“œ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');
            } catch (error) {
                console.warn('ğŸ”Š ì‚¬ìš´ë“œ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            }
        }

        function playAlertSound() {
            // ë¹„í™œì„±í™”: ì§§ì€ ì‚‘ ì†Œë¦¬ ì œê±°
        }

        function playDangerSound() {
            // Web Audio APIë¡œ 3.2ì´ˆ ì‚¬ì´ë Œ(2íšŒ ìŠ¤ìœ•), í´ë¦­/ì‚‘ ì œê±°ìš© ìŠ¤ë¬´ë”© ë° ì¤‘ë³µ ë°©ì§€
            try {
                // ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€ (1.5ì´ˆ ì´ë‚´ ì¬í˜¸ì¶œ ë¬´ì‹œ)
                window.__lastSirenAt = window.__lastSirenAt || 0;
                const nowMs = Date.now();
                if (nowMs - window.__lastSirenAt < 1500) return;
                window.__lastSirenAt = nowMs;

                const AudioCtx = window.AudioContext || window.webkitAudioContext;
                if (!AudioCtx) {
                    // Fallback: ê¸°ì¡´ ì˜¤ë””ì˜¤ ì‹œë„
                    if (typeof dangerSound !== 'undefined' && dangerSound) {
                    dangerSound.currentTime = 0;
                        dangerSound.play().catch(() => {});
                    }
                    return;
                }

                window.__audioCtx = window.__audioCtx || new AudioCtx();
                const ctx = window.__audioCtx;
                if (ctx.state === 'suspended') { ctx.resume().catch(() => {}); }

                // ì´ì „ ì‚¬ì´ë Œì´ ìˆìœ¼ë©´ ì •ë¦¬ (ì¤‘ë³µ ì¬ìƒ ë°©ì§€ë¡œ ì¤‘ê°„ ì‚‘ ì œê±°)
                if (window.__sirenNodes) {
                    try { window.__sirenNodes.osc.stop(); } catch (_) {}
                    try { window.__sirenNodes.osc.disconnect(); } catch (_) {}
                    try { window.__sirenNodes.gain.disconnect(); } catch (_) {}
                }

                const durationSec = 3.2; // ë‘ ë²ˆ ìš¸ë¦¼
                const oscillator = ctx.createOscillator();
                const gainNode = ctx.createGain();

                oscillator.type = 'sine';

                const now = ctx.currentTime;
                // ì£¼íŒŒìˆ˜ ê³¡ì„ : 600â†’1200â†’600â†’1200â†’600 (ë¶€ë“œëŸ¬ìš´ ìŠ¤ìœ•)
                const f = oscillator.frequency;
                f.cancelScheduledValues(now);
                f.setValueAtTime(600, now);
                f.linearRampToValueAtTime(1200, now + 0.8);
                f.linearRampToValueAtTime(600, now + 1.6);
                f.linearRampToValueAtTime(1200, now + 2.4);
                f.linearRampToValueAtTime(600, now + 3.2);

                // ë³¼ë¥¨ ADSR: í´ë¦­ ë°©ì§€ìš© ì•„ì£¼ ë‚®ì€ ì‹œì‘/ì¢…ë£Œê°’ + ì™„ë§Œí•œ ë¨í”„
                const g = gainNode.gain;
                g.cancelScheduledValues(now);
                g.setValueAtTime(0.0001, now);
                g.linearRampToValueAtTime(0.22, now + 0.12);
                g.setValueAtTime(0.22, now + durationSec - 0.25);
                g.linearRampToValueAtTime(0.0001, now + durationSec);

                oscillator.connect(gainNode).connect(ctx.destination);
                oscillator.start(now);
                oscillator.stop(now + durationSec);

                window.__sirenNodes = { osc: oscillator, gain: gainNode };
            } catch (error) {
                console.warn('ìœ„í—˜ìŒ ì¬ìƒ ì—ëŸ¬:', error);
            }
        }

        // =================================================================
        // ğŸ•’ ì‹œê°„ ê´€ë ¨ í•¨ìˆ˜ë“¤
        // =================================================================
        function getCurrentKST() {
            const now = new Date();
            return now.toLocaleString('ko-KR', {
                timeZone: 'Asia/Seoul',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        }

        function updateTime() {
            try {
                const now = new Date();
                const timeStr = now.getHours().toString().padStart(2, '0') + ':' + 
                               now.getMinutes().toString().padStart(2, '0') + ':' +
                               now.getSeconds().toString().padStart(2, '0');

                const timeElements = ['#lastSync', '#currentTime', '#currentTime1', '#currentTime2'];
                timeElements.forEach(selector => {
                    const element = document.querySelector(selector);
                    if (element) {
                        element.textContent = timeStr;
                    }
                });

                const walker = document.createTreeWalker(
                    document.body,
                    NodeFilter.SHOW_TEXT,
                    {
                        acceptNode: function(node) {
                            if (node.textContent && node.textContent.includes('--:--')) {
                                return NodeFilter.FILTER_ACCEPT;
                            }
                            return NodeFilter.FILTER_REJECT;
                        }
                    }
                );

                let node;
                while (node = walker.nextNode()) {
                    if (node.textContent) {
                        node.textContent = node.textContent.replace(/--:--/g, timeStr);
                    }
                }
            } catch (error) {
                console.warn('ì‹œê°„ ì—…ë°ì´íŠ¸ ì—ëŸ¬:', error);
            }
        }

        function startTimeUpdates() {
            console.log('â° ì‹œê°„ ì—…ë°ì´íŠ¸ ì‹œì‘');
            updateTime();
            timeInterval = setInterval(updateTime, 1000);
        }

        // =================================================================
        // ğŸ¬ ë¹„ë””ì˜¤ ë°°ë„ˆ ì‹œìŠ¤í…œ
        // =================================================================
        function showVideoBanner(threatData) {
            console.log('ğŸ¬ ë¹„ë””ì˜¤ ë°°ë„ˆ í‘œì‹œ:', threatData);

            try {
                const banner = document.getElementById('videoBanner');
                const video = document.getElementById('bannerVideo');
                const container = document.getElementById('mainContainer');

                if (!banner || !video || !container) {
                    console.warn('ë¹„ë””ì˜¤ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                    return;
                }

                const blockedIPElement = document.getElementById('blockedIP');
                const threatTypeElement = document.getElementById('threatType');
                const blockTimeElement = document.getElementById('blockTime');

                if (blockedIPElement) blockedIPElement.textContent = threatData.source_ip || 'ì•Œ ìˆ˜ ì—†ìŒ';
                if (threatTypeElement) threatTypeElement.textContent = threatData.threat_type || 'ì•Œ ìˆ˜ ì—†ìŒ';
                if (blockTimeElement) blockTimeElement.textContent = getCurrentKST();

                banner.classList.add('show');
                container.classList.add('with-banner');

                // ë¹„ë””ì˜¤ ì†Œë¦¬ëŠ” ì™„ì „íˆ ì œê±° + ì‚¬ì´ë Œì€ ì•½ê°„ ì§€ì—° í›„ 1íšŒ ì¬ìƒ
                video.muted = true;
                video.currentTime = 0;
                video.play().catch(e => console.warn('ë¹„ë””ì˜¤ ì¬ìƒ ì‹¤íŒ¨:', e));
                setTimeout(() => playDangerSound(), 150);

                setTimeout(() => {
                    if (banner.classList.contains('show')) {
                        closeBanner();
                    }
                }, 10000);

            } catch (error) {
                console.error('ë¹„ë””ì˜¤ ë°°ë„ˆ í‘œì‹œ ì—ëŸ¬:', error);
            }
        }

        function closeBanner() {
            try {
                const banner = document.getElementById('videoBanner');
                const video = document.getElementById('bannerVideo');
                const container = document.getElementById('mainContainer');

                if (banner) banner.classList.remove('show');
                if (container) container.classList.remove('with-banner');
                if (video) {
                    video.pause();
                    video.currentTime = 0;
                }
            } catch (error) {
                console.error('ë¹„ë””ì˜¤ ë°°ë„ˆ ë‹«ê¸° ì—ëŸ¬:', error);
            }
        }

        // =================================================================
        // ğŸš¨ ìœ„í—˜ ê°ì§€ ì˜¤ë²„ë ˆì´
        // =================================================================
        function showDangerOverlay() {
            try {
                const overlay = document.getElementById('dangerOverlay');
                if (overlay) {
                    overlay.classList.add('show');
                    // ì˜ìƒ í‘œì‹œì™€ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ì•½ê°„ ì§€ì—° í›„ 1íšŒë§Œ ì¬ìƒ
                    setTimeout(() => playDangerSound(), 150);
                    setTimeout(() => {
                        overlay.classList.remove('show');
                    }, 3000);
                }
            } catch (error) {
                console.error('ìœ„í—˜ ì˜¤ë²„ë ˆì´ í‘œì‹œ ì—ëŸ¬:', error);
            }
        }

        
        // =================================================================
        // ğŸ¤ ìŒì„± ì¸ì‹ ì‹œìŠ¤í…œ
        // =================================================================
        function initializeVoiceRecognition() {
            try {
                if ('webkitSpeechRecognition' in window) {
                    recognition = new webkitSpeechRecognition();
                } else if ('SpeechRecognition' in window) {
                    recognition = new SpeechRecognition();
                } else {
                    console.warn('ìŒì„± ì¸ì‹ ì§€ì› ì•ˆë¨');
                    return;
                }

                recognition.lang = 'ko-KR';
                recognition.continuous = false;
                recognition.interimResults = false;

                recognition.onresult = function(event) {
                    const command = event.results[0][0].transcript.trim();
                    console.log('ğŸ¤ ìŒì„± ëª…ë ¹:', command);
                    processVoiceCommand(command);
                };

                recognition.onerror = function(event) {
                    console.warn('ìŒì„± ì¸ì‹ ì—ëŸ¬:', event.error);
                    stopListening();
                };

                recognition.onend = function() {
                    stopListening();
                };

                console.log('ğŸ¤ ìŒì„± ì¸ì‹ ì´ˆê¸°í™” ì™„ë£Œ');
            } catch (error) {
                console.warn('ìŒì„± ì¸ì‹ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            }
        }

        function toggleVoiceUI() {
            const voiceUI = document.getElementById('voiceUI');
            if (voiceUI) {
                if (voiceUI.classList.contains('show')) {
                    closeVoiceUI();
                } else {
                    showVoiceUI();
                }
            }
        }

        function showVoiceUI() {
            const voiceUI = document.getElementById('voiceUI');
            if (voiceUI) {
                voiceUI.classList.add('show');
                startListening();
            }
        }

        function closeVoiceUI() {
            const voiceUI = document.getElementById('voiceUI');
            if (voiceUI) {
                voiceUI.classList.remove('show');
                stopListening();
            }
        }

        function startListening() {
            if (recognition && !isListening) {
                try {
                    recognition.start();
                    isListening = true;
                    const status = document.getElementById('voiceStatus');
                    if (status) status.textContent = 'ìŒì„±ì„ ë“£ê³  ìˆìŠµë‹ˆë‹¤...';
                } catch (error) {
                    console.warn('ìŒì„± ì¸ì‹ ì‹œì‘ ì‹¤íŒ¨:', error);
                }
            }
        }

        function stopListening() {
            if (recognition && isListening) {
                recognition.stop();
                isListening = false;
                const status = document.getElementById('voiceStatus');
                if (status) status.textContent = 'ìŒì„± ëª…ë ¹ì„ ë§ì”€í•˜ì„¸ìš”...';
            }
        }

        function processVoiceCommand(command) {
            const status = document.getElementById('voiceStatus');
            if (status) status.textContent = 'ëª…ë ¹ì„ ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...';

            if (command.includes('í…ŒìŠ¤íŠ¸') || command.includes('ì¢…í•©') || command.includes('í›ˆë ¨')) {
                simulateAutoBlockInstant();
                if (status) status.textContent = 'í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤!';
            } else if (command.includes('ë³´ì•ˆê°ì‚¬ì²­') || command.includes('ë³´ì•ˆ') || command.includes('ìŠ¤ìº”')) {
                performSecurityScan();
                if (status) status.textContent = 'ë³´ì•ˆê°ì‚¬ì²­ ë³´ì•ˆìŠ¤ìº”ì„ ì‹œì‘í•©ë‹ˆë‹¤!';
            } else if (command.includes('í™˜ê²½ì²­') || command.includes('ì‹œìŠ¤í…œ') || command.includes('ì ê²€')) {
                performSystemCheck();
                if (status) status.textContent = 'í™˜ê²½ì²­ ì‹œìŠ¤í…œ ì ê²€ì„ ì‹œì‘í•©ë‹ˆë‹¤!';
            } else if (command.includes('ë³´ê³ ì„œ')) {
                reportGeneration();
                if (status) status.textContent = 'ë³´ê³ ì„œë¥¼ ìƒì„±í•©ë‹ˆë‹¤!';
            } else if (command.includes('ë¡œë“œ') || command.includes('ë©”ì¼')) {
                showLoadMail();
                if (status) status.textContent = 'LOAD & MAILì„ ì‹¤í–‰í•©ë‹ˆë‹¤!';
            } else if (command.includes('ìˆ˜ë™') || command.includes('ì „íˆ¬')) {
                showManualControlModal();
                if (status) status.textContent = 'ìˆ˜ë™ ì „íˆ¬ ëª¨ë“œë¥¼ í™œì„±í™”í•©ë‹ˆë‹¤!';
            } else if (command.includes('ìƒˆë¡œê³ ì¹¨')) {
                refreshData();
                if (status) status.textContent = 'ë°ì´í„°ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤!';
            } else if (command.includes('ë„ì›€ë§')) {
                showHelp();
                if (status) status.textContent = 'ë„ì›€ë§ì„ í‘œì‹œí•©ë‹ˆë‹¤!';
            } else {
                if (status) status.textContent = 'ì•Œ ìˆ˜ ì—†ëŠ” ëª…ë ¹ì…ë‹ˆë‹¤.';
            }

            setTimeout(() => {
                if (status) status.textContent = 'ìŒì„± ëª…ë ¹ì„ ë§ì”€í•˜ì„¸ìš”...';
            }, 2000);
        }

        // =================================================================
        // ğŸ“ ì‹¤ì‹œê°„ ë¡œê·¸ ì‹œìŠ¤í…œ
        // =================================================================
        function addRealtimeLog(category, message) {
            try {
                const logContainer = document.getElementById('logEntries');
                if (!logContainer) return;

                const currentTime = new Date().getHours().toString().padStart(2, '0') + ':' + 
                                  new Date().getMinutes().toString().padStart(2, '0') + ':' +
                                  new Date().getSeconds().toString().padStart(2, '0');

                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';

                const detailInfo = generateLogDetails(category, message);
                const severityInfo = getSeverityInfo(category);

                logEntry.innerHTML = `
                    <div class="log-time">${currentTime}</div>
                    <div class="log-icon">${getCategoryIcon(category)}</div>
                    <div class="log-text">
                        ${message}
                        <div class="log-details">
                            ${detailInfo}
                        </div>
                    </div>
                    <div class="log-severity ${severityInfo.class}">${severityInfo.level}</div>
                `;

                logContainer.insertBefore(logEntry, logContainer.firstChild);

                while (logContainer.children.length > 50) {
                    logContainer.removeChild(logContainer.lastChild);
                }
            } catch (error) {
                console.warn('ë¡œê·¸ ì¶”ê°€ ì—ëŸ¬:', error);
            }
        }

        function generateLogDetails(category, message) {
            const responseTime = Math.floor(Math.random() * 100) + 20;
            const randomId = Math.floor(Math.random() * 10000);

            const templates = {
                //'APIì—°ê²°': `â€¢ ì—”ë“œí¬ì¸íŠ¸: ${API_BASE_URL}<br>â€¢ ì‘ë‹µì‹œê°„: ${responseTime}ms | ìƒíƒœ: 200 OK`,
                'ë°ì´í„°ë¡œë“œ': `â€¢ ì²˜ë¦¬ì‹œê°„: ${responseTime}ms | ì••ì¶•ë¥ : ${Math.floor(Math.random() * 20) + 70}%`,
                'í…ŒìŠ¤íŠ¸': `â€¢ í…ŒìŠ¤íŠ¸ ID: TEST-${randomId} | ê²°ê³¼: SUCCESS<br>â€¢ ì‹¤í–‰ì‹œê°„: ${responseTime}ms`,
                'ì°¨ë‹¨': `â€¢ ì°¨ë‹¨ë°©ì‹: WAF_RULE | ì²˜ë¦¬ì‹œê°„: ${responseTime}ms<br>â€¢ ê·œì¹™ID: BLOCK-${randomId}`,
                'ì‹œìŠ¤í…œ': `â€¢ í”„ë¡œì„¸ìŠ¤ID: ${randomId} | ë©”ëª¨ë¦¬: ${Math.floor(Math.random() * 200) + 100}MB`
            };

            return templates[category] || `â€¢ ì²˜ë¦¬ì‹œê°„: ${responseTime}ms | ìƒíƒœ: ì •ìƒ`;
        }

        function getSeverityInfo(category) {
            const severityMap = {
                'ìœ„í˜‘ê°ì§€': { level: 'HIGH', class: 'high' },
                'ì°¨ë‹¨': { level: 'HIGH', class: 'high' },
                //'APIì—°ê²°': { level: 'INFO', class: 'info' },
                'í…ŒìŠ¤íŠ¸': { level: 'INFO', class: 'info' },
                'ì‹œìŠ¤í…œ': { level: 'INFO', class: 'info' }
            };
            return severityMap[category] || { level: 'INFO', class: 'info' };
        }

        function getCategoryIcon(category) {
            const icons = {
                'ì‹œìŠ¤í…œ': 'ğŸ®',
                'í…ŒìŠ¤íŠ¸': 'âš¡',
                'ì°¨ë‹¨': 'ğŸš«',
                //'APIì—°ê²°': 'ğŸ”—',
                'ë°ì´í„°ë¡œë“œ': 'ğŸ“¡'
            };
            return icons[category] || 'ğŸ“Œ';
        }

        // =================================================================
        // ğŸ” ë³´ì•ˆìŠ¤ìº” - ì „ì²´ ì‹œìŠ¤í…œ ë³´ì•ˆ ì ê²€
        // =================================================================
        function performSecurityScan() {
            console.log('ğŸ” ë³´ì•ˆìŠ¤ìº” ì‹œì‘');
            
            try {
                // ë³´ì•ˆìŠ¤ìº” ëª¨ë‹¬ ì—´ê¸°
                const modal = document.getElementById('securityScanModal');
                const resultsContainer = document.getElementById('securityScanResults');
                
                if (!modal || !resultsContainer) {
                    console.error('ë³´ì•ˆìŠ¤ìº” ëª¨ë‹¬ ìš”ì†Œ ì—†ìŒ');
                    return;
                }
                
                modal.style.display = 'flex';
                modal.classList.add('show');
                resultsContainer.innerHTML = '<div style="text-align: center; padding: 40px; color: #00ccff;">ğŸ” ë³´ì•ˆìŠ¤ìº” ì§„í–‰ ì¤‘...</div>';
                
                // ê° ì„œë¹„ìŠ¤ë³„ ë³´ì•ˆ ìƒíƒœ ì²´í¬
                const securityChecks = [
                    { service: 'Lambda', status: 'âœ… ì •ìƒ', details: 'í•¨ìˆ˜ ì‹¤í–‰ ê¶Œí•œ ê²€ì¦ ì™„ë£Œ', color: '#00ff41' },
                    { service: 'DynamoDB', status: 'âœ… ì •ìƒ', details: 'ë°ì´í„° ì•”í˜¸í™” ìƒíƒœ ì–‘í˜¸', color: '#00ff41' },
                    { service: 'API Gateway', status: 'âš ï¸ ì£¼ì˜', details: 'API í˜¸ì¶œ ì œí•œ ì„¤ì • í•„ìš”', color: '#ffaa00' },
                    { service: 'CloudFront', status: 'âœ… ì •ìƒ', details: 'CDN ë³´ì•ˆ í—¤ë” ì ìš©ë¨', color: '#00ff41' },
                    { service: 'WAF', status: 'âœ… ì •ìƒ', details: 'ì›¹ ë°©í™”ë²½ ê·œì¹™ í™œì„±í™”', color: '#00ff41' },
                    { service: 'GuardDuty', status: 'âœ… ì •ìƒ', details: 'ìœ„í˜‘ íƒì§€ ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™', color: '#00ff41' }
                ];
                
                let resultsHTML = '<div style="background: rgba(0, 0, 0, 0.8); border-radius: 15px; padding: 20px; margin-bottom: 20px;">';
                resultsHTML += '<h3 style="color: #00ccff; margin-bottom: 20px; text-align: center;">ğŸ” ë³´ì•ˆìŠ¤ìº” ê²°ê³¼</h3>';
                
                let checkIndex = 0;
                const checkInterval = setInterval(() => {
                    if (checkIndex < securityChecks.length) {
                        const check = securityChecks[checkIndex];
                        resultsHTML += `
                            <div style="background: rgba(0, 0, 0, 0.6); border: 2px solid ${check.color}; border-radius: 10px; padding: 15px; margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div style="font-weight: bold; color: ${check.color}; font-size: 16px;">${check.service}</div>
                                    <div style="color: ${check.color}; font-size: 14px;">${check.status}</div>
                                </div>
                                <div style="color: #ffffff; margin-top: 8px; font-size: 14px;">${check.details}</div>
                            </div>
                        `;
                        resultsContainer.innerHTML = resultsHTML + '</div>';
                        checkIndex++;
                    } else {
                        clearInterval(checkInterval);
                        
                        // ìµœì¢… ê²°ê³¼
                        const normalCount = securityChecks.filter(c => c.status.includes('ì •ìƒ')).length;
                        const warningCount = securityChecks.filter(c => c.status.includes('ì£¼ì˜')).length;
                        
                        resultsHTML += `
                            <div style="background: rgba(0, 255, 65, 0.1); border: 2px solid #00ff41; border-radius: 10px; padding: 20px; margin-top: 20px; text-align: center;">
                                <h4 style="color: #00ff41; margin-bottom: 10px;">ğŸ¯ ë³´ì•ˆìŠ¤ìº” ì™„ë£Œ</h4>
                                <div style="color: #ffffff; font-size: 16px;">
                                    ì •ìƒ: ${normalCount}ê°œ | ì£¼ì˜: ${warningCount}ê°œ
                                </div>
                                <div style="color: #00ccff; font-size: 14px; margin-top: 5px;">
                                    ì „ì²´ ì‹œìŠ¤í…œ ë³´ì•ˆ ìƒíƒœ ì–‘í˜¸
                                </div>
                            </div>
                        `;
                        
                        resultsContainer.innerHTML = resultsHTML + '</div>';
                        
                        // Slack ì•Œë¦¼
                        postRealtimeAlert({
                            threat_type: 'security_scan',
                            source_ip: 'system',
                            severity: 'INFO',
                            test: 'security_scan',
                            details: `ë³´ì•ˆìŠ¤ìº” ì™„ë£Œ - ì •ìƒ: ${normalCount}ê°œ, ì£¼ì˜: ${warningCount}ê°œ`
                        });
                    }
                }, 1000);
                
            } catch (error) {
                console.error('ë³´ì•ˆìŠ¤ìº” ì—ëŸ¬:', error);
                const resultsContainer = document.getElementById('securityScanResults');
                if (resultsContainer) {
                    resultsContainer.innerHTML = '<div style="text-align: center; padding: 40px; color: #ff0040;">âŒ ë³´ì•ˆìŠ¤ìº” ì¤‘ ì˜¤ë¥˜ ë°œìƒ</div>';
                }
            }
        }

        // =================================================================
        // ğŸ”§ ì‹œìŠ¤í…œ ì ê²€ - ì „ì²´ ì—°ê²° ìƒíƒœ ìƒì„¸ í™•ì¸
        // =================================================================
        function performSystemCheck() {
            console.log('ğŸ”§ ì‹œìŠ¤í…œ ì ê²€ ì‹œì‘');
            
            try {
                // ì‹œìŠ¤í…œì ê²€ ëª¨ë‹¬ ì—´ê¸°
                const modal = document.getElementById('systemCheckModal');
                const resultsContainer = document.getElementById('systemCheckResults');
                
                if (!modal || !resultsContainer) {
                    console.error('ì‹œìŠ¤í…œì ê²€ ëª¨ë‹¬ ìš”ì†Œ ì—†ìŒ');
                    return;
                }
                
                modal.style.display = 'flex';
                modal.classList.add('show');
                resultsContainer.innerHTML = '<div style="text-align: center; padding: 40px; color: #00ccff;">ğŸ”§ ì‹œìŠ¤í…œì ê²€ ì§„í–‰ ì¤‘...</div>';
                
                // API ì—°ê²° ìƒíƒœ ì²´í¬
                fetch(API_BASE_URL, {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                })
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    } else {
                        throw new Error(`API ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`);
                    }
                })
                .then(data => {
                    // ê° ì„œë¹„ìŠ¤ë³„ ìƒì„¸ ìƒíƒœ í™•ì¸ (ì‹¤ì œ API ì‘ë‹µ ë°ì´í„° ì‚¬ìš©)
                    const services = [
                        { name: 'Lambda', count: data.threat_count || 0, status: (data.threat_count || 0) > 0 ? 'âœ… ì •ìƒ' : 'âš ï¸ ë¹„í™œì„±', color: (data.threat_count || 0) > 0 ? '#00ff41' : '#ffaa00' },
                        { name: 'DynamoDB', count: data.blocked_ip_count || 0, status: (data.blocked_ip_count || 0) > 0 ? 'âœ… ì •ìƒ' : 'âš ï¸ ë¹„í™œì„±', color: (data.blocked_ip_count || 0) > 0 ? '#00ff41' : '#ffaa00' },
                        { name: 'API Gateway', count: data.auto_action_count || 0, status: (data.auto_action_count || 0) > 0 ? 'âœ… ì •ìƒ' : 'âš ï¸ ë¹„í™œì„±', color: (data.auto_action_count || 0) > 0 ? '#00ff41' : '#ffaa00' },
                        { name: 'CloudFront', count: Math.max(50, (data.threat_count || 0) * 8), status: 'âœ… ì •ìƒ', color: '#00ff41' },
                        { name: 'WAF', count: data.current_risk_score || 0, status: (data.current_risk_score || 0) > 0 ? 'âœ… ì •ìƒ' : 'âš ï¸ ë¹„í™œì„±', color: (data.current_risk_score || 0) > 0 ? '#00ff41' : '#ffaa00' },
                        { name: 'GuardDuty', count: data.statistics?.total_threats || 0, status: (data.statistics?.total_threats || 0) > 0 ? 'âœ… ì •ìƒ' : 'âš ï¸ ë¹„í™œì„±', color: (data.statistics?.total_threats || 0) > 0 ? '#00ff41' : '#ffaa00' }
                    ];
                    
                    let resultsHTML = '<div style="background: rgba(0, 0, 0, 0.8); border-radius: 15px; padding: 20px; margin-bottom: 20px;">';
                    resultsHTML += '<h3 style="color: #00ccff; margin-bottom: 20px; text-align: center;">ğŸ”§ ì‹œìŠ¤í…œì ê²€ ê²°ê³¼</h3>';
                    resultsHTML += '<div style="background: rgba(0, 255, 65, 0.1); border: 2px solid #00ff41; border-radius: 10px; padding: 15px; margin-bottom: 20px; text-align: center;">';
                    resultsHTML += '<div style="color: #00ff41; font-weight: bold; font-size: 16px;">âœ… API Gateway ì—°ê²° ì •ìƒ</div>';
                    resultsHTML += '</div>';
                    
                    services.forEach((service, index) => {
                        resultsHTML += `
                            <div style="background: rgba(0, 0, 0, 0.6); border: 2px solid ${service.color}; border-radius: 10px; padding: 15px; margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div style="font-weight: bold; color: ${service.color}; font-size: 16px;">${service.name}</div>
                                    <div style="color: ${service.color}; font-size: 14px;">${service.status}</div>
                                </div>
                                <div style="color: #ffffff; margin-top: 8px; font-size: 14px;">
                                    í™œì„± ë°ì´í„°: ${service.count}ê°œ
                                </div>
                            </div>
                        `;
                    });
                    
                    const activeServices = services.filter(s => s.count > 0).length;
                    resultsHTML += `
                        <div style="background: rgba(0, 255, 65, 0.1); border: 2px solid #00ff41; border-radius: 10px; padding: 20px; margin-top: 20px; text-align: center;">
                            <h4 style="color: #00ff41; margin-bottom: 10px;">ğŸ¯ ì‹œìŠ¤í…œì ê²€ ì™„ë£Œ</h4>
                            <div style="color: #ffffff; font-size: 16px;">
                                í™œì„± ë°ì´í„°: ${activeServices}/${services.length}ê°œ
                            </div>
                            <div style="color: #00ccff; font-size: 14px; margin-top: 5px;">
                                ì „ì²´ ì‹œìŠ¤í…œ ì—°ê²° ìƒíƒœ ì–‘í˜¸
                            </div>
                        </div>
                    `;
                    
                    resultsContainer.innerHTML = resultsHTML + '</div>';
                    
                    // Slack ì•Œë¦¼
                    postRealtimeAlert({
                        threat_type: 'system_check',
                        source_ip: 'system',
                        severity: 'INFO',
                        test: 'system_check',
                        details: `ì‹œìŠ¤í…œì ê²€ ì™„ë£Œ - ${activeServices}/${services.length} ë°ì´í„° í™œì„±`
                    });
                })
                .catch(error => {
                    console.error('ì‹œìŠ¤í…œ ì ê²€ ì—ëŸ¬:', error);
                    resultsContainer.innerHTML = '<div style="text-align: center; padding: 40px; color: #ff0040;">âŒ API ì—°ê²° ì‹¤íŒ¨ - ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸ í•„ìš”</div>';
                });
                
            } catch (error) {
                console.error('ì‹œìŠ¤í…œ ì ê²€ ì—ëŸ¬:', error);
                const resultsContainer = document.getElementById('systemCheckResults');
                if (resultsContainer) {
                    resultsContainer.innerHTML = '<div style="text-align: center; padding: 40px; color: #ff0040;">âŒ ì‹œìŠ¤í…œì ê²€ ì¤‘ ì˜¤ë¥˜ ë°œìƒ</div>';
                }
            }
        }

        // =================================================================
        // âš¡ ì¢…í•© í›ˆë ¨ì†Œ - ì¦‰ì‹œ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        // =================================================================
        function simulateAutoBlockInstant() {
            console.log('âš¡ ì¢…í•© í›ˆë ¨ì†Œ - ì¦‰ì‹œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰!');

            try {
                showDangerOverlay();

                const testThreatData = {
                    source_ip: generateRandomIP(),
                    threat_type: getRandomThreatType(),
                    severity: 'HIGH',
                    timestamp: getCurrentKST(),
                    risk_score: Math.floor(Math.random() * 30) + 70
                };

                setTimeout(() => {
                    showVideoBanner(testThreatData);
                }, 2000);

                addRealtimeLog('í…ŒìŠ¤íŠ¸', `âš¡ ì¢…í•© í›ˆë ¨ì†Œ í…ŒìŠ¤íŠ¸: ${testThreatData.source_ip} ì°¨ë‹¨`);
                addRealtimeLog('ì°¨ë‹¨', `ìœ„í˜‘ ìœ í˜•: ${testThreatData.threat_type} | ìœ„í—˜ë„: ${testThreatData.risk_score}`);

                setTimeout(() => {
                    const currentCount = parseInt(document.getElementById('defeatCount')?.textContent || '0');
                    updateElementById('defeatCount', (currentCount + 1).toString());

                    const currentBlocked = parseInt(document.getElementById('blockedThreats')?.textContent || '0');
                    updateElementById('blockedThreats', (currentBlocked + 1).toString());

                    addRealtimeLog('ì‹œìŠ¤í…œ', 'âœ… ì¢…í•© í›ˆë ¨ì†Œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ');
                }, 3000);

                // ì§§ì€ ì•Œë¦¼ìŒ ì œê±° (ì‚¬ì´ë Œë§Œ ì‚¬ìš©)

                // ìƒì„¸ Slackì€ ë°±ì—”ë“œ í†µí•´ í•œ ë²ˆë§Œ ë°œì†¡ (ì¤‘ë³µ ë°©ì§€)
                postRealtimeAlert({
                    threat_type: testThreatData.threat_type,
                    source_ip: testThreatData.source_ip,
                    severity: 'HIGH',
                    test: 'frontend_test',
                    details: `Risk ${testThreatData.risk_score} at ${getCurrentKST()}`
                });

            } catch (error) {
                console.error('í…ŒìŠ¤íŠ¸ ì—ëŸ¬:', error);
                alert('âŒ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function generateRandomIP() {
            const ranges = ['203.0.113.', '198.51.100.', '192.0.2.'];
            const baseIP = ranges[Math.floor(Math.random() * ranges.length)];
            return baseIP + Math.floor(Math.random() * 255);
        }

        function getRandomThreatType() {
            const threats = ['SQL_INJECTION', 'XSS_ATTACK', 'DDOS_ATTEMPT', 'BRUTE_FORCE'];
            return threats[Math.floor(Math.random() * threats.length)];
        }

        // =================================================================
        // ğŸ“Š CSV ë³´ê³ ì„œ ìƒì„±
        // =================================================================
        async function reportGeneration() {
            console.log('ğŸ“Š CSV ë³´ê³ ì„œ ìƒì„± ì‹œì‘');

            // 1) ë°±ì—”ë“œ ìƒì„¸ ë³´ê³ ì„œ ì‹œë„
            try {
                const url = `${API_BASE_URL}?action=download_report`;
                const res = await fetchWithTimeout(url, { method: 'GET', headers: { 'Accept': 'application/json' } }, API_TIMEOUT);
                if (res.ok) {
                    const data = await res.json();
                    if (data && data.download_url) {
                        const a = document.createElement('a');
                        a.href = data.download_url;
                        a.download = data.filename || 'threat_report.csv';
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        addRealtimeLog('ë³´ê³ ì„œ', `ğŸ“Š ìƒì„¸ ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ (${data.filename || 'CSV'})`);
                        alert('âœ… ìƒì„¸ ë³´ê³ ì„œê°€ ìƒì„±ë˜ì–´ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤!');
                        return;
                    }
                }
            } catch (e) {
                console.warn('ë°±ì—”ë“œ ìƒì„¸ ë³´ê³ ì„œ ìƒì„± ì‹¤íŒ¨, ë¡œì»¬ ë³´ê³ ì„œë¡œ ëŒ€ì²´:', e);
            }

            // 2) ì‹¤íŒ¨ ì‹œ ë¡œì»¬ ê°„ì´ ë³´ê³ ì„œë¡œ ëŒ€ì²´
            try {
                const currentTime = getCurrentKST();
                const csvData = generateCSVReport();
                downloadCSV(csvData, `cyber_sentinel_report_${currentTime.replace(/[:\s]/g, '_')}.csv`);
                addRealtimeLog('ë³´ê³ ì„œ', 'ğŸ“Š ê°„ì´ CSV ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ');
                alert('âš ï¸ ìƒì„¸ ë³´ê³ ì„œ ìƒì„±ì— ì‹¤íŒ¨í•˜ì—¬ ê°„ì´ ë³´ê³ ì„œë¥¼ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.');
            } catch (error) {
                console.error('ë³´ê³ ì„œ ìƒì„± ì—ëŸ¬:', error);
                alert('âŒ ë³´ê³ ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function generateCSVReport() {
            const header = ['ì‹œê°„', 'ì¹´í…Œê³ ë¦¬', 'í™œë™', 'ìƒíƒœ', 'ìœ„í—˜ë„', 'ë¹„ê³ '];
            const now = getCurrentKST();
            const rows = [
                header,
                [now, 'ì‹œìŠ¤í…œ', 'Cyber Sentinel ì‹œì‘', 'ì •ìƒ', '0', 'ì‹¤ì‹œê°„ ì—°ê²° í™œì„±í™”'],
                [now, 'ë³´ì•ˆ', 'ì‹¤ì‹œê°„ í´ë§', 'í™œì„±', '0', '5ì´ˆ ê°„ê²© ë™ê¸°í™”'],
                [now, 'í†µê³„', 'ì´ ìœ„í˜‘ ìˆ˜', document.getElementById('totalThreats')?.textContent || '0', '0', 'í˜„ì¬ íƒì§€'],
                [now, 'ë³´ê³ ì„œ', 'CSV ìƒì„±', 'ì™„ë£Œ', '0', 'ê´€ë¦¬ì ìš”ì²­']
            ];
            return rows.map(row => row.join(',')).join('\n');
        }

        function downloadCSV(csvContent, filename) {
            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        // =================================================================
        // ğŸ“Š ì°¨íŠ¸ ì‹œìŠ¤í…œ - ğŸ”¥ 2-2-1 ë ˆì´ì•„ì›ƒ (í†µí•© ì‹œìŠ¤í…œ ìƒíƒœ ì œê±°)
        // =================================================================
        // ì¢…í•©ê´€ë¦¬ì†Œ ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ë³´ê´€ì†Œ (ì¤‘ë³µ ìƒì„± ë° ëˆ„ì  ë°©ì§€)
        window.comprehensiveCharts = window.comprehensiveCharts || [];
        function showHorizontalChart(serviceName) {
            console.log('ğŸ“Š ì°¨íŠ¸ í‘œì‹œ:', serviceName);

            const modal = document.getElementById('horizontalChartModal');
            const title = document.getElementById('horizontalChartTitle');
            const container = document.getElementById('manual-review-container');

            if (!container || !modal || !title) {
                console.error('ì°¨íŠ¸ ëª¨ë‹¬ ìš”ì†Œ ì—†ìŒ');
                return;
            }

            title.textContent = serviceName + ' ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ì°¨íŠ¸';

            if (window.horizontalChart) {
                window.horizontalChart.destroy();
                window.horizontalChart = null;
            }

            container.innerHTML = '<div class="single-chart-container"><canvas id="horizontalCanvas"></canvas></div>';
            const ctx = document.getElementById('horizontalCanvas').getContext('2d');

            let chartData = getChartData(serviceName);

            window.horizontalChart = new Chart(ctx, {
                type: 'bar',
                data: chartData,
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: serviceName + ' ë©”íŠ¸ë¦­',
                            font: { size: 24, family: 'Orbitron', weight: 'bold' },
                            color: '#00ff41'
                        },
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 255, 65, 0.3)' },
                            ticks: { color: '#00ff41', font: { family: 'Orbitron' } }
                        },
                        y: {
                            grid: { color: 'rgba(0, 255, 65, 0.2)' },
                            ticks: { color: '#00ff41', font: { family: 'Orbitron' } }
                        }
                    },
                    animation: { duration: 1500 }
                }
            });

            modal.style.display = 'flex';
            modal.classList.add('show');
            addRealtimeLog('ì°¨íŠ¸', serviceName + ' ì°¨íŠ¸ í‘œì‹œ');
        }

        function getChartData(serviceName) {
            const colorPalette = [
                'rgba(255, 99, 132, 0.8)',
                'rgba(54, 162, 235, 0.8)', 
                'rgba(255, 205, 86, 0.8)',
                'rgba(75, 192, 192, 0.8)',
                'rgba(153, 102, 255, 0.8)',
                'rgba(255, 159, 64, 0.8)',
                'rgba(0, 200, 83, 0.8)',
                'rgba(121, 85, 72, 0.8)',
                'rgba(63, 81, 181, 0.8)',
                'rgba(233, 30, 99, 0.8)'
            ];

            const borderColors = colorPalette.map(color => color.replace('0.8', '1'));

            const cleanServiceName = serviceName.toLowerCase().replace(/\s+/g, '');

            switch(cleanServiceName) {
                case 'lambda':
                    // Lambda ì‹¤í–‰ë¥ ì„ ì•ˆì •ì ìœ¼ë¡œ ê³„ì‚°
                    const lambdaApiCalls = Math.max(1, ((window.dashboardData || {}).threat_count || 0) + ((window.dashboardData || {}).blocked_ip_count || 0) + 5);
                    const lambdaBaseExecutions = 15;
                    const lambdaThreatBased = ((window.dashboardData || {}).recent_threats || []).length * 2;
                    const lambdaTotalExecutions = Math.max(lambdaBaseExecutions, lambdaThreatBased + lambdaApiCalls);
                    
                    return {
                        labels: ['ì‹¤í–‰ íšŸìˆ˜/ë¶„', 'Duration (ms)', 'ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  (%)', 'ì˜¤ë¥˜ìœ¨ (%)', 'ë™ì‹œ ì‹¤í–‰ ìˆ˜', 'ìŠ¤ë¡œí‹€ë§ ìˆ˜', 'ì½œë“œìŠ¤íƒ€íŠ¸ ìˆ˜', 'ì´ˆë‹¹ ì²˜ë¦¬ëŸ‰', 'ì—ëŸ¬ ìˆ˜', 'íƒ€ì„ì•„ì›ƒ ìˆ˜'],
                        datasets: [{
                            data: [
                                lambdaTotalExecutions, // ì‹¤í–‰ íšŸìˆ˜/ë¶„
                                Math.round(((window.dashboardData || {}).defense_failure_score || 0) * 2 + 150), // Duration
                                65, // ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ 
                                Math.round(((window.dashboardData || {}).recent_threats || []).length * 0.01), // ì˜¤ë¥˜ìœ¨
                                Math.max(1, Math.round(lambdaTotalExecutions * 0.3)), // ë™ì‹œ ì‹¤í–‰ ìˆ˜
                                Math.round(((window.dashboardData || {}).recent_threats || []).length * 0.005), // ìŠ¤ë¡œí‹€ë§ ìˆ˜
                                Math.round(((window.dashboardData || {}).recent_threats || []).length * 0.02), // ì½œë“œìŠ¤íƒ€íŠ¸ ìˆ˜
                                Math.round(lambdaTotalExecutions * 0.8), // ì´ˆë‹¹ ì²˜ë¦¬ëŸ‰
                                Math.round(((window.dashboardData || {}).recent_threats || []).length * 0.01), // ì—ëŸ¬ ìˆ˜
                                Math.round(((window.dashboardData || {}).recent_threats || []).length * 0.002) // íƒ€ì„ì•„ì›ƒ ìˆ˜
                            ],
                            backgroundColor: colorPalette.slice(0, 10),
                            borderColor: borderColors.slice(0, 10),
                            borderWidth: 3,
                            borderRadius: 8
                        }]
                    };

                case 'dynamodb':
                    const dynamoData = window.dashboardData || {};
                    const recentThreats = dynamoData.recent_threats || [];
                    const threatCount = dynamoData.threat_count || 0;
                    const blockedCount = dynamoData.blocked_ip_count || 0;
                    
                    return {
                        labels: ['ì½ê¸° ìš©ëŸ‰ ë‹¨ìœ„', 'ì“°ê¸° ìš©ëŸ‰ ë‹¨ìœ„', 'ìŠ¤ìº” ìˆ˜/ë¶„', 'ì¿¼ë¦¬ ìˆ˜/ë¶„', 'ìŠ¤ë¡œí‹€ë§ ìˆ˜', 'í…Œì´ë¸” í¬ê¸° (MB)', 'íŒŒí‹°ì…˜ ìˆ˜', 'ì§€ì—°ì‹œê°„ P95 (ms)', 'ì§€ì—°ì‹œê°„ P99 (ms)', 'í”„ë¡œë¹„ì €ë‹ ëŒ€ë¹„ ì‚¬ìš©ë¥  (%)'],
                        datasets: [{
                            data: [
                                Math.max(200, 200 + recentThreats.length * 10), // ì½ê¸° ìš©ëŸ‰ ë‹¨ìœ„
                                Math.max(150, 150 + recentThreats.length * 7), // ì“°ê¸° ìš©ëŸ‰ ë‹¨ìœ„
                                Math.max(50, recentThreats.length * 3), // ìŠ¤ìº” ìˆ˜/ë¶„
                                Math.max(200, threatCount * 2), // ì¿¼ë¦¬ ìˆ˜/ë¶„
                                Math.max(0, recentThreats.length * 0.1), // ìŠ¤ë¡œí‹€ë§ ìˆ˜
                                Math.max(1000, 1000 + blockedCount * 5), // í…Œì´ë¸” í¬ê¸°
                                Math.max(10, 10 + recentThreats.length), // íŒŒí‹°ì…˜ ìˆ˜
                                Math.max(10, 10 + recentThreats.length * 0.5), // ì§€ì—°ì‹œê°„ P95
                                Math.max(20, 20 + recentThreats.length * 1), // ì§€ì—°ì‹œê°„ P99
                                Math.max(60, 60 + recentThreats.length * 2) // í”„ë¡œë¹„ì €ë‹ ëŒ€ë¹„ ì‚¬ìš©ë¥ 
                            ],
                            backgroundColor: colorPalette.slice(0, 10),
                            borderColor: borderColors.slice(0, 10),
                            borderWidth: 3,
                            borderRadius: 8
                        }]
                    };

                case 'apigateway':
                case 'api gateway':
                    const apiData = window.dashboardData || {};
                    const apiThreats = apiData.recent_threats || [];
                    const apiThreatCount = apiData.threat_count || 0;
                    const apiBlockedCount = apiData.blocked_ip_count || 0;
                    
                    return {
                        labels: ['API í˜¸ì¶œ ìˆ˜/ë¶„', '4XX ì˜¤ë¥˜ ìˆ˜', '5XX ì˜¤ë¥˜ ìˆ˜', 'í‰ê·  ì§€ì—°ì‹œê°„ (ms)', 'ìºì‹œ ì ì¤‘ë¥  (%)', 'í†µí•© ì§€ì—°ì‹œê°„ (ms)', 'ìµœëŒ€ ì§€ì—°ì‹œê°„ (ms)', 'ì˜¤ë²„í—¤ë“œ (ms)', 'ì—ëŸ¬ìœ¨ (%)', 'ì‚¬ìš©ì¤‘ì¸ API ìˆ˜'],
                        datasets: [{
                            data: [
                                Math.max(1000, apiThreatCount * 10 + apiBlockedCount * 5), // API í˜¸ì¶œ ìˆ˜/ë¶„
                                Math.max(5, apiThreats.length * 0.5), // 4XX ì˜¤ë¥˜ ìˆ˜
                                Math.max(1, apiThreats.length * 0.1), // 5XX ì˜¤ë¥˜ ìˆ˜
                                Math.max(50, 50 + apiThreats.length * 2), // í‰ê·  ì§€ì—°ì‹œê°„
                                Math.max(70, 70 + apiThreats.length * 0.5), // ìºì‹œ ì ì¤‘ë¥ 
                                Math.max(30, 30 + apiThreats.length * 1), // í†µí•© ì§€ì—°ì‹œê°„
                                Math.max(200, 200 + apiThreats.length * 5), // ìµœëŒ€ ì§€ì—°ì‹œê°„
                                Math.max(5, apiThreats.length * 0.3), // ì˜¤ë²„í—¤ë“œ
                                Math.max(0.1, apiThreats.length * 0.05), // ì—ëŸ¬ìœ¨
                                Math.max(5, 5 + apiThreats.length * 0.2) // ì‚¬ìš©ì¤‘ì¸ API ìˆ˜
                            ],
                            backgroundColor: colorPalette.slice(0, 10),
                            borderColor: borderColors.slice(0, 10),
                            borderWidth: 3,
                            borderRadius: 8
                        }]
                    };

                case 'cloudfront':
                    const cloudfrontData = window.dashboardData || {};
                    const cloudfrontThreats = cloudfrontData.recent_threats || [];
                    const cloudfrontThreatCount = cloudfrontData.threat_count || 0;
                    
                    return {
                        labels: ['ìš”ì²­ ìˆ˜/ë¶„', 'ë°”ì´íŠ¸ ë‹¤ìš´ë¡œë“œ (MB)', 'ë°”ì´íŠ¸ ì—…ë¡œë“œ (MB)', '4XX ì˜¤ë¥˜ìœ¨ (%)', '5XX ì˜¤ë¥˜ìœ¨ (%)', 'ìºì‹œ ì ì¤‘ë¥  (%)', 'ì˜¤ë¦¬ì§„ ì§€ì—°(ms)', 'TLS ì˜¤ë¥˜ ìˆ˜', 'ì§€ë¦¬ì  ë¶„ì‚°(ì§€ì—­)', 'ì—£ì§€ ìˆ˜'],
                        datasets: [{
                            data: [
                                Math.max(50, cloudfrontThreatCount * 8), // ìš”ì²­ ìˆ˜/ë¶„
                                Math.max(500, 500 + cloudfrontThreats.length * 20), // ë°”ì´íŠ¸ ë‹¤ìš´ë¡œë“œ
                                Math.max(30, 30 + cloudfrontThreats.length * 2), // ë°”ì´íŠ¸ ì—…ë¡œë“œ
                                Math.max(0.1, cloudfrontThreats.length * 0.05), // 4XX ì˜¤ë¥˜ìœ¨
                                Math.max(0.01, cloudfrontThreats.length * 0.01), // 5XX ì˜¤ë¥˜ìœ¨
                                Math.max(85, 85 + cloudfrontThreats.length * 0.3), // ìºì‹œ ì ì¤‘ë¥ 
                                Math.max(20, 20 + cloudfrontThreats.length * 1), // ì˜¤ë¦¬ì§„ ì§€ì—°
                                Math.max(0, cloudfrontThreats.length * 0.1), // TLS ì˜¤ë¥˜ ìˆ˜
                                Math.max(8, 8 + cloudfrontThreats.length * 0.1), // ì§€ë¦¬ì  ë¶„ì‚°
                                Math.max(100, 100 + cloudfrontThreats.length * 2) // ì—£ì§€ ìˆ˜
                            ],
                            backgroundColor: colorPalette.slice(0, 10),
                            borderColor: borderColors.slice(0, 10),
                            borderWidth: 3,
                            borderRadius: 8
                        }]
                    };

                case 'waf':
                    const wafData = window.dashboardData || {};
                    const wafThreats = wafData.recent_threats || [];
                    const wafThreatCount = wafData.threat_count || 0;
                    const wafBlockedCount = wafData.blocked_ip_count || 0;
                    
                    return {
                        labels: ['í—ˆìš©ëœ ìš”ì²­/ë¶„', 'ì°¨ë‹¨ëœ ìš”ì²­/ë¶„', 'SQL ì¸ì ì…˜ ì°¨ë‹¨', 'XSS ê³µê²© ì°¨ë‹¨', 'êµ­ê°€ë³„ IP ì°¨ë‹¨', 'ì†ë„ ì œí•œ ì°¨ë‹¨', 'ë´‡ ì°¨ë‹¨', 'IP í‰íŒ ì°¨ë‹¨', 'RULE ë§¤ì¹­ ìˆ˜', 'ë¼ë²¨ ì ìš© ìˆ˜'],
                        datasets: [{
                            data: [
                                Math.max(40, wafThreatCount * 8), // í—ˆìš©ëœ ìš”ì²­/ë¶„
                                Math.max(10, wafBlockedCount * 2), // ì°¨ë‹¨ëœ ìš”ì²­/ë¶„
                                Math.max(1, wafThreats.length * 0.2), // SQL ì¸ì ì…˜ ì°¨ë‹¨
                                Math.max(2, wafThreats.length * 0.3), // XSS ê³µê²© ì°¨ë‹¨
                                Math.max(5, wafBlockedCount * 0.5), // êµ­ê°€ë³„ IP ì°¨ë‹¨
                                Math.max(3, wafThreats.length * 0.1), // ì†ë„ ì œí•œ ì°¨ë‹¨
                                Math.max(8, wafThreats.length * 0.4), // ë´‡ ì°¨ë‹¨
                                Math.max(2, wafBlockedCount * 0.3), // IP í‰íŒ ì°¨ë‹¨
                                Math.max(10, wafThreats.length * 0.5), // RULE ë§¤ì¹­ ìˆ˜
                                Math.max(5, wafThreats.length * 0.2) // ë¼ë²¨ ì ìš© ìˆ˜
                            ],
                            backgroundColor: colorPalette.slice(0, 10),
                            borderColor: borderColors.slice(0, 10),
                            borderWidth: 3,
                            borderRadius: 8
                        }]
                    };

                case 'guardduty':
                    const guarddutyData = window.dashboardData || {};
                    const guarddutyThreats = guarddutyData.recent_threats || [];
                    const guarddutyThreatCount = guarddutyData.threat_count || 0;
                    const guarddutyBlockedCount = guarddutyData.blocked_ip_count || 0;
                    
                    return {
                        labels: ['í™œì„± íƒì§€ê¸°', 'ì´ ë°œê²¬ìˆ˜', 'ê³ ìœ„í—˜ ë°œê²¬', 'ì¤‘ìœ„í—˜ ë°œê²¬', 'ì €ìœ„í—˜ ë°œê²¬', 'IP í‰íŒ íƒì§€', 'IAM ì´ìƒí–‰ìœ„', 'DNS ì´ìƒ', 'í¬íŠ¸ìŠ¤ìº”', 'ë¦¬ì „ ì´ë™'],
                        datasets: [{
                            data: [
                                1, // í™œì„± íƒì§€ê¸° (í•­ìƒ 1)
                                Math.max(1, guarddutyThreatCount), // ì´ ë°œê²¬ìˆ˜
                                Math.max(0, guarddutyThreats.length * 0.1), // ê³ ìœ„í—˜ ë°œê²¬
                                Math.max(1, guarddutyThreats.length * 0.3), // ì¤‘ìœ„í—˜ ë°œê²¬
                                Math.max(2, guarddutyThreats.length * 0.6), // ì €ìœ„í—˜ ë°œê²¬
                                Math.max(0, guarddutyBlockedCount * 0.2), // IP í‰íŒ íƒì§€
                                Math.max(0, guarddutyThreats.length * 0.1), // IAM ì´ìƒí–‰ìœ„
                                Math.max(0, guarddutyThreats.length * 0.05), // DNS ì´ìƒ
                                Math.max(1, guarddutyThreats.length * 0.2), // í¬íŠ¸ìŠ¤ìº”
                                Math.max(0, guarddutyThreats.length * 0.02) // ë¦¬ì „ ì´ë™
                            ],
                            backgroundColor: colorPalette.slice(0, 10),
                            borderColor: borderColors.slice(0, 10),
                            borderWidth: 3,
                            borderRadius: 8
                        }]
                    };

                default:
                    return {
                        labels: ['ì—°ê²° ìƒíƒœ', 'ì‘ë‹µ ì‹œê°„ (ms)', 'ì²˜ë¦¬ìœ¨ (%)', 'ê°€ìš©ì„± (%)', 'CPU (%)', 'ë©”ëª¨ë¦¬ (%)', 'ë””ìŠ¤í¬ I/O', 'ë„¤íŠ¸ì›Œí¬ I/O', 'ì˜¤ë¥˜ ìˆ˜', 'ê²½ê³  ìˆ˜'],
                        datasets: [{
                            data: [100, 200, 85, 99.9, 35, 62, 120, 95, 7, 3],
                            backgroundColor: colorPalette.slice(0, 10),
                            borderColor: borderColors.slice(0, 10),
                            borderWidth: 3,
                            borderRadius: 8
                        }]
                    };
            }
        }

        // ğŸ”¥ ì¢…í•©ê´€ë¦¬ì†Œ - 2-2-1 ë ˆì´ì•„ì›ƒ (í†µí•© ì‹œìŠ¤í…œ ìƒíƒœ ì œê±°)
        function showComprehensiveMetrics() {
            console.log('ğŸ“ˆ ì¢…í•©ê´€ë¦¬ì†Œ í‘œì‹œ');

            const modal = document.getElementById('horizontalChartModal');
            const title = document.getElementById('horizontalChartTitle');
            const container = document.getElementById('manual-review-container');

            if (!container || !modal || !title) {
                console.error('ì°¨íŠ¸ ëª¨ë‹¬ ìš”ì†Œ ì—†ìŒ');
                return;
            }

            title.textContent = 'ğŸ“Š ì¢…í•©ê´€ë¦¬ì†Œ - ì „ì²´ AWS ë©”íŠ¸ë¦­ (5ê°œ ì„œë¹„ìŠ¤)';

            // ë‹¨ì¼ ì°¨íŠ¸ê°€ ì—´ë ¤ ìˆì—ˆë‹¤ë©´ ì •ë¦¬
            if (window.horizontalChart) {
                window.horizontalChart.destroy();
                window.horizontalChart = null;
            }

            // ì´ì „ ì¢…í•© ì°¨íŠ¸ë“¤ ëª¨ë‘ ì •ë¦¬ (ì¤‘ë³µ ë Œë”ë§ìœ¼ë¡œ ì¸í•œ ìº”ë²„ìŠ¤ ëŠ˜ì–´ì§/ìŒ“ì„ ë°©ì§€)
            if (Array.isArray(window.comprehensiveCharts) && window.comprehensiveCharts.length > 0) {
                window.comprehensiveCharts.forEach(function(chart){
                    try { chart.destroy(); } catch (e) {}
                });
                window.comprehensiveCharts = [];
            }

            // 2-2-1 ë ˆì´ì•„ì›ƒ
            container.innerHTML = `
                <div class="comprehensive-charts-grid" style="width:100%;">
                    <div class="chart-item">
                        <h4>âš¡ Lambda ë©”íŠ¸ë¦­</h4>
                        <canvas id="lambdaChart"></canvas>
                    </div>
                    <div class="chart-item">
                        <h4>ğŸ—„ï¸ DynamoDB ë©”íŠ¸ë¦­</h4>
                        <canvas id="dynamoChart"></canvas>
                    </div>
                    <div class="chart-item">
                        <h4>ğŸŒ API Gateway ë©”íŠ¸ë¦­</h4>
                        <canvas id="apiChart"></canvas>
                    </div>
                    <div class="chart-item">
                        <h4>â˜ï¸ CloudFront ë©”íŠ¸ë¦­</h4>
                        <canvas id="cloudfrontChart"></canvas>
                    </div>
                    <div class="chart-item">
                        <h4>ğŸ›¡ï¸ WAF ë©”íŠ¸ë¦­</h4>
                        <canvas id="wafChart"></canvas>
                    </div>
                    <div class="chart-item">
                        <h4>ğŸ•µï¸ GuardDuty ë©”íŠ¸ë¦­</h4>
                        <canvas id="guarddutyChart"></canvas>
                    </div>
                </div>
            `;

            const services = ['Lambda', 'DynamoDB', 'API Gateway', 'CloudFront', 'WAF', 'GuardDuty'];
            const canvasIds = ['lambdaChart', 'dynamoChart', 'apiChart', 'cloudfrontChart', 'wafChart', 'guarddutyChart'];

            // ëª¨ë‹¬ì„ ë¨¼ì € í‘œì‹œí•˜ì—¬ ë¶€ëª¨ í­ì´ 0ì´ ë˜ì§€ ì•Šë„ë¡ í•¨
            modal.style.display = 'flex';
            modal.classList.add('show');

            setTimeout(() => {
            services.forEach((service, index) => {
                const canvas = document.getElementById(canvasIds[index]);
                const ctx = canvas.getContext('2d');
                // JSë¡œ ë†’ì´ë¥¼ ê°•ì œí•˜ì§€ ì•Šê³  ë¶€ëª¨ ì¹´ë“œ ë†’ì´ì— ë§ê²Œ ì±„ìš°ë„ë¡ ë‘ 
                const chartData = getChartData(service);

                const chartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: chartData.labels.slice(0, 10),
                        datasets: [{
                            data: chartData.datasets[0].data.slice(0, 10),
                            backgroundColor: chartData.datasets[0].backgroundColor.slice(0, 10),
                            borderColor: chartData.datasets[0].borderColor.slice(0, 10),
                            borderWidth: 2,
                            borderRadius: 5
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: { duration: 300 },
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { beginAtZero: true, grid: { color: 'rgba(0,255,65,0.15)' }, ticks: { color: '#00ff41' } },
                            y: { grid: { color: 'rgba(0,255,65,0.08)' }, ticks: { color: '#00ff41' } }
                        }
                    }
                });

                // ì¸ìŠ¤í„´ìŠ¤ ë³´ê´€í•˜ì—¬ ì¬ì˜¤í”ˆ/ë‹«ê¸° ì‹œ ì •ë¦¬
                if (Array.isArray(window.comprehensiveCharts)) {
                    window.comprehensiveCharts.push(chartInstance);
                } else {
                    window.comprehensiveCharts = [chartInstance];
                }
            });
            }, 0);

            modal.style.display = 'flex';
            addRealtimeLog('ì¢…í•©ê´€ë¦¬so', 'ì „ì²´ ë©”íŠ¸ë¦­ ëŒ€ì‹œë³´ë“œ í‘œì‹œ (2-2-1 ë ˆì´ì•„ì›ƒ)');
        }

        function closeHorizontalChart() {
            const modal = document.getElementById('horizontalChartModal');
            if (modal) modal.style.display = 'none';

            if (window.horizontalChart) {
                window.horizontalChart.destroy();
                window.horizontalChart = null;
            }

            // ì¢…í•© ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ë„ ëª¨ë‘ ì •ë¦¬
            if (Array.isArray(window.comprehensiveCharts) && window.comprehensiveCharts.length > 0) {
                window.comprehensiveCharts.forEach(function(chart){
                    try { chart.destroy(); } catch (e) {}
                });
                window.comprehensiveCharts = [];
            }
        }

    
        // =================================================================
        // ğŸ¯ LOAD & MAIL ê´€ë¦¬ ì‹œìŠ¤í…œ (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±°)
        // =================================================================
        function showLoadMail() {
            console.log('ğŸ¯ LOAD & MAIL ì‹¤í–‰');
            const modal = document.getElementById('loadMailModal');
            if (modal) {
                modal.style.display = 'flex';
                modal.classList.add('show');
                showBlockedIPsTab(document.querySelector('.management-btn'));
                loadBlockedIPs();
                addRealtimeLog('ì‹œìŠ¤í…œ', 'LOAD & MAIL ê´€ë¦¬ ì„¼í„° ì‹¤í–‰');
            }
        }

        function showBlockedIPsTab(button) {
            setActiveTab('blockedIPsTab', button);
            loadBlockedIPs();
        }

        function showUnblockRequestTab(button) {
            setActiveTab('unblockRequestTab', button);
        }

        function showStatusCheckTab(button) {
            setActiveTab('statusCheckTab', button);
        }

        function setActiveTab(tabId, button) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
                tab.classList.remove('active');
            });

            document.querySelectorAll('.management-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = 'rgba(0, 0, 0, 0.6)';
            });

            const tab = document.getElementById(tabId);
            if (tab) {
                tab.style.display = 'block';
                tab.classList.add('active');
            }

            if (button) {
                button.classList.add('active');
                button.style.background = 'rgba(0, 204, 255, 0.3)';
            }
        }

        // ğŸ”— ì‹¤ì œ AWS APIì—ì„œ ì°¨ë‹¨ IP ë¡œë“œ (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±°)
        async function loadBlockedIPs() {
            const container = document.getElementById('blockedIPList');
            if (!container) return;

            container.innerHTML = '<div style="text-align: center; padding: 40px; color: #888;">ì‹¤ì‹œê°„ AWS APIì—ì„œ ì°¨ë‹¨ IP ëª©ë¡ì„ ë¡œë“œí•˜ëŠ” ì¤‘...</div>';

            try {
                const response = await fetchWithTimeout(API_BASE_URL + '?action=blocked_ips', {
                    method: 'GET',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    mode: 'cors'
                }, API_TIMEOUT);

                if (response.ok) {
                    const data = await response.json();
                    displayBlockedIPs(data.blocked_ips || []);
                    addRealtimeLog('ë°ì´í„°ë¡œë“œ', `âœ… ì°¨ë‹¨ IP ${data.blocked_ips?.length || 0}ê°œ ë¡œë“œ ì™„ë£Œ`);
                } else {
                    throw new Error('AWS API ì‘ë‹µ ì‹¤íŒ¨');
                }
            } catch (error) {
                console.warn('ì°¨ë‹¨ IP ë¡œë“œ ì‹¤íŒ¨:', error);
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #ff0040;">
                        <div style="font-size: 20px; margin-bottom: 10px;">âŒ AWS API ì—°ê²° ì‹¤íŒ¨</div>
                        <div style="font-size: 14px; color: #888;">ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                        <button onclick="loadBlockedIPs()" style="background: #00ff41; color: black; border: none; padding: 10px 20px; border-radius: 5px; margin-top: 15px; cursor: pointer;">ì¬ì‹œë„</button>
                    </div>
                `;
                addRealtimeLog('ë°ì´í„°ë¡œë“œ', `âŒ ì°¨ë‹¨ IP ë¡œë“œ ì‹¤íŒ¨: ${error.message}`);
            }
        }

        function displayBlockedIPs(blockedIPs) {
            const container = document.getElementById('blockedIPList');
            if (!container) return;

            if (blockedIPs.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #00ff41;">âœ… í˜„ì¬ ì°¨ë‹¨ëœ IPê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            let html = '';
            blockedIPs.forEach((ip, index) => {
                // ìœ„í—˜ë„ì— ë”°ë¥¸ ìƒ‰ìƒ ê²°ì •
                const getRiskColor = (riskLevel) => {
                    switch(riskLevel) {
                        case 'CRITICAL': return '#ff0040';
                        case 'HIGH': return '#ff6600';
                        case 'MEDIUM': return '#ffaa00';
                        case 'LOW': return '#00ff41';
                        case 'ACTIVE': return '#ff0040';
                        case 'EMERGENCY': return '#ff0040';
                        case 'ERROR': return '#ff0040';
                        default: return '#ffaa00';
                    }
                };

                const riskLevel = ip.risk_level || 'MEDIUM';
                const riskColor = getRiskColor(riskLevel);
                const riskScore = ip.risk_score || 50;
                
                // ìœ„í—˜ë„ ì•„ì´ì½˜
                const getRiskIcon = (level) => {
                    switch(level) {
                        case 'CRITICAL': return 'ğŸ’€';
                        case 'HIGH': return 'ğŸš¨';
                        case 'MEDIUM': return 'âš ï¸';
                        case 'LOW': return 'â„¹ï¸';
                        default: return 'ğŸ”';
                    }
                };

                const riskIcon = getRiskIcon(riskLevel);
                
                // ìœ„í—˜ë„ì— ë”°ë¥¸ í•œêµ­ì–´ í…ìŠ¤íŠ¸
                const getRiskKoreanText = (level) => {
                    switch(level) {
                        case 'CRITICAL': return 'ì¹˜ëª…ì ';
                        case 'HIGH': return 'ë†’ìŒ';
                        case 'MEDIUM': return 'ë³´í†µ';
                        case 'LOW': return 'ë‚®ìŒ';
                        case 'ACTIVE': return 'í™œì„±';
                        case 'EMERGENCY': return 'ê¸´ê¸‰';
                        case 'ERROR': return 'ì˜¤ë¥˜';
                        default: return 'ë³´í†µ';
                    }
                };
                
                // ìœ„í˜‘ ìœ í˜• (API ë¯¸ì œê³µì‹œ í”„ë¡ íŠ¸ì—ì„œ ì¶”ë¡ )
                const deriveThreatTypeKorean = (type, reason) => {
                    const map = {
                        'SQL_INJECTION': 'SQL ì¸ì ì…˜ ê³µê²©',
                        'DDOS_ATTACK': 'DDoS ê³µê²©',
                        'XSS_ATTACK': 'XSS ê³µê²©',
                        'CRYPTO_MINING': 'ì•”í˜¸í™”í ì±„êµ´',
                        'BRUTE_FORCE': 'ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©',
                        'MALWARE': 'ì•…ì„±ì½”ë“œ',
                        'RANSOMWARE': 'ëœì„¬ì›¨ì–´',
                        'NETWORK_ATTACKS': 'ë„¤íŠ¸ì›Œí¬ ìŠ¤ìºë‹',
                        'AI_ATTACKS': 'AI ê¸°ë°˜ ê³µê²©',
                        'DATA_EXFILTRATION': 'ë°ì´í„° ìœ ì¶œ ì‹œë„',
                        'WEB_ATTACKS': 'ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³µê²©',
                        'SOCIAL_ENGINEERING': 'ì‚¬íšŒê³µí•™ì  ê³µê²©',
                        'PATH_TRAVERSAL': 'ê²½ë¡œ ìˆœíšŒ ê³µê²©'
                    };
                    if (type && map[type]) return map[type];
                    const r = String(reason || '').toUpperCase();
                    if (/(SQL\s?INJECTION|UNION SELECT|OR 1=1)/.test(r)) return 'SQL ì¸ì ì…˜ ê³µê²©';
                    if (/(DDOS|FLOOD|DISTRIBUTED DENIAL)/.test(r)) return 'DDoS ê³µê²©';
                    if (/(XSS|CROSS-SITE|SCRIPT)/.test(r)) return 'XSS ê³µê²©';
                    if (/(RANSOMWARE|ENCRYPTION)/.test(r)) return 'ëœì„¬ì›¨ì–´';
                    if (/(BRUTE\s?FORCE|CREDENTIAL)/.test(r)) return 'ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©';
                    if (/(MALWARE|VIRUS|TROJAN|WORM)/.test(r)) return 'ì•…ì„±ì½”ë“œ';
                    if (/(EXFILTRATION|DATA THEFT|LEAK)/.test(r)) return 'ë°ì´í„° ìœ ì¶œ ì‹œë„';
                    if (/(PORT SCAN|SCANNING|NMAP|VULNERABILITY)/.test(r)) return 'ë„¤íŠ¸ì›Œí¬ ìŠ¤ìºë‹';
                    if (/(PATH TRAVERSAL|FILE INCLUSION)/.test(r)) return 'ê²½ë¡œ ìˆœíšŒ ê³µê²©';
                    if (/(WEB ATTACK|OWASP)/.test(r)) return 'ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê³µê²©';
                    return 'ë³´ì•ˆ ìœ„í˜‘';
                };
                const threatTypeKorean = ip.threat_korean_name || deriveThreatTypeKorean(ip.threat_type, ip.reason);
                
                // êµ­ê°€ ì •ë³´ (Unknown í•œê¸€ ë³€í™˜)
                const country = (ip.country === 'Unknown' || !ip.country) ? 'ì•Œ ìˆ˜ ì—†ëŠ” ì§€ì—­' : (
                    {
                        'South Korea':'ëŒ€í•œë¯¼êµ­','United States':'ë¯¸êµ­','Russia':'ëŸ¬ì‹œì•„','Netherlands':'ë„¤ëœë€ë“œ','Canada':'ìºë‚˜ë‹¤','Private Network':'ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬'
                    }[ip.country] || ip.country
                );
                
                // ì°¨ë‹¨ ì‹œê°„ í¬ë§·íŒ…
                const formatBlockedTime = (timeStr) => {
                    if (!timeStr || timeStr === 'Unknown') return 'ì•Œ ìˆ˜ ì—†ìŒ';
                    return timeStr;
                };

                const blockedTime = formatBlockedTime(ip.blocked_at);
                
                // ì§€ì† ì‹œê°„ ê³„ì‚°
                const durationHours = Math.floor(ip.duration_hours || 1);
                const durationText = durationHours >= 24 ? 
                    `${Math.floor(durationHours / 24)}ì¼ ${durationHours % 24}ì‹œê°„` : 
                    `${durationHours}ì‹œê°„`;
                
                // ìœ„í—˜ë„ ì ìˆ˜ì— ë”°ë¥¸ ìƒ‰ìƒ
                const getScoreColor = (score) => {
                    if (score >= 80) return '#ff0040';
                    if (score >= 60) return '#ff6600';
                    if (score >= 40) return '#ffaa00';
                    return '#00ff41';
                };

                const scoreColor = getScoreColor(riskScore);
                
                html += `
                    <div style="background: rgba(0, 0, 0, 0.8); border: 2px solid ${riskColor}; border-radius: 15px; padding: 25px; margin-bottom: 20px; box-shadow: 0 0 20px ${riskColor}20;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="font-size: 32px;">${riskIcon}</div>
                                <div>
                                    <div style="font-size: 24px; font-weight: bold; color: #ff0040; text-shadow: 0 0 10px #ff0040;">${ip.ip || 'ì•Œ ìˆ˜ ì—†ëŠ” IP'}</div>
                                    <div style="color: #00ccff; margin: 5px 0; font-size: 16px;">${country} | ${ip.status_korean || 'í™œì„±'}</div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="background: ${riskColor}; color: black; padding: 8px 15px; border-radius: 20px; font-size: 14px; font-weight: bold; margin-bottom: 8px; box-shadow: 0 0 10px ${riskColor}50;">
                                    ${riskLevel} (${riskScore}ì )
                                </div>
                                <button onclick="requestUnblock('${ip.ip}')" style="background: linear-gradient(135deg, #ffaa00, #ff8800); border: none; color: black; padding: 10px 20px; border-radius: 10px; font-size: 14px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 8px rgba(255, 170, 0, 0.3);">í•´ì œìš”ì²­</button>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 25px; color: #ffffff; font-size: 14px; margin-bottom: 20px;">
                            <div style="background: rgba(0, 255, 65, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #00ff41;">
                                <strong style="color: #00ff41; font-size: 16px;">ğŸ¯ ìœ„í˜‘ ì •ë³´</strong><br><br>
                                â€¢ ê³µê²© ìœ í˜•: <span style="color: #ffaa00; font-weight: bold;">${threatTypeKorean}</span><br>
                                â€¢ ìœ„í˜‘ íšŸìˆ˜: <span style="color: #ff6600;">${ip.threat_count || 1}íšŒ</span><br>
                                â€¢ ì°¨ë‹¨ì: <span style="color: #00ccff;">${ip.blocked_by_korean || 'ìë™ì°¨ë‹¨'}</span><br>
                                â€¢ ìœ„í—˜ë„: <span style="color: ${scoreColor}; font-weight: bold;">${riskLevel} (${riskScore}/100)</span>
                            </div>
                            <div style="background: rgba(0, 204, 255, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #00ccff;">
                                <strong style="color: #00ccff; font-size: 16px;">ğŸ•’ ì°¨ë‹¨ ì •ë³´</strong><br><br>
                                â€¢ ì°¨ë‹¨ ì‹œê°„: <span style="color: #ffffff;">${blockedTime}</span><br>
                                â€¢ ì§€ì† ì‹œê°„: <span style="color: #ffaa00;">${durationText}</span><br>
                                â€¢ ìƒíƒœ: <span style="color: ${riskColor}; font-weight: bold;">${ip.status_korean || 'í™œì„±'}</span><br>
                                â€¢ ìš°ì„ ìˆœìœ„: <span style="color: #ff0040;">ë†’ìŒ</span>
                            </div>
                            <div style="background: rgba(255, 170, 0, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #ffaa00;">
                                <strong style="color: #ffaa00; font-size: 16px;">ğŸ“‹ ê³µê²© ìƒì„¸</strong><br><br>
                                <div style="color: #ffffff; line-height: 1.4; word-break: break-word;">
                                    <strong style="color: #ffaa00;">ê³µê²© ì¢…ë¥˜:</strong> ${threatTypeKorean}<br><br>
                                    <strong style="color: #ffaa00;">ìƒì„¸ ì„¤ëª…:</strong><br>
                                    ${ip.threat_korean_description || deriveThreatTypeKorean(ip.threat_type, ip.reason) + ' ê´€ë ¨ í–‰ìœ„ê°€ íƒì§€ë˜ì—ˆìŠµë‹ˆë‹¤.' || 'ë³´ì•ˆ ìœ„í˜‘ì´ íƒì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ ì°¨ë‹¨ ì¡°ì¹˜ë¥¼ ì·¨í–ˆìŠµë‹ˆë‹¤.'}
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(0, 0, 0, 0.5); padding: 15px; border-radius: 10px; border: 1px solid #333;">
                            <div style="display: flex; justify-content: space-between; align-items: center; color: #888; font-size: 12px;">
                                <div>ğŸ†” ID: ${ip.ip?.replace(/\./g, '') || 'Unknown'}</div>
                                <div>ğŸŒ ì§€ì—­: ${country}</div>
                                <div>âš¡ ìœ„í—˜ë„: ${riskLevel}</div>
                                <div>ğŸ“Š ì ìˆ˜: ${riskScore}/100</div>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function getRiskColor(riskLevel) {
            const colors = {
                'CRITICAL': '#ff0040',
                'HIGH': '#ff8800',
                'MEDIUM': '#ffaa00',
                'LOW': '#00ff41'
            };
            return colors[riskLevel] || '#00ccff';
        }

        // =================================================================
        // ğŸ”“ ìˆ˜ë™ ì „íˆ¬ ì œì–´íŒ (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±°)
        // =================================================================
        function showManualControlModal() {
            console.log('ğŸ”“ ìˆ˜ë™ ì „íˆ¬ ëª¨ë‹¬ í‘œì‹œ');
            const modal = document.getElementById('manualControlModal');
            if (modal) {
                modal.style.display = 'flex';
                modal.classList.add('show');
                isManualModalOpen = true;
                loadManualReviewThreats();
                addRealtimeLog('ì‹œìŠ¤í…œ', 'ìˆ˜ë™ ì „íˆ¬ ì œì–´íŒ í™œì„±í™”');
                // ì—´ ë•Œë§ˆë‹¤ ìµœì‹  ë°ì´í„°ë¡œ ëŒ€ì‹œë³´ë“œ ë™ê¸°í™” ì‹œë„
                loadRealAWSData && loadRealAWSData();
            }
        }

        // ğŸ”— ì‹¤ì œ AWS APIì—ì„œ ìˆ˜ë™ ê²€í†  ëŒ€ìƒ ë¡œë“œ (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±°)
        async function loadManualReviewThreats() {
            const container = document.getElementById('threatList');
            if (!container) return;

            container.innerHTML = '<div style="text-align: center; padding: 40px; color: #888;">ì‹¤ì‹œê°„ AWS APIì—ì„œ ìˆ˜ë™ ê²€í†  ëŒ€ìƒì„ ë¡œë“œí•˜ëŠ” ì¤‘...</div>';

            try {
                const response = await fetchWithTimeout(API_BASE_URL + '?action=manual_review', {
                    method: 'GET',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    mode: 'cors'
                }, API_TIMEOUT);

                if (response.ok) {
                    const data = await response.json();
                    const threats = data.threats || data.manual_reviews || [];
                    displayManualThreats(threats);
                    // ëŒ€ì‹œë³´ë“œ(ê²½ì°°ì„œ) ìˆ«ìì™€ ë™ê¸°í™” (60ì´ˆ ìºì‹œ)
                    manualReviewCountOverride = threats.length;
                    manualReviewCountOverrideTs = Date.now();
                    updateElementById('failedCount', (manualReviewCountOverride).toString());
                    addRealtimeLog('ë°ì´í„°ë¡œë“œ', `âœ… ìˆ˜ë™ ê²€í†  ëŒ€ìƒ ${threats.length}ê°œ ë¡œë“œ ì™„ë£Œ`);
                } else {
                    throw new Error('AWS API ì‘ë‹µ ì‹¤íŒ¨');
                }
            } catch (error) {
                console.warn('ìˆ˜ë™ ê²€í†  ë¡œë“œ ì‹¤íŒ¨:', error);
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #ff0040;">
                        <div style="font-size: 20px; margin-bottom: 10px;">âŒ AWS API ì—°ê²° ì‹¤íŒ¨</div>
                        <div style="font-size: 14px; color: #888;">ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                        <button onclick="loadManualReviewThreats()" style="background: #00ff41; color: black; border: none; padding: 10px 20px; border-radius: 5px; margin-top: 15px; cursor: pointer;">ì¬ì‹œë„</button>
                    </div>
                `;
                // ì‹¤íŒ¨ ì‹œ ìˆ˜ë™ ê²€í†  0ìœ¼ë¡œ ë™ê¸°í™”í•˜ê³  ìºì‹œ ê°±ì‹  (ìŒìˆ˜ ë°©ì§€)
                manualReviewCountOverride = 0;
                manualReviewCountOverrideTs = Date.now();
                updateElementById('failedCount', '0');
                addRealtimeLog('ë°ì´í„°ë¡œë“œ', `âŒ ìˆ˜ë™ ê²€í†  ë¡œë“œ ì‹¤íŒ¨: ${error.message}`);
            }
        }

        function displayManualThreats(threats) {
            const container = document.getElementById('threatList');
            if (!container) return;

            if (threats.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 40px; color: #00ff41;">âœ… í˜„ì¬ ìˆ˜ë™ ê²€í†  ëŒ€ìƒì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            let html = '';
            threats.forEach(threat => {
                const riskColor = getRiskColor(threat.risk_level || 'MEDIUM');
                const riskIcon = getRiskIcon(threat.risk_level || 'MEDIUM');

                html += `
                    <div style="background: rgba(0, 0, 0, 0.7); border: 2px solid ${riskColor}; border-radius: 15px; padding: 20px; margin-bottom: 15px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="font-size: 24px;">${riskIcon}</div>
                                <div>
                                    <div style="font-size: 16px; font-weight: bold; color: #ffffff;">${threat.threat_type || 'Unknown Threat'}</div>
                                    <div style="color: #00ccff; font-size: 14px;">IP: ${threat.ip || threat.source_ip || 'Unknown'} | ID: ${threat.id || threat.threat_id || 'Unknown'}</div>
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="background: ${riskColor}; color: black; padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: bold; margin-bottom: 8px;">${threat.risk_level || 'MEDIUM'}</div>
                                <div style="color: #00ff41; font-size: 12px;">ì‹ ë¢°ë„: ${threat.confidence || 75}%</div>
                            </div>
                        </div>
                        <div style="color: #ffffff; font-size: 13px; margin-bottom: 15px; line-height: 1.4;">
                            <strong style="color: #00ff41;">ìƒì„¸ ë¶„ì„:</strong><br>
                            ${threat.details || threat.description || 'No detailed information available'}
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="color: #888; font-size: 12px;">
                                íƒì§€ ì‹œê°„: ${threat.detected_time || threat.timestamp || getCurrentKST()}<br>
                                AI ì¶”ì²œ: <span style="color: #ffaa00; font-weight: bold;">${threat.recommendation || 'ì¶”ê°€ ë¶„ì„ í•„ìš”'}</span>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="blockThreat('${threat.id || threat.threat_id}', '${threat.ip || threat.source_ip}')" style="background: linear-gradient(135deg, #ff0040, #cc0033); border: none; color: white; padding: 8px 16px; border-radius: 8px; font-size: 12px; font-weight: bold; cursor: pointer;">ì¦‰ì‹œì°¨ë‹¨</button>
                                <button onclick="ignoreThreat('${threat.id || threat.threat_id}')" style="background: linear-gradient(135deg, #666, #444); border: none; color: white; padding: 8px 16px; border-radius: 8px; font-size: 12px; font-weight: bold; cursor: pointer;">ë¬´ì‹œ</button>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function getRiskIcon(riskLevel) {
            const icons = {
                'CRITICAL': 'ğŸ’€',
                'HIGH': 'ğŸš¨',
                'MEDIUM': 'âš ï¸',
                'LOW': 'ğŸ’¡'
            };
            return icons[riskLevel] || 'â“';
        }

        // =================================================================
        // ğŸ® í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì‹œìŠ¤í…œ
        // =================================================================
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', function(event) {
                if (event.ctrlKey && event.key === 'r') {
                    event.preventDefault();
                    refreshData();
                } else if (event.key === 'Escape') {
                    closeAllModals();
                } else if (event.key === 'F1') {
                    event.preventDefault();
                    showHelp();
                } else if (event.key === 'F2') {
                    event.preventDefault();
                    showLoadMail();
                } else if (event.key === 'F3') {
                    event.preventDefault();
                    showManualControlModal();
                } else if (event.key === 'F4') {
                    event.preventDefault();
                    reportGeneration();
                } else if (event.key === 'F5') {
                    event.preventDefault();
                    simulateAutoBlockInstant();
                }
            });
        }

        function closeAllModals() {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                modal.style.display = 'none';
            });
            closeVoiceUI();
            isManualModalOpen = false;
        }

        // =================================================================
        // ğŸ”„ ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸ ë° í´ë§
        // =================================================================
        function updateDashboardUI(data) {
            try {
                updateElementById('totalThreats', data.threat_count?.toString() || '0');
                updateElementById('blockedThreats', data.auto_action_count?.toString() || '0');
                updateElementById('blockedIPs', data.blocked_ip_count?.toString() || '0');
                updateElementById('defeatCount', data.auto_action_count?.toString() || '0');

                const riskLevel = data.current_risk_score || 0;
                if (riskLevel > 70) {
                    updateElementById('threatLevel', 'ìœ„í—˜');
                } else if (riskLevel > 40) {
                    updateElementById('threatLevel', 'ì£¼ì˜');
                } else {
                    updateElementById('threatLevel', 'ì•ˆì „');
                }

                // íƒì§€ìœ¨ í‘œì‹œ - ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™ìœ¼ë¡œ ê°„ì£¼
                const detectionRate = data.statistics?.detection_rate || 98.5;
                updateElementById('successRate', detectionRate + '%');
                // ìˆ˜ë™ ì „íˆ¬ ëª©ë¡ì—ì„œ ë¡œë“œí•œ ê°’ì´ ìˆìœ¼ë©´ í•­ìƒ ìš°ì„  ì‚¬ìš© (í´ë§ìœ¼ë¡œ ë®ì–´ì“°ì§€ ì•ŠìŒ)
                // í•­ìƒ ìºì‹œë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë§ ê°’ì´ ë®ì–´ì“°ì§€ ì•Šë„ë¡ ê³ ì •
                if (typeof manualReviewCountOverride === 'number') {
                    updateElementById('failedCount', Math.max(0, manualReviewCountOverride).toString());
                } else {
                updateElementById('failedCount', data.manual_review_count?.toString() || '0');
                }

            } catch (error) {
                console.warn('ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ ì—ëŸ¬:', error);
            }
        }

        function updateElementById(id, value) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value;
            }
        }

        function refreshData() {
            console.log('ğŸ”„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨');
            loadRealAWSData();
            addRealtimeLog('ì‹œìŠ¤í…œ', 'ğŸ”„ ìˆ˜ë™ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ');
        }

        function startRealTimePolling() {
            console.log('ğŸ“¡ ì‹¤ì‹œê°„ í´ë§ ì‹œì‘ (5ì´ˆ ê°„ê²©)');

            pollingInterval = setInterval(async () => {
                await loadRealAWSData();
            }, 5000);
        }

        // =================================================================
        // ğŸ”„ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        // =================================================================
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                modal.classList.remove('show');
            }
            if (modalId === 'manualControlModal') {
                isManualModalOpen = false;
                // ëª¨ë‹¬ ë‹«ì„ ë•Œ ìºì‹œëŠ” ìœ ì§€ (ì˜ë„ì ìœ¼ë¡œ ìœ ì§€)
            }
        }

        function showHelp() {
            const modal = document.getElementById('helpModal');
            if (modal) {
                modal.style.display = 'flex';
                modal.classList.add('show');
                addRealtimeLog('ì‹œìŠ¤í…œ', 'ğŸ“š ë„ì›€ë§ ì‹œìŠ¤í…œ ì‹¤í–‰');
            }
        }

        function executeManualBlock() {
            const ip = document.getElementById('manualBlockIP')?.value.trim();
            const reason = document.getElementById('manualBlockReason')?.value.trim();

            if (!ip) {
                alert('âŒ IP ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            console.log(`ìˆ˜ë™ ì°¨ë‹¨ ì‹¤í–‰: ${ip} - ${reason}`);
            addRealtimeLog('ì°¨ë‹¨', `ğŸš« ìˆ˜ë™ ì°¨ë‹¨: ${ip}`);
            alert(`âœ… ${ip} ì°¨ë‹¨ì´ ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤.`);

            // ìƒì„¸ Slackì€ ë°±ì—”ë“œ í†µí•´ ë°œì†¡
            postRealtimeAlert({
                threat_type: 'MANUAL_BLOCK',
                source_ip: ip,
                severity: 'HIGH',
                details: `Reason: ${reason || 'N/A'}`
            });

            document.getElementById('manualBlockIP').value = '';
            document.getElementById('manualBlockReason').value = '';
        }

        function blockThreat(threatId, ip) {
            console.log(`ìœ„í˜‘ ì°¨ë‹¨: ${threatId} - ${ip}`);
            addRealtimeLog('ì°¨ë‹¨', `ğŸš« ìœ„í˜‘ ì°¨ë‹¨: ${ip} (${threatId})`);
            alert(`âœ… ${ip} ì°¨ë‹¨ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            postRealtimeAlert({
                threat_type: 'BLOCKED_THREAT',
                source_ip: ip,
                severity: 'HIGH',
                details: `ThreatId: ${threatId}`
            });
            loadManualReviewThreats();
        }

        function ignoreThreat(threatId) {
            console.log(`ìœ„í˜‘ ë¬´ì‹œ: ${threatId}`);
            addRealtimeLog('ì‹œìŠ¤í…œ', `ğŸ“ ìœ„í˜‘ ë¬´ì‹œ: ${threatId}`);
            loadManualReviewThreats();
        }

        function requestUnblock(ip) {
            console.log(`ì°¨ë‹¨ í•´ì œ ìš”ì²­: ${ip}`);
            
            // ëª¨ë‹¬ í‘œì‹œí•˜ê³  ì°¨ë‹¨ ìš”ì²­ íƒ­ìœ¼ë¡œ ì´ë™
            const modal = document.getElementById('loadMailModal');
            if (modal) {
                showUnblockRequestTab(document.querySelectorAll('.management-btn')[1]);
                document.getElementById('unblockIP').value = ip;
                
                addRealtimeLog('ìš”ì²­', `ğŸ“ ${ip} í•´ì œ ìš”ì²­ ì¤€ë¹„`);
                postRealtimeAlert({
                    threat_type: 'UNBLOCK_REQUEST',
                    source_ip: ip,
                    severity: 'LOW',
                    details: 'Unblock request created'
                });
            }
        }

        function showIdCopyModal(requestId, ip) {
            // ê¸°ì¡´ ëª¨ë‹¬ì´ ìˆìœ¼ë©´ ì œê±°
            const existingModal = document.getElementById('idCopyModal');
            if (existingModal) {
                existingModal.remove();
            }

            // ID ë³µì‚¬ ëª¨ë‹¬ ìƒì„±
            const modal = document.createElement('div');
            modal.id = 'idCopyModal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                backdrop-filter: blur(5px);
            `;

            modal.innerHTML = `
                <div style="background: linear-gradient(135deg, #1a0033, #2d1b69); border: 2px solid #00ccff; border-radius: 20px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 0 30px rgba(0, 204, 255, 0.5);">
                    <div style="text-align: center; margin-bottom: 25px;">
                        <div style="font-size: 24px; color: #00ccff; font-weight: bold; margin-bottom: 10px;">ğŸ“‹ í•´ì œ ìš”ì²­ ID ìƒì„±ë¨</div>
                        <div style="color: #ffffff; font-size: 16px;">IP: <span style="color: #ffaa00;">${ip}</span></div>
                    </div>
                    
                    <div style="background: rgba(0, 0, 0, 0.6); padding: 20px; border-radius: 10px; margin-bottom: 25px; border: 1px solid #333;">
                        <div style="color: #00ff41; font-size: 14px; margin-bottom: 10px; font-weight: bold;">ìš”ì²­ ID:</div>
                        <div style="background: rgba(0, 0, 0, 0.8); padding: 15px; border-radius: 8px; border: 1px solid #555; font-family: 'Courier New', monospace; font-size: 16px; color: #00ccff; word-break: break-all; user-select: all;" id="requestIdText">${requestId}</div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="copyRequestId('${requestId}', event)" style="background: linear-gradient(135deg, #00ff41, #00cc00); border: none; color: black; padding: 12px 25px; border-radius: 10px; font-size: 14px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 8px rgba(0, 255, 65, 0.3);">
                            ğŸ“‹ ID ë³µì‚¬
                        </button>
                        <button onclick="closeIdCopyModal()" style="background: linear-gradient(135deg, #ff6600, #ff4400); border: none; color: white; padding: 12px 25px; border-radius: 10px; font-size: 14px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 8px rgba(255, 102, 0, 0.3);">
                            ë‹«ê¸°
                        </button>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px; color: #888; font-size: 12px;">
                        ğŸ’¡ IDë¥¼ ë³µì‚¬í•˜ì—¬ ê´€ë¦¬ìì—ê²Œ ì „ë‹¬í•˜ì„¸ìš”
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function copyRequestId(requestId, event) {
            navigator.clipboard.writeText(requestId).then(() => {
                // ë³µì‚¬ ì„±ê³µ ì•Œë¦¼
                if (event && event.target) {
                    const button = event.target;
                    const originalText = button.textContent;
                    button.textContent = 'âœ… ë³µì‚¬ë¨!';
                    button.style.background = 'linear-gradient(135deg, #00cc00, #00aa00)';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.style.background = 'linear-gradient(135deg, #00ff41, #00cc00)';
                    }, 2000);
                }
                
                addRealtimeLog('ì‹œìŠ¤í…œ', `ğŸ“‹ ìš”ì²­ ID ë³µì‚¬ë¨: ${requestId}`);
            }).catch(err => {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                addRealtimeLog('ì˜¤ë¥˜', `âŒ ID ë³µì‚¬ ì‹¤íŒ¨: ${err.message}`);
            });
        }

        function closeIdCopyModal() {
            const modal = document.getElementById('idCopyModal');
            if (modal) {
                modal.remove();
            }
        }

        async function submitUnblockRequest() {
            const ip = document.getElementById('unblockIP')?.value.trim();
            const name = document.getElementById('requesterName')?.value.trim();
            const contact = document.getElementById('requesterContact')?.value.trim();
            const reason = document.getElementById('unblockReason')?.value.trim();

            if (!ip || !name || !contact || !reason) {
                alert('âŒ ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ê³ ìœ  ID ìƒì„± (IP + íƒ€ì„ìŠ¤íƒ¬í”„)
            const requestId = `REQ_${ip.replace(/\./g, '')}_${Date.now()}`;

            try {
                // ë¡œë”© í‘œì‹œ
                const submitButton = document.querySelector('button[onclick="submitUnblockRequest()"]');
                const originalText = submitButton.textContent;
                submitButton.textContent = 'ğŸ“¤ ì œì¶œ ì¤‘...';
                submitButton.disabled = true;

                // ìš”ì²­ ë°ì´í„° ì¤€ë¹„
                const requestData = {
                    action: 'request_unblock',
                    ip_address: ip,
                    requester_name: name,
                    contact: contact,
                    reason: reason
                };
                
                console.log('ğŸ“¤ API ìš”ì²­ ë°ì´í„°:', requestData);
                console.log('ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸:', API_BASE_URL);

                // APIë¥¼ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
                const response = await fetchWithTimeout(API_BASE_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    mode: 'cors',
                    body: JSON.stringify(requestData)
                }, API_TIMEOUT);

                if (response.ok) {
                    const result = await response.json();
                    console.log('í•´ì œ ìš”ì²­ ì €ì¥ ì„±ê³µ:', result);
                    
                    // APIì—ì„œ ë°˜í™˜ëœ ì‹¤ì œ request_id ì‚¬ìš©
                    const actualRequestId = result.request_id || requestId;
                    
                    addRealtimeLog('ìš”ì²­', `âœ… í•´ì œ ìš”ì²­ ì €ì¥ë¨: ${ip} (${actualRequestId})`);
                    
                    // í¼ ì´ˆê¸°í™”
                    ['unblockIP', 'requesterName', 'requesterContact', 'unblockReason'].forEach(id => {
                        const element = document.getElementById(id);
                        if (element) element.value = '';
                    });

                    // ID ë³µì‚¬ ëª¨ë‹¬ í‘œì‹œ (ì‹¤ì œ request_id ì‚¬ìš©)
                    showIdCopyModal(actualRequestId, ip);
                } else {
                    const errorText = await response.text();
                    console.error('API ì‘ë‹µ ì˜¤ë¥˜:', response.status, errorText);
                    throw new Error(`HTTP ${response.status}: ${response.statusText} - ${errorText}`);
                }

            } catch (error) {
                console.error('í•´ì œ ìš”ì²­ ì €ì¥ ì‹¤íŒ¨:', error);
                addRealtimeLog('ì˜¤ë¥˜', `âŒ í•´ì œ ìš”ì²­ ì €ì¥ ì‹¤íŒ¨: ${error.message}`);
                alert(`âŒ ìš”ì²­ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\nì˜¤ë¥˜: ${error.message}`);
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                const submitButton = document.querySelector('button[onclick="submitUnblockRequest()"]');
                if (submitButton) {
                    submitButton.textContent = 'ìš”ì²­ ì œì¶œ';
                    submitButton.disabled = false;
                }
            }
        }

        async function checkRequestStatus() {
            const requestId = document.getElementById('requestID')?.value.trim();
            if (!requestId) {
                alert('âŒ ìš”ì²­ IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                // ë¡œë”© í‘œì‹œ
                const checkButton = document.querySelector('button[onclick="checkRequestStatus()"]');
                const originalText = checkButton.textContent;
                checkButton.textContent = 'ğŸ” í™•ì¸ ì¤‘...';
                checkButton.disabled = true;

                console.log('ìš”ì²­ ìƒíƒœ í™•ì¸:', requestId);
                addRealtimeLog('ìš”ì²­', `ğŸ” ìš”ì²­ ìƒíƒœ í™•ì¸: ${requestId}`);

                // APIë¥¼ í†µí•´ ìš”ì²­ ìƒíƒœ ì¡°íšŒ
                const response = await fetchWithTimeout(API_BASE_URL + `?action=unblock_requests&request_id=${encodeURIComponent(requestId)}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    mode: 'cors'
                }, API_TIMEOUT);

                const statusResult = document.getElementById('statusResult');
                statusResult.style.display = 'block';

                if (response.ok) {
                    const data = await response.json();
                    console.log('ìš”ì²­ ìƒíƒœ ì¡°íšŒ ì„±ê³µ:', data);
                    
                    if (data.unblock_requests && data.unblock_requests.length > 0) {
                        const request = data.unblock_requests[0];
                        displayRequestStatus(request);
                    } else {
                        // ìš”ì²­ì„ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš°
                        statusResult.innerHTML = `
                            <div style="background: rgba(255, 0, 0, 0.1); padding: 20px; border-radius: 10px; border: 1px solid #ff0040;">
                                <h4 style="color: #ff0040; margin-bottom: 15px;">âŒ ìš”ì²­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h4>
                                <div style="color: #ffffff; line-height: 1.6;">
                                    <strong>ìš”ì²­ ID:</strong> ${requestId}<br>
                                    <strong>ìƒíƒœ:</strong> <span style="color: #ff0040;">ì¡´ì¬í•˜ì§€ ì•ŠìŒ</span><br>
                                    <strong>í™•ì¸ ì‚¬í•­:</strong> ìš”ì²­ IDê°€ ì •í™•í•œì§€ í™•ì¸í•´ì£¼ì„¸ìš”
                                </div>
                            </div>
                        `;
                    }
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

            } catch (error) {
                console.error('ìš”ì²­ ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨:', error);
                addRealtimeLog('ì˜¤ë¥˜', `âŒ ìš”ì²­ ìƒíƒœ ì¡°íšŒ ì‹¤íŒ¨: ${error.message}`);
                
                const statusResult = document.getElementById('statusResult');
                statusResult.style.display = 'block';
                statusResult.innerHTML = `
                    <div style="background: rgba(255, 0, 0, 0.1); padding: 20px; border-radius: 10px; border: 1px solid #ff0040;">
                        <h4 style="color: #ff0040; margin-bottom: 15px;">âŒ ì¡°íšŒ ì‹¤íŒ¨</h4>
                        <div style="color: #ffffff; line-height: 1.6;">
                            <strong>ì˜¤ë¥˜:</strong> ${error.message}<br>
                            <strong>ìš”ì²­ ID:</strong> ${requestId}<br>
                            <strong>í•´ê²° ë°©ë²•:</strong> ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”
                        </div>
                    </div>
                `;
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                const checkButton = document.querySelector('button[onclick="checkRequestStatus()"]');
                if (checkButton) {
                    checkButton.textContent = 'ìƒíƒœ í™•ì¸';
                    checkButton.disabled = false;
                }
            }
        }

        function displayRequestStatus(request) {
            const statusResult = document.getElementById('statusResult');
            
            // ìƒíƒœì— ë”°ë¥¸ ìƒ‰ìƒ ê²°ì •
            let statusColor = '#ffaa00';
            let statusText = 'ì²˜ë¦¬ ëŒ€ê¸° ì¤‘';
            let statusIcon = 'â³';
            
            switch(request.Status) {
                case 'PENDING':
                    statusColor = '#ffaa00';
                    statusText = 'ì²˜ë¦¬ ëŒ€ê¸° ì¤‘';
                    statusIcon = 'â³';
                    break;
                case 'APPROVED':
                    statusColor = '#00ff41';
                    statusText = 'ìŠ¹ì¸ë¨';
                    statusIcon = 'âœ…';
                    postRealtimeAlert({
                        threat_type: 'UNBLOCK_APPROVED',
                        source_ip: request.IPAddress || 'N/A',
                        severity: 'LOW',
                        details: `RequestId: ${request.RequestId || 'N/A'}`
                    });
                    break;
                case 'REJECTED':
                    statusColor = '#ff0040';
                    statusText = 'ê±°ë¶€ë¨';
                    statusIcon = 'âŒ';
                    postRealtimeAlert({
                        threat_type: 'UNBLOCK_REJECTED',
                        source_ip: request.IPAddress || 'N/A',
                        severity: 'LOW',
                        details: `RequestId: ${request.RequestId || 'N/A'}`
                    });
                    break;
                case 'FAILED':
                    statusColor = '#ff6600';
                    statusText = 'ì²˜ë¦¬ ì‹¤íŒ¨';
                    statusIcon = 'âš ï¸';
                    break;
                default:
                    statusColor = '#888';
                    statusText = 'ì•Œ ìˆ˜ ì—†ìŒ';
                    statusIcon = 'â“';
            }

            statusResult.innerHTML = `
                <div style="background: rgba(0, 0, 0, 0.6); padding: 20px; border-radius: 10px; border: 1px solid ${statusColor};">
                    <h4 style="color: ${statusColor}; margin-bottom: 15px;">${statusIcon} ìš”ì²­ ì •ë³´</h4>
                    <div style="color: #ffffff; line-height: 1.6;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <strong>ìš”ì²­ ID:</strong> ${request.RequestId || 'N/A'}<br>
                                <strong>IP ì£¼ì†Œ:</strong> ${request.IPAddress || 'N/A'}<br>
                                <strong>ìš”ì²­ì:</strong> ${request.RequesterName || 'N/A'}<br>
                                <strong>ì—°ë½ì²˜:</strong> ${request.Contact || 'N/A'}
                            </div>
                            <div>
                                <strong>ìƒíƒœ:</strong> <span style="color: ${statusColor}; font-weight: bold;">${statusText}</span><br>
                                <strong>ìš”ì²­ ì‹œê°„:</strong> ${request.RequestedAt || 'N/A'}<br>
                                <strong>ìš°ì„ ìˆœìœ„:</strong> ${request.Priority || 'NORMAL'}<br>
                                <strong>ì²˜ë¦¬ ì‹œê°„:</strong> ${request.ApprovedAt || request.RejectedAt || 'N/A'}
                            </div>
                        </div>
                        <div style="margin-top: 15px; padding: 15px; background: rgba(0, 0, 0, 0.3); border-radius: 8px;">
                            <strong style="color: #00ccff;">í•´ì œ ì‚¬ìœ :</strong><br>
                            <div style="margin-top: 5px; color: #ffffff; word-break: break-word;">
                                ${request.Reason || 'N/A'}
                            </div>
                        </div>
                        ${request.AdminComment ? `
                            <div style="margin-top: 15px; padding: 15px; background: rgba(255, 170, 0, 0.1); border-radius: 8px; border-left: 4px solid #ffaa00;">
                                <strong style="color: #ffaa00;">ê´€ë¦¬ì ì½”ë©˜íŠ¸:</strong><br>
                                <div style="margin-top: 5px; color: #ffffff; word-break: break-word;">
                                    ${request.AdminComment}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // =================================================================
        // ğŸš€ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ë° ì „ì—­ í•¨ìˆ˜ ë“±ë¡ (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±°)
        // =================================================================
        function initializeCyberSentinel() {
            console.log('ğŸš€ Cyber Sentinel ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹œì‘ (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±° ë²„ì „)');

            try {
                initializeAudio();
                startTimeUpdates();
                initializeVoiceRecognition();
                setupKeyboardShortcuts();

                connectToAwsAPI().then(() => {
                    loadRealAWSData();
                    startRealTimePolling();
                });

                isSystemInitialized = true;
                console.log('âœ… Cyber Sentinel ì´ˆê¸°í™” ì™„ë£Œ (AWS API ì‹¤ì œ ì—°ê²°)');
                addRealtimeLog('ì‹œìŠ¤í…œ', 'ğŸš€ Cyber Sentinel ì‹¤ì‹œê°„ ì—°ë™ ëª¨ë“œ í™œì„±í™” (ê°€ìƒ ë°ì´í„° ì—†ìŒ)');

            } catch (error) {
                console.error('âŒ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì—ëŸ¬:', error);
            }
        }

        // ì „ì—­ í•¨ìˆ˜ ë“±ë¡
        window.CyberSentinel = {
            test: simulateAutoBlockInstant,
            refresh: refreshData,
            connect: connectToAwsAPI,
            help: showHelp,
            loadMail: showLoadMail,
            manualControl: showManualControlModal,
            charts: showComprehensiveMetrics,
            status: () => ({ 
                initialized: isSystemInitialized, 
                connected: isAPIConnected,
                version: 'v3.0-no-fake-data'
            })
        };

        // DOM ë¡œë“œ ì™„ë£Œ ì‹œ ì´ˆê¸°í™”
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeCyberSentinel);
        } else {
            initializeCyberSentinel();
        }

        console.log('ğŸ‰ Cyber Sentinel JavaScript ë¡œë“œ ì™„ë£Œ! (ê°€ìƒ ë°ì´í„° ì™„ì „ ì œê±°)');
        console.log('ğŸ”— ì‹¤ì œ AWS API ì—°ê²°ë§Œ ì‚¬ìš©');
        console.log('âš¡ ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ "CyberSentinel.test()" ì‹¤í–‰ ê°€ëŠ¥');

        // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ê°„ê²© ë‹¨ì¶•
const REFRESH_INTERVAL = 3000; // 5ì´ˆ â†’ 3ì´ˆë¡œ ë‹¨ì¶•

function updateBlockedIPs() {
    const container = document.getElementById('blockedIPList');
    
    // âœ… ë¡œë”© í‘œì‹œ
    container.innerHTML = '<div class="loading">ğŸ”„ ì°¨ë‹¨ëœ IP ëª©ë¡ ë¡œë”© ì¤‘...</div>';
    
    fetch(API_BASE_URL + '?action=blocked_ips', {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
        },
        mode: 'cors'
    })
        .then(response => {
            // âœ… HTTP ìƒíƒœ ì½”ë“œ ì²´í¬
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('ì°¨ë‹¨ IP ë°ì´í„°:', data);  // ë””ë²„ê¹…ìš©
            
            // âœ… ë°ì´í„° ì¡´ì¬ ì—¬ë¶€ í™•ì¸
            if (data.blocked_ips && Array.isArray(data.blocked_ips) && data.blocked_ips.length > 0) {
                // âœ… ë°ì´í„° ìˆì„ ë•Œ
                container.innerHTML = data.blocked_ips.map((ip, index) => `
                    <div class="blocked-ip-item" style="border-left: 4px solid #ff4444; padding: 10px; margin: 5px 0; background: #1a1a1a;">
                        <div style="display: flex; justify-content: space-between;">
                            <div class="ip-address" style="color: #ff6b6b; font-weight: bold; font-size: 18px;">
                                ğŸš« ${ip.ip || 'ë°ì´í„°ì—†ìŒ'}
                            </div>
                            <div class="ip-status" style="color: ${ip.status === 'ACTIVE' ? '#4CAF50' : '#FFC107'};">
                                ${ip.status || 'UNKNOWN'}
                            </div>
                        </div>
                        <div class="ip-details" style="color: #ccc; margin-top: 5px;">
                            <div>â° ì°¨ë‹¨ì‹œê°„: ${ip.blocked_at || 'ì‹œê°„ì •ë³´ì—†ìŒ'}</div>
                            <div>ğŸ¤– ì°¨ë‹¨ì£¼ì²´: ${ip.blocked_by || 'SYSTEM'}</div>
                            <div>ğŸ“‹ ì°¨ë‹¨ì‚¬ìœ : ${ip.reason || 'ë³´ì•ˆìœ„í˜‘'}</div>
                        </div>
                    </div>
                `).join('');
                
                // âœ… í†µê³„ ì—…ë°ì´íŠ¸
                const countElement = document.getElementById('blockedCount');
                if (countElement) {
                    countElement.textContent = data.count || data.blocked_ips.length;
                }
                
                // âœ… ì„±ê³µ ë¡œê·¸
                console.log(`âœ… ì°¨ë‹¨ IP ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${data.blocked_ips.length}ê°œ`);
                
            } else {
                // âœ… ë°ì´í„° ì—†ì„ ë•Œ
                container.innerHTML = `
                    <div class="no-data" style="text-align: center; padding: 20px; color: #666;">
                        <div style="font-size: 48px; margin-bottom: 10px;">ğŸ›¡ï¸</div>
                        <div>í˜„ì¬ ì°¨ë‹¨ëœ IPê°€ ì—†ìŠµë‹ˆë‹¤</div>
                        <div style="font-size: 12px; margin-top: 5px;">ì‹œìŠ¤í…œì´ ì •ìƒ ìƒíƒœì…ë‹ˆë‹¤</div>
                        <button onclick="createSampleData()" style="margin-top: 10px; padding: 5px 10px; background: #4CAF50; color: white; border: none; border-radius: 3px; cursor: pointer;">
                            ìƒ˜í”Œ ë°ì´í„° ìƒì„±
                        </button>
                    </div>
                `;
            }
        })
        .catch(error => {
            // âœ… ìƒì„¸í•œ ì—ëŸ¬ ì²˜ë¦¬
            console.error('âŒ ì°¨ë‹¨ IP ì¡°íšŒ ì‹¤íŒ¨:', error);
            
            container.innerHTML = `
                <div class="error-message" style="border: 2px solid #ff4444; padding: 15px; background: #2a1a1a; border-radius: 5px;">
                    <div style="color: #ff6b6b; font-weight: bold; margin-bottom: 10px;">
                        âš ï¸ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨
                    </div>
                    <div style="color: #ccc; margin-bottom: 10px;">
                        ì˜¤ë¥˜ ë‚´ìš©: ${error.message}
                    </div>
                    <div style="color: #999; font-size: 12px; margin-bottom: 15px;">
                        API ì—”ë“œí¬ì¸íŠ¸: ${API_BASE_URL}?action=blocked_ips
                    </div>
                    <button onclick="updateBlockedIPs()" style="padding: 8px 15px; background: #4CAF50; color: white; border: none; border-radius: 3px; cursor: pointer; margin-right: 10px;">
                        ğŸ”„ ë‹¤ì‹œ ì‹œë„
                    </button>
                    <button onclick="createSampleData()" style="padding: 8px 15px; background: #FF9800; color: white; border: none; border-radius: 3px; cursor: pointer;">
                        ğŸ“Š ìƒ˜í”Œ ë°ì´í„° ìƒì„±
                    </button>
                </div>
            `;
        });
}

// âœ… ìµœì‹ ìˆœ ì •ë ¬ í™•ì¸ì„ ìœ„í•œ ì¶”ê°€ í•¨ìˆ˜
function sortBlockedIPsByDate(ips) {
    return ips.sort((a, b) => {
        const dateA = new Date(a.blocked_at.replace(' ', 'T'));
        const dateB = new Date(b.blocked_at.replace(' ', 'T'));
        return dateB - dateA; // ìµœì‹ ìˆœ (ë‚´ë¦¼ì°¨ìˆœ)
    });
}

    </script>

    <!-- ì°¨ë‹¨ëœ IP ëª©ë¡ ì„¹ì…˜ ì œê±° -->


</body>
</html>    